<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Claude Codeå®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç²¾é€šçš„AIç¼–ç¨‹åŠ©æ‰‹</title>
    <url>/2026/01/21/Claude-Code%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A%E7%9A%84AI%E7%BC%96%E7%A8%8B%E5%8A%A9%E6%89%8B/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=1200&h=600&fit=crop" alt="AI Assistant"></p>
<p>Claude Code æ˜¯ Anthropic æ¨å‡ºçš„é©å‘½æ€§ AI ç¼–ç¨‹åŠ©æ‰‹ï¼Œå®ƒä¸åŒäºä¼ ç»Ÿçš„ä»£ç è¡¥å…¨å·¥å…·ï¼Œè€Œæ˜¯çœŸæ­£ç†è§£ä½ çš„ä»£ç åº“ã€èƒ½å¤Ÿæ‰§è¡Œå¤æ‚ä»»åŠ¡çš„æ™ºèƒ½ä¼™ä¼´ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œå…¨é¢æŒæ¡ Claude Code çš„ä½¿ç”¨æŠ€å·§ï¼Œè®©ä½ çš„å¼€å‘æ•ˆç‡æå‡ 10 å€ï¼</p>
<h2 id="ä¸€ã€Claude-Code-ç®€ä»‹"><a href="#ä¸€ã€Claude-Code-ç®€ä»‹" class="headerlink" title="ä¸€ã€Claude Code ç®€ä»‹"></a>ä¸€ã€Claude Code ç®€ä»‹</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯-Claude-Codeï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯-Claude-Codeï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯ Claude Codeï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯ Claude Codeï¼Ÿ</h3><p>Claude Code æ˜¯ Anthropic å®˜æ–¹æ¨å‡ºçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒè®© Claude AI èƒ½å¤Ÿç›´æ¥ä¸ä½ çš„ä»£ç åº“äº¤äº’ã€‚ä¸ GitHub Copilot ç­‰ä»£ç è¡¥å…¨å·¥å…·ä¸åŒï¼ŒClaude Code èƒ½å¤Ÿï¼š</p>
<ul>
<li>ğŸ“– <strong>ç†è§£æ•´ä¸ªä»£ç åº“</strong>ï¼šä¸ä»…ä»…æ˜¯å½“å‰æ–‡ä»¶ï¼Œè€Œæ˜¯æ•´ä¸ªé¡¹ç›®ç»“æ„</li>
<li>ğŸ”§ <strong>æ‰§è¡Œå¤æ‚ä»»åŠ¡</strong>ï¼šé‡æ„ã€è°ƒè¯•ã€ç¼–å†™æµ‹è¯•ã€ç”Ÿæˆæ–‡æ¡£</li>
<li>ğŸ’¬ <strong>è‡ªç„¶è¯­è¨€äº¤äº’</strong>ï¼šç”¨æ—¥å¸¸è¯­è¨€æè¿°éœ€æ±‚ï¼ŒAI è‡ªåŠ¨å®Œæˆ</li>
<li>ğŸ¯ <strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥</strong>ï¼šç†è§£é¡¹ç›®æ¶æ„ã€ä¾èµ–å…³ç³»ã€ç¼–ç è§„èŒƒ</li>
</ul>
<h3 id="1-2-Claude-Code-vs-å…¶ä»–å·¥å…·"><a href="#1-2-Claude-Code-vs-å…¶ä»–å·¥å…·" class="headerlink" title="1.2 Claude Code vs å…¶ä»–å·¥å…·"></a>1.2 Claude Code vs å…¶ä»–å·¥å…·</h3><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Claude Code</th>
<th>GitHub Copilot</th>
<th>Cursor</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ä»£ç ç†è§£</strong></td>
<td>æ•´ä¸ªä»£ç åº“</td>
<td>ä¸»è¦æ˜¯å½“å‰æ–‡ä»¶</td>
<td>æ•´ä¸ªä»£ç åº“</td>
</tr>
<tr>
<td><strong>äº¤äº’æ–¹å¼</strong></td>
<td>è‡ªç„¶è¯­è¨€å¯¹è¯</td>
<td>ä»£ç è¡¥å…¨</td>
<td>æ··åˆ</td>
</tr>
<tr>
<td><strong>ä»»åŠ¡èƒ½åŠ›</strong></td>
<td>å¤æ‚å¤šæ­¥éª¤</td>
<td>å•è¡Œè¡¥å…¨</td>
<td>ä¸­ç­‰</td>
</tr>
<tr>
<td><strong>å­¦ä¹ æˆæœ¬</strong></td>
<td>ä½</td>
<td>ä½</td>
<td>ä¸­</td>
</tr>
<tr>
<td><strong>ä»·æ ¼</strong></td>
<td>æŒ‰ä½¿ç”¨é‡ä»˜è´¹</td>
<td>è®¢é˜…åˆ¶</td>
<td>è®¢é˜…åˆ¶</td>
</tr>
<tr>
<td><strong>ç¦»çº¿èƒ½åŠ›</strong></td>
<td>éœ€è¦è”ç½‘</td>
<td>éœ€è¦è”ç½‘</td>
<td>éƒ¨åˆ†ç¦»çº¿</td>
</tr>
</tbody></table>
<h3 id="1-3-é€‚ç”¨åœºæ™¯"><a href="#1-3-é€‚ç”¨åœºæ™¯" class="headerlink" title="1.3 é€‚ç”¨åœºæ™¯"></a>1.3 é€‚ç”¨åœºæ™¯</h3><p>âœ… <strong>æ¨èä½¿ç”¨ Claude Code çš„åœºæ™¯ï¼š</strong></p>
<ul>
<li>å¤§å‹ä»£ç åº“é‡æ„</li>
<li>å¤æ‚ bug è°ƒè¯•</li>
<li>è·¨æ–‡ä»¶ä»£ç ä¿®æ”¹</li>
<li>ç¼–å†™æŠ€æœ¯æ–‡æ¡£</li>
<li>ä»£ç å®¡æŸ¥</li>
<li>å­¦ä¹ æ–°é¡¹ç›®ä»£ç </li>
</ul>
<p>âŒ <strong>ä¸é€‚åˆçš„åœºæ™¯ï¼š</strong></p>
<ul>
<li>ç®€å•çš„ä»£ç è¡¥å…¨ï¼ˆCopilot æ›´å¿«ï¼‰</li>
<li>éœ€è¦å®æ—¶æç¤ºçš„åœºæ™¯</li>
<li>ç¦»çº¿å¼€å‘ç¯å¢ƒ</li>
</ul>
<h2 id="äºŒã€å®‰è£…ä¸é…ç½®"><a href="#äºŒã€å®‰è£…ä¸é…ç½®" class="headerlink" title="äºŒã€å®‰è£…ä¸é…ç½®"></a>äºŒã€å®‰è£…ä¸é…ç½®</h2><h3 id="2-1-ç³»ç»Ÿè¦æ±‚"><a href="#2-1-ç³»ç»Ÿè¦æ±‚" class="headerlink" title="2.1 ç³»ç»Ÿè¦æ±‚"></a>2.1 ç³»ç»Ÿè¦æ±‚</h3><p>Claude Code æ”¯æŒä»¥ä¸‹æ“ä½œç³»ç»Ÿï¼š</p>
<ul>
<li>macOSï¼ˆIntel å’Œ Apple Siliconï¼‰</li>
<li>Linuxï¼ˆUbuntu, Debian, Fedora ç­‰ï¼‰</li>
<li>Windowsï¼ˆé€šè¿‡ WSLï¼‰</li>
</ul>
<h3 id="2-2-å®‰è£…æ­¥éª¤"><a href="#2-2-å®‰è£…æ­¥éª¤" class="headerlink" title="2.2 å®‰è£…æ­¥éª¤"></a>2.2 å®‰è£…æ­¥éª¤</h3><p><strong>ä½¿ç”¨ npm å®‰è£…ï¼ˆæ¨èï¼‰ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…¨å±€å®‰è£…</span></span><br><span class="line">npm install -g @anthropic-ai/claude-code</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯å®‰è£…</span></span><br><span class="line">claude --version</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ Homebrew å®‰è£…ï¼ˆmacOSï¼‰ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew tap anthropic/claude-code</span><br><span class="line">brew install claude-code</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ pip å®‰è£…ï¼ˆPython ç¯å¢ƒï¼‰ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install claude-code</span><br></pre></td></tr></table></figure>

<h3 id="2-3-API-é…ç½®"><a href="#2-3-API-é…ç½®" class="headerlink" title="2.3 API é…ç½®"></a>2.3 API é…ç½®</h3><p>é¦–æ¬¡ä½¿ç”¨éœ€è¦é…ç½® Anthropic API å¯†é’¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–¹å¼1ï¼šé€šè¿‡ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> ANTHROPIC_API_KEY=<span class="string">&quot;your-api-key-here&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹å¼2ï¼šé€šè¿‡é…ç½®æ–‡ä»¶</span></span><br><span class="line">claude configure</span><br></pre></td></tr></table></figure>

<p><strong>è·å– API å¯†é’¥ï¼š</strong></p>
<ol>
<li>è®¿é—® <a href="https://console.anthropic.com/">Anthropic Console</a></li>
<li>æ³¨å†Œæˆ–ç™»å½•è´¦å·</li>
<li>åœ¨ API Keys éƒ¨åˆ†åˆ›å»ºæ–°å¯†é’¥</li>
<li>å¤åˆ¶å¯†é’¥å¹¶ä¿å­˜åˆ°å®‰å…¨ä½ç½®</li>
</ol>
<p><strong>é…ç½®æ–‡ä»¶ä½ç½®ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># macOS/Linux</span></span><br><span class="line">~/.claude/config.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows</span></span><br><span class="line">%APPDATA%\claude\config.json</span><br></pre></td></tr></table></figure>

<p>é…ç½®æ–‡ä»¶æ ¼å¼ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;apiKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sk-ant-xxxxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;defaultModel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;claude-3-5-sonnet-20241022&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;maxTokens&quot;</span><span class="punctuation">:</span> <span class="number">4096</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;temperature&quot;</span><span class="punctuation">:</span> <span class="number">0.7</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-IDE-é›†æˆ"><a href="#2-4-IDE-é›†æˆ" class="headerlink" title="2.4 IDE é›†æˆ"></a>2.4 IDE é›†æˆ</h3><p><strong>VS Code é›†æˆï¼š</strong></p>
<ol>
<li>å®‰è£… Claude Code æ‰©å±•</li>
<li>æ‰“å¼€å‘½ä»¤é¢æ¿ï¼ˆCmd+Shift+P &#x2F; Ctrl+Shift+Pï¼‰</li>
<li>è¾“å…¥ â€œClaude Code: Ask Claudeâ€</li>
<li>å¼€å§‹ä½¿ç”¨</li>
</ol>
<p><strong>JetBrains IDEs é›†æˆï¼š</strong></p>
<ol>
<li>å®‰è£… Claude Code æ’ä»¶</li>
<li>åœ¨ Tools èœå•ä¸­æ‰¾åˆ° Claude Code</li>
<li>ç›´æ¥ä¸é¡¹ç›®äº¤äº’</li>
</ol>
<h2 id="ä¸‰ã€åŸºç¡€ä½¿ç”¨"><a href="#ä¸‰ã€åŸºç¡€ä½¿ç”¨" class="headerlink" title="ä¸‰ã€åŸºç¡€ä½¿ç”¨"></a>ä¸‰ã€åŸºç¡€ä½¿ç”¨</h2><h3 id="3-1-å‘½ä»¤è¡ŒåŸºç¡€"><a href="#3-1-å‘½ä»¤è¡ŒåŸºç¡€" class="headerlink" title="3.1 å‘½ä»¤è¡ŒåŸºç¡€"></a>3.1 å‘½ä»¤è¡ŒåŸºç¡€</h3><p><strong>å¯åŠ¨äº¤äº’æ¨¡å¼ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /path/to/your/project</span><br><span class="line">claude</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥äº¤äº’æ¨¡å¼åï¼Œä½ å¯ä»¥ç›´æ¥ä¸ Claude å¯¹è¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯ Claudeï¼Œå‡†å¤‡å¸®åŠ©ä½ å¤„ç†ä»£ç ã€‚</span><br><span class="line"></span><br><span class="line">è¯·å‘Šè¯‰æˆ‘ä½ æƒ³åšä»€ä¹ˆï¼Ÿ</span><br></pre></td></tr></table></figure>

<p><strong>å¸¸ç”¨å‘½ä»¤ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥æé—®</span></span><br><span class="line">claude <span class="string">&quot;è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„ä½œç”¨&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ææ–‡ä»¶</span></span><br><span class="line">claude analyze src/utils/helper.ts</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆä»£ç </span></span><br><span class="line">claude generate --<span class="built_in">type</span> <span class="keyword">function</span> --language typescript <span class="string">&quot;åˆ›å»ºä¸€ä¸ªå»æŠ–å‡½æ•°&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ„ä»£ç </span></span><br><span class="line">claude refactor src/components/Header.tsx --goal <span class="string">&quot;ä¼˜åŒ–æ€§èƒ½&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-ç†è§£é¡¹ç›®ç»“æ„"><a href="#3-2-ç†è§£é¡¹ç›®ç»“æ„" class="headerlink" title="3.2 ç†è§£é¡¹ç›®ç»“æ„"></a>3.2 ç†è§£é¡¹ç›®ç»“æ„</h3><p><strong>è®© Claude ç†Ÿæ‚‰ä½ çš„é¡¹ç›®ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude <span class="string">&quot;è¯·å¸®æˆ‘åˆ†æè¿™ä¸ªé¡¹ç›®çš„ç»“æ„&quot;</span></span><br></pre></td></tr></table></figure>

<p>Claude ä¼šæ‰«æé¡¹ç›®å¹¶æä¾›ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ğŸ“ é¡¹ç›®ç»“æ„åˆ†æ</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯ä¸€ä¸ª React + TypeScript çš„å‰ç«¯é¡¹ç›®ï¼š</span><br><span class="line"></span><br><span class="line">æŠ€æœ¯æ ˆï¼š</span><br><span class="line">- React 18.2.0</span><br><span class="line">- TypeScript 5.1.0</span><br><span class="line">- Vite 5.0.0</span><br><span class="line">- TailwindCSS 3.3.0</span><br><span class="line"></span><br><span class="line">é¡¹ç›®ç»“æ„ï¼š</span><br><span class="line">src/</span><br><span class="line">â”œâ”€â”€ components/    # React ç»„ä»¶</span><br><span class="line">â”œâ”€â”€ pages/         # é¡µé¢ç»„ä»¶</span><br><span class="line">â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°</span><br><span class="line">â”œâ”€â”€ hooks/         # è‡ªå®šä¹‰ Hooks</span><br><span class="line">â”œâ”€â”€ types/         # TypeScript ç±»å‹å®šä¹‰</span><br><span class="line">â””â”€â”€ styles/        # å…¨å±€æ ·å¼</span><br><span class="line"></span><br><span class="line">ä¸»è¦åŠŸèƒ½ï¼š</span><br><span class="line">- ç”¨æˆ·è®¤è¯</span><br><span class="line">- æ•°æ®å¯è§†åŒ–</span><br><span class="line">- å®æ—¶é€šä¿¡</span><br></pre></td></tr></table></figure>

<h3 id="3-3-ä»£ç è§£é‡Š"><a href="#3-3-ä»£ç è§£é‡Š" class="headerlink" title="3.3 ä»£ç è§£é‡Š"></a>3.3 ä»£ç è§£é‡Š</h3><p><strong>è§£é‡Šå•ä¸ªæ–‡ä»¶ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude explain src/hooks/useAuth.ts</span><br></pre></td></tr></table></figure>

<p><strong>è§£é‡Šç‰¹å®šå‡½æ•°ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude <span class="string">&quot;è§£é‡Š useAuth hook çš„å®ç°é€»è¾‘&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>Claude çš„å›åº”ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">useAuth <span class="title class_">Hook</span> è¯¦ç»†è§£æï¼š</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†ç”¨æˆ·è®¤è¯çš„è‡ªå®šä¹‰ <span class="title class_">Hook</span>ã€‚</span><br><span class="line"></span><br><span class="line">ä¸»è¦åŠŸèƒ½ï¼š</span><br><span class="line"><span class="number">1.</span> ç®¡ç†ç”¨æˆ·ç™»å½•çŠ¶æ€</span><br><span class="line"><span class="number">2.</span> æä¾›ç™»å½•/ç™»å‡ºæ–¹æ³•</span><br><span class="line"><span class="number">3.</span> æŒä¹…åŒ–è®¤è¯ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">å®ç°ç»†èŠ‚ï¼š</span><br><span class="line">- ä½¿ç”¨ useState ç®¡ç† user çŠ¶æ€</span><br><span class="line">- ä½¿ç”¨ useEffect åœ¨ç»„ä»¶æŒ‚è½½æ—¶æ£€æŸ¥æœ¬åœ°å­˜å‚¨</span><br><span class="line">- login æ–¹æ³•ï¼šéªŒè¯å‡­æ® â†’ å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ â†’ æ›´æ–°çŠ¶æ€</span><br><span class="line">- logout æ–¹æ³•ï¼šæ¸…é™¤æœ¬åœ°å­˜å‚¨ â†’ é‡ç½®çŠ¶æ€</span><br><span class="line"></span><br><span class="line">ä¾èµ–ï¼š</span><br><span class="line">- <span class="variable language_">localStorage</span>ï¼ˆæŒä¹…åŒ–ï¼‰</span><br><span class="line">- auth <span class="variable constant_">API</span>ï¼ˆåç«¯éªŒè¯ï¼‰</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ç¤ºä¾‹ï¼š</span><br><span class="line"><span class="keyword">const</span> &#123; user, login, logout, isAuthenticated &#125; = <span class="title function_">useAuth</span>();</span><br></pre></td></tr></table></figure>

<h3 id="3-4-ä»£ç ç”Ÿæˆ"><a href="#3-4-ä»£ç ç”Ÿæˆ" class="headerlink" title="3.4 ä»£ç ç”Ÿæˆ"></a>3.4 ä»£ç ç”Ÿæˆ</h3><p><strong>ç”Ÿæˆæ–°å‡½æ•°ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude generate <span class="string">&quot;åˆ›å»ºä¸€ä¸ª TypeScript å‡½æ•°ï¼Œå®ç°æ·±æ‹·è´åŠŸèƒ½&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿæˆ React ç»„ä»¶ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude generate \</span><br><span class="line">  --<span class="built_in">type</span> component \</span><br><span class="line">  --language typescript \</span><br><span class="line">  --framework react \</span><br><span class="line">  <span class="string">&quot;åˆ›å»ºä¸€ä¸ªç”¨æˆ·ä¿¡æ¯å¡ç‰‡ç»„ä»¶ï¼ŒåŒ…å«å¤´åƒã€åå­—ã€ç®€ä»‹å’Œå…³æ³¨æŒ‰é’®&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿæˆæµ‹è¯•ä»£ç ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude <span class="built_in">test</span> \</span><br><span class="line">  --file src/utils/validator.ts \</span><br><span class="line">  --framework jest \</span><br><span class="line">  --coverage 80</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€è¿›é˜¶æŠ€å·§"><a href="#å››ã€è¿›é˜¶æŠ€å·§" class="headerlink" title="å››ã€è¿›é˜¶æŠ€å·§"></a>å››ã€è¿›é˜¶æŠ€å·§</h2><h3 id="4-1-å¤šæ–‡ä»¶é‡æ„"><a href="#4-1-å¤šæ–‡ä»¶é‡æ„" class="headerlink" title="4.1 å¤šæ–‡ä»¶é‡æ„"></a>4.1 å¤šæ–‡ä»¶é‡æ„</h3><p><strong>åœºæ™¯ï¼šé‡æ„ API è°ƒç”¨å±‚</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude refactor \</span><br><span class="line">  --files <span class="string">&quot;src/api/*.ts&quot;</span> \</span><br><span class="line">  --goal <span class="string">&quot;ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œæ·»åŠ é‡è¯•æœºåˆ¶ï¼Œæ”¹è¿›ç±»å‹å®šä¹‰&quot;</span></span><br></pre></td></tr></table></figure>

<p>Claude ä¼šï¼š</p>
<ol>
<li>åˆ†ææ‰€æœ‰ç›¸å…³æ–‡ä»¶</li>
<li>è¯†åˆ«å…±åŒæ¨¡å¼</li>
<li>è®¾è®¡ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ç­–ç•¥</li>
<li>å®ç°é‡æ„æ–¹æ¡ˆ</li>
<li>ç¡®ä¿ç±»å‹å®‰å…¨</li>
<li>ç”Ÿæˆé‡æ„æŠ¥å‘Š</li>
</ol>
<p><strong>é‡æ„ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é‡æ„å‰</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/users/<span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">json</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡æ„åï¼ˆClaude è‡ªåŠ¨ç”Ÿæˆï¼‰</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">string</span></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetchWithRetry</span>(<span class="string">`/api/users/<span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">if</span> (!res.<span class="property">ok</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ApiError</span>(res.<span class="property">status</span>, <span class="string">&#x27;Failed to fetch user&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    logger.<span class="title function_">error</span>(<span class="string">&#x27;getUser error&#x27;</span>, &#123; id, error &#125;);</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-è°ƒè¯•å¤æ‚-Bug"><a href="#4-2-è°ƒè¯•å¤æ‚-Bug" class="headerlink" title="4.2 è°ƒè¯•å¤æ‚ Bug"></a>4.2 è°ƒè¯•å¤æ‚ Bug</h3><p><strong>æ™ºèƒ½è°ƒè¯•æµç¨‹ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude debug \</span><br><span class="line">  --file src/components/DataGrid.tsx \</span><br><span class="line">  --issue <span class="string">&quot;æ»šåŠ¨æ—¶æ€§èƒ½ä¸‹é™ï¼Œå¸§ç‡ä½äº 30fps&quot;</span></span><br></pre></td></tr></table></figure>

<p>Claude ä¼šï¼š</p>
<ol>
<li>åˆ†æä»£ç æ€§èƒ½ç“¶é¢ˆ</li>
<li>è¯†åˆ«é—®é¢˜æ ¹æºï¼ˆå¦‚ï¼šæœªä½¿ç”¨è™šæ‹ŸåŒ–ã€é¢‘ç¹é‡æ¸²æŸ“ï¼‰</li>
<li>æä¾›ä¼˜åŒ–æ–¹æ¡ˆ</li>
<li>ç”Ÿæˆä¿®å¤ä»£ç </li>
</ol>
<p><strong>è°ƒè¯•è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ğŸ” æ€§èƒ½é—®é¢˜è¯Šæ–­</span><br><span class="line"></span><br><span class="line">é—®é¢˜æ ¹æºï¼š</span><br><span class="line">1. onRowClick è§¦å‘æ•´ä¸ªè¡¨æ ¼é‡æ¸²æŸ“</span><br><span class="line">2. æœªä½¿ç”¨ React.memo ä¼˜åŒ–è¡Œç»„ä»¶</span><br><span class="line">3. è™šæ‹Ÿæ»šåŠ¨é…ç½®ä¸å½“</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line">âœ… ä½¿ç”¨ React.memo åŒ…è£…è¡Œç»„ä»¶</span><br><span class="line">âœ… å®ç°è¡Œçº§ shouldComponentUpdate</span><br><span class="line">âœ… è°ƒæ•´è™šæ‹Ÿæ»šåŠ¨ç¼“å†²åŒºå¤§å°</span><br><span class="line"></span><br><span class="line">é¢„æœŸæ”¹è¿›ï¼š</span><br><span class="line">- FPS ä» 28 â†’ 58</span><br><span class="line">- å†…å­˜ä½¿ç”¨å‡å°‘ 40%</span><br></pre></td></tr></table></figure>

<h3 id="4-3-è‡ªåŠ¨åŒ–æµ‹è¯•ç”Ÿæˆ"><a href="#4-3-è‡ªåŠ¨åŒ–æµ‹è¯•ç”Ÿæˆ" class="headerlink" title="4.3 è‡ªåŠ¨åŒ–æµ‹è¯•ç”Ÿæˆ"></a>4.3 è‡ªåŠ¨åŒ–æµ‹è¯•ç”Ÿæˆ</h3><p><strong>ç”Ÿæˆå•å…ƒæµ‹è¯•ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude <span class="built_in">test</span> \</span><br><span class="line">  --file src/utils/formatters.ts \</span><br><span class="line">  --<span class="built_in">type</span> unit \</span><br><span class="line">  --framework jest \</span><br><span class="line">  --coverage 90</span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿæˆé›†æˆæµ‹è¯•ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude <span class="built_in">test</span> \</span><br><span class="line">  --feature <span class="string">&quot;ç”¨æˆ·è®¤è¯æµç¨‹&quot;</span> \</span><br><span class="line">  --<span class="built_in">type</span> integration \</span><br><span class="line">  --framework cypress \</span><br><span class="line">  --include-auth</span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿæˆçš„æµ‹è¯•ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/utils/__tests__/formatters.test.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; formatDate, formatCurrency, formatNumber &#125; <span class="keyword">from</span> <span class="string">&#x27;../formatters&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Formatters&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">describe</span>(<span class="string">&#x27;formatDate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should format date correctly&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2024-01-15&#x27;</span>);</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">formatDate</span>(date)).<span class="title function_">toBe</span>(<span class="string">&#x27;2024å¹´1æœˆ15æ—¥&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should handle invalid dates&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">formatDate</span>(<span class="literal">null</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;æ— æ•ˆæ—¥æœŸ&#x27;</span>);</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">formatDate</span>(<span class="literal">undefined</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;æ— æ•ˆæ—¥æœŸ&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should support custom format&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2024-01-15&#x27;</span>);</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">formatDate</span>(date, <span class="string">&#x27;YYYY-MM-DD&#x27;</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;2024-01-15&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">describe</span>(<span class="string">&#x27;formatCurrency&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should format currency with default locale&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">formatCurrency</span>(<span class="number">1234.56</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;Â¥1,234.56&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should handle different currencies&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">formatCurrency</span>(<span class="number">100</span>, <span class="string">&#x27;USD&#x27;</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;$100.00&#x27;</span>);</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">formatCurrency</span>(<span class="number">100</span>, <span class="string">&#x27;EUR&#x27;</span>)).<span class="title function_">toBe</span>(<span class="string">&#x27;â‚¬100.00&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="4-4-æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ"><a href="#4-4-æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ" class="headerlink" title="4.4 æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ"></a>4.4 æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ</h3><p><strong>ç”Ÿæˆ READMEï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude document \</span><br><span class="line">  --<span class="built_in">type</span> readme \</span><br><span class="line">  --output README.md \</span><br><span class="line">  --include <span class="string">&quot;installation, usage, api, contributing&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿæˆ API æ–‡æ¡£ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude document \</span><br><span class="line">  --<span class="built_in">type</span> api \</span><br><span class="line">  --format markdown \</span><br><span class="line">  --output docs/API.md \</span><br><span class="line">  --src src/api/</span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿæˆçš„æ–‡æ¡£ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># API æ–‡æ¡£</span></span><br><span class="line"></span><br><span class="line"><span class="section">## ç”¨æˆ·è®¤è¯ API</span></span><br><span class="line"></span><br><span class="line"><span class="section">### POST /api/auth/login</span></span><br><span class="line"></span><br><span class="line">ç”¨æˆ·ç™»å½•ã€‚</span><br><span class="line"></span><br><span class="line"><span class="strong">**è¯·æ±‚ä½“ï¼š**</span></span><br><span class="line"></span><br><span class="line">\<span class="code">`\`</span>\`typescript</span><br><span class="line">interface LoginRequest &#123;</span><br><span class="line">  email: string;</span><br><span class="line">  password: string;</span><br><span class="line">&#125;</span><br><span class="line">\<span class="code">`\`</span>\`</span><br><span class="line"></span><br><span class="line"><span class="strong">**å“åº”ï¼š**</span></span><br><span class="line"></span><br><span class="line">\<span class="code">`\`</span>\`typescript</span><br><span class="line">interface LoginResponse &#123;</span><br><span class="line">  token: string;</span><br><span class="line">  user: User;</span><br><span class="line">  expiresIn: number;</span><br><span class="line">&#125;</span><br><span class="line">\<span class="code">`\`</span>\`</span><br><span class="line"></span><br><span class="line"><span class="strong">**ç¤ºä¾‹ï¼š**</span></span><br><span class="line"></span><br><span class="line">\<span class="code">`\`</span>\`bash</span><br><span class="line">curl -X POST https://api.example.com/auth/login \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -d &#x27;&#123;&quot;email&quot;:&quot;user@example.com&quot;,&quot;password&quot;:&quot;pass123&quot;&#125;&#x27;</span><br><span class="line">\<span class="code">`\`</span>\`</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€å®æˆ˜æ¡ˆä¾‹"><a href="#äº”ã€å®æˆ˜æ¡ˆä¾‹" class="headerlink" title="äº”ã€å®æˆ˜æ¡ˆä¾‹"></a>äº”ã€å®æˆ˜æ¡ˆä¾‹</h2><h3 id="5-1-æ¡ˆä¾‹1ï¼šå¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®"><a href="#5-1-æ¡ˆä¾‹1ï¼šå¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®" class="headerlink" title="5.1 æ¡ˆä¾‹1ï¼šå¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®"></a>5.1 æ¡ˆä¾‹1ï¼šå¿«é€Ÿä¸Šæ‰‹æ–°é¡¹ç›®</h3><p><strong>åœºæ™¯</strong>ï¼šåˆšæ¥æ‰‹ä¸€ä¸ª legacy é¡¹ç›®ï¼Œéœ€è¦å¿«é€Ÿç†è§£ä»£ç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€æ­¥ï¼šè®© Claude åˆ†æé¡¹ç›®</span></span><br><span class="line">claude <span class="string">&quot;è¯·å¸®æˆ‘å¿«é€Ÿäº†è§£è¿™ä¸ªé¡¹ç›®çš„æ¶æ„ã€ä¸»è¦åŠŸèƒ½å’ŒæŠ€æœ¯æ ˆ&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒæ­¥ï¼šè¯¢é—®å…³é”®æ¨¡å—</span></span><br><span class="line">claude <span class="string">&quot;è§£é‡Š src/core/engine.ts çš„è®¾è®¡æ¨¡å¼å’Œæ ¸å¿ƒé€»è¾‘&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬ä¸‰æ­¥ï¼šäº†è§£ä¾èµ–å…³ç³»</span></span><br><span class="line">claude <span class="string">&quot;å±•ç¤ºå„ä¸ªæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬å››æ­¥ï¼šç”Ÿæˆé¡¹ç›®æ–‡æ¡£</span></span><br><span class="line">claude document --<span class="built_in">type</span> overview --output PROJECT_OVERVIEW.md</span><br></pre></td></tr></table></figure>

<h3 id="5-2-æ¡ˆä¾‹2ï¼šæ‰¹é‡é‡æ„"><a href="#5-2-æ¡ˆä¾‹2ï¼šæ‰¹é‡é‡æ„" class="headerlink" title="5.2 æ¡ˆä¾‹2ï¼šæ‰¹é‡é‡æ„"></a>5.2 æ¡ˆä¾‹2ï¼šæ‰¹é‡é‡æ„</h3><p><strong>åœºæ™¯</strong>ï¼šå°† JavaScript é¡¹ç›®è¿ç§»åˆ° TypeScriptã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸€æ¬¡æ€§é…ç½® TypeScript</span></span><br><span class="line">claude migrate \</span><br><span class="line">  --from javascript \</span><br><span class="line">  --to typescript \</span><br><span class="line">  --project-root src/ \</span><br><span class="line">  --strict-mode \</span><br><span class="line">  --preserve-tests</span><br></pre></td></tr></table></figure>

<p><strong>Claude ä¼šè‡ªåŠ¨ï¼š</strong></p>
<ol>
<li>ä¸ºæ‰€æœ‰ <code>.js</code> æ–‡ä»¶åˆ›å»ºå¯¹åº”çš„ <code>.ts</code> æ–‡ä»¶</li>
<li>æ·»åŠ ç±»å‹æ³¨è§£</li>
<li>åˆ›å»ºå¿…è¦çš„æ¥å£å’Œç±»å‹å®šä¹‰</li>
<li>æ›´æ–° import&#x2F;export è¯­å¥</li>
<li>é…ç½® tsconfig.json</li>
<li>æ›´æ–°æ„å»ºè„šæœ¬</li>
</ol>
<h3 id="5-3-æ¡ˆä¾‹3ï¼šæ€§èƒ½ä¼˜åŒ–"><a href="#5-3-æ¡ˆä¾‹3ï¼šæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="5.3 æ¡ˆä¾‹3ï¼šæ€§èƒ½ä¼˜åŒ–"></a>5.3 æ¡ˆä¾‹3ï¼šæ€§èƒ½ä¼˜åŒ–</h3><p><strong>åœºæ™¯</strong>ï¼šReact åº”ç”¨åŠ è½½ç¼“æ…¢ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¯Šæ–­æ€§èƒ½é—®é¢˜</span></span><br><span class="line">claude analyze \</span><br><span class="line">  --<span class="built_in">type</span> performance \</span><br><span class="line">  --entry src/App.tsx \</span><br><span class="line">  --goal <span class="string">&quot;å‡å°‘é¦–æ¬¡åŠ è½½æ—¶é—´&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>Claude çš„åˆ†æå’Œå»ºè®®ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ğŸ“Š æ€§èƒ½åˆ†ææŠ¥å‘Š</span><br><span class="line"></span><br><span class="line">ä¸»è¦é—®é¢˜ï¼š</span><br><span class="line">1. Bundle ä½“ç§¯è¿‡å¤§ï¼ˆ2.3MBï¼‰</span><br><span class="line">2. æœªä½¿ç”¨ä»£ç åˆ†å‰²</span><br><span class="line">3. å›¾ç‰‡æœªä¼˜åŒ–</span><br><span class="line">4. ç¬¬ä¸‰æ–¹åº“è¿‡å¤§</span><br><span class="line"></span><br><span class="line">ä¼˜åŒ–æ–¹æ¡ˆï¼š</span><br><span class="line">âœ… å®æ–½è·¯ç”±çº§ä»£ç åˆ†å‰²</span><br><span class="line">âœ… åŠ¨æ€å¯¼å…¥é‡å‹ç»„ä»¶</span><br><span class="line">âœ… ä½¿ç”¨ Webpack çš„ Tree Shaking</span><br><span class="line">âœ… å‹ç¼©å›¾ç‰‡èµ„æº</span><br><span class="line">âœ… å¯ç”¨ Gzip å‹ç¼©</span><br><span class="line"></span><br><span class="line">é¢„æœŸç»“æœï¼š</span><br><span class="line">- Bundle ä½“ç§¯ï¼š2.3MB â†’ 850KB</span><br><span class="line">- é¦–å±åŠ è½½æ—¶é—´ï¼š4.2s â†’ 1.8s</span><br><span class="line">- Lighthouse æ€§èƒ½è¯„åˆ†ï¼š58 â†’ 92</span><br></pre></td></tr></table></figure>

<h3 id="5-4-æ¡ˆä¾‹4ï¼šç¼–å†™å•å…ƒæµ‹è¯•"><a href="#5-4-æ¡ˆä¾‹4ï¼šç¼–å†™å•å…ƒæµ‹è¯•" class="headerlink" title="5.4 æ¡ˆä¾‹4ï¼šç¼–å†™å•å…ƒæµ‹è¯•"></a>5.4 æ¡ˆä¾‹4ï¼šç¼–å†™å•å…ƒæµ‹è¯•</h3><p><strong>åœºæ™¯</strong>ï¼šä¸ºä¸€ä¸ªå¤æ‚çš„å·¥å…·å‡½æ•°ç¼–å†™æµ‹è¯•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŸå‡½æ•°</span></span><br><span class="line">claude show src/utils/dataProcessor.ts</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæµ‹è¯•</span></span><br><span class="line">claude <span class="built_in">test</span> \</span><br><span class="line">  --file src/utils/dataProcessor.ts \</span><br><span class="line">  --framework jest \</span><br><span class="line">  --coverage 95 \</span><br><span class="line">  --edge-cases</span><br></pre></td></tr></table></figure>

<p><strong>Claude ç”Ÿæˆçš„æµ‹è¯•ï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/utils/__tests__/dataProcessor.test.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; processData, filterValidData, aggregateByCategory &#125;</span><br><span class="line">  <span class="keyword">from</span> <span class="string">&#x27;../dataProcessor&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;dataProcessor&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">describe</span>(<span class="string">&#x27;processData&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should process valid data correctly&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> input = [</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">value</span>: <span class="number">100</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>, <span class="attr">value</span>: <span class="number">200</span> &#125;</span><br><span class="line">      ];</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title function_">processData</span>(input);</span><br><span class="line">      <span class="title function_">expect</span>(result).<span class="title function_">toHaveLength</span>(<span class="number">2</span>);</span><br><span class="line">      <span class="title function_">expect</span>(result[<span class="number">0</span>].<span class="property">processedValue</span>).<span class="title function_">toBe</span>(<span class="number">100</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should handle empty array&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">processData</span>([])).<span class="title function_">toEqual</span>([]);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should throw on invalid input&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(<span class="function">() =&gt;</span> <span class="title function_">processData</span>(<span class="literal">null</span>)).<span class="title function_">toThrow</span>(<span class="string">&#x27;Invalid input&#x27;</span>);</span><br><span class="line">      <span class="title function_">expect</span>(<span class="function">() =&gt;</span> <span class="title function_">processData</span>(<span class="literal">undefined</span>)).<span class="title function_">toThrow</span>(<span class="string">&#x27;Invalid input&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should handle large datasets efficiently&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> largeInput = <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="literal">null</span>).<span class="title function_">map</span>(<span class="function">(<span class="params">_, i</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">id</span>: i,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">`Item<span class="subst">$&#123;i&#125;</span>`</span>,</span><br><span class="line">        <span class="attr">value</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">1000</span></span><br><span class="line">      &#125;));</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> start = performance.<span class="title function_">now</span>();</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title function_">processData</span>(largeInput);</span><br><span class="line">      <span class="keyword">const</span> duration = performance.<span class="title function_">now</span>() - start;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">expect</span>(result).<span class="title function_">toHaveLength</span>(<span class="number">10000</span>);</span><br><span class="line">      <span class="title function_">expect</span>(duration).<span class="title function_">toBeLessThan</span>(<span class="number">100</span>); <span class="comment">// åº”åœ¨ 100ms å†…å®Œæˆ</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">describe</span>(<span class="string">&#x27;filterValidData&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should filter out invalid items&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> input = [</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">value</span>: <span class="number">10</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="literal">null</span>, <span class="attr">value</span>: <span class="number">20</span> &#125;,  <span class="comment">// æ— æ•ˆ</span></span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">value</span>: <span class="literal">null</span> &#125;,   <span class="comment">// æ— æ•ˆ</span></span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">value</span>: <span class="number">40</span> &#125;</span><br><span class="line">      ];</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title function_">filterValidData</span>(input);</span><br><span class="line">      <span class="title function_">expect</span>(result).<span class="title function_">toEqual</span>([</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">value</span>: <span class="number">10</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">value</span>: <span class="number">40</span> &#125;</span><br><span class="line">      ]);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">describe</span>(<span class="string">&#x27;aggregateByCategory&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&#x27;should aggregate correctly&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> input = [</span><br><span class="line">        &#123; <span class="attr">category</span>: <span class="string">&#x27;A&#x27;</span>, <span class="attr">value</span>: <span class="number">10</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">category</span>: <span class="string">&#x27;B&#x27;</span>, <span class="attr">value</span>: <span class="number">20</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">category</span>: <span class="string">&#x27;A&#x27;</span>, <span class="attr">value</span>: <span class="number">30</span> &#125;</span><br><span class="line">      ];</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title function_">aggregateByCategory</span>(input);</span><br><span class="line">      <span class="title function_">expect</span>(result).<span class="title function_">toEqual</span>(&#123;</span><br><span class="line">        <span class="attr">A</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">B</span>: <span class="number">20</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€é«˜çº§æŠ€å·§"><a href="#å…­ã€é«˜çº§æŠ€å·§" class="headerlink" title="å…­ã€é«˜çº§æŠ€å·§"></a>å…­ã€é«˜çº§æŠ€å·§</h2><h3 id="6-1-è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿"><a href="#6-1-è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿" class="headerlink" title="6.1 è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿"></a>6.1 è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿</h3><p>åˆ›å»º <code>.claude/prompts.json</code>ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;code-review&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯·å®¡æŸ¥ä»¥ä¸‹ä»£ç ï¼Œé‡ç‚¹å…³æ³¨ï¼š\n1. ä»£ç è´¨é‡å’Œå¯è¯»æ€§\n2. æ½œåœ¨çš„æ€§èƒ½é—®é¢˜\n3. å®‰å…¨æ¼æ´\n4. æœ€ä½³å®è·µéµå¾ªæƒ…å†µ&quot;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;refactor-suggestion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯·åˆ†æä»¥ä¸‹ä»£ç å¹¶æä¾›é‡æ„å»ºè®®ï¼š\n- è¯†åˆ«ä»£ç å¼‚å‘³\n- æä¾›æ”¹è¿›æ–¹æ¡ˆ\n- ç»™å‡ºé‡æ„å‰åçš„å¯¹æ¯”&quot;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;explain-like-im-five&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯·åƒå¯¹5å²å­©å­è§£é‡Šä¸€æ ·ï¼Œç”¨ç®€å•çš„è¯­è¨€è¯´æ˜è¿™æ®µä»£ç çš„ä½œç”¨&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨è‡ªå®šä¹‰æç¤ºè¯ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">claude prompt code-review --file src/utils/helper.ts</span><br><span class="line"></span><br><span class="line">claude prompt explain-like-im-five --file src/core/auth.ts</span><br></pre></td></tr></table></figure>

<h3 id="6-2-å·¥ä½œæµé›†æˆ"><a href="#6-2-å·¥ä½œæµé›†æˆ" class="headerlink" title="6.2 å·¥ä½œæµé›†æˆ"></a>6.2 å·¥ä½œæµé›†æˆ</h3><p><strong>Git Hook é›†æˆï¼š</strong></p>
<p>åˆ›å»º <code>.git/hooks/pre-commit</code>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œ Claude æ£€æŸ¥æš‚å­˜çš„æ–‡ä»¶</span></span><br><span class="line">claude check --staged --<span class="built_in">type</span> lint</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;âŒ ä»£ç æ£€æŸ¥æœªé€šè¿‡ï¼Œè¯·ä¿®å¤åå†æäº¤&quot;</span></span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p><strong>CI&#x2F;CD é›†æˆï¼š</strong></p>
<p><code>.github/workflows/claude-review.yml</code>:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Claude</span> <span class="string">Code</span> <span class="string">Review</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">types:</span> [<span class="string">opened</span>, <span class="string">synchronize</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">review:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Claude</span> <span class="string">Code</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">-g</span> <span class="string">@anthropic-ai/claude-code</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">Claude</span> <span class="string">Review</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          claude review \</span></span><br><span class="line"><span class="string">            --files $&#123;&#123; github.event.pull_request.changed_files &#125;&#125; \</span></span><br><span class="line"><span class="string">            --output review.md</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Comment</span> <span class="string">on</span> <span class="string">PR</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/github-script@v6</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">github-token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">script:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            const fs = require(&#x27;fs&#x27;);</span></span><br><span class="line"><span class="string">            const review = fs.readFileSync(&#x27;review.md&#x27;, &#x27;utf8&#x27;);</span></span><br><span class="line"><span class="string">            github.rest.issues.createComment(&#123;</span></span><br><span class="line"><span class="string">              ...context.issue,</span></span><br><span class="line"><span class="string">              body: review</span></span><br><span class="line"><span class="string">            &#125;);</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-å¤šæ¨¡å‹åä½œ"><a href="#6-3-å¤šæ¨¡å‹åä½œ" class="headerlink" title="6.3 å¤šæ¨¡å‹åä½œ"></a>6.3 å¤šæ¨¡å‹åä½œ</h3><p><strong>ä½¿ç”¨ä¸åŒæ¨¡å‹å¤„ç†ä¸åŒä»»åŠ¡ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ Claude 3 Opus è¿›è¡Œå¤æ‚æ¨ç†</span></span><br><span class="line">claude --model claude-3-opus-20240229 \</span><br><span class="line">  <span class="string">&quot;è®¾è®¡ä¸€ä¸ªå¾®å‰ç«¯æ¶æ„æ–¹æ¡ˆ&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ Claude 3 Sonnet è¿›è¡Œä»£ç ç”Ÿæˆ</span></span><br><span class="line">claude --model claude-3-sonnet-20240229 \</span><br><span class="line">  generate --<span class="built_in">type</span> component</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ Claude 3 Haiku è¿›è¡Œå¿«é€Ÿåˆ†æ</span></span><br><span class="line">claude --model claude-3-haiku-20240307 \</span><br><span class="line">  analyze src/</span><br></pre></td></tr></table></figure>

<h3 id="6-4-æ€§èƒ½ä¼˜åŒ–æŠ€å·§"><a href="#6-4-æ€§èƒ½ä¼˜åŒ–æŠ€å·§" class="headerlink" title="6.4 æ€§èƒ½ä¼˜åŒ–æŠ€å·§"></a>6.4 æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h3><p><strong>é™åˆ¶ä¸Šä¸‹æ–‡èŒƒå›´ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åªåˆ†æç‰¹å®šç›®å½•</span></span><br><span class="line">claude analyze src/components/ --depth 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶</span></span><br><span class="line">claude analyze src/ --exclude <span class="string">&quot;node_modules,dist,test&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ç¼“å­˜ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯ç”¨ç¼“å­˜</span></span><br><span class="line"><span class="built_in">export</span> CLAUDE_CACHE=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…é™¤ç¼“å­˜</span></span><br><span class="line">claude cache clear</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€æœ€ä½³å®è·µ"><a href="#ä¸ƒã€æœ€ä½³å®è·µ" class="headerlink" title="ä¸ƒã€æœ€ä½³å®è·µ"></a>ä¸ƒã€æœ€ä½³å®è·µ</h2><h3 id="7-1-å®‰å…¨æ€§"><a href="#7-1-å®‰å…¨æ€§" class="headerlink" title="7.1 å®‰å…¨æ€§"></a>7.1 å®‰å…¨æ€§</h3><p><strong>ä¿æŠ¤æ•æ„Ÿä¿¡æ¯ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º .claudeignore</span></span><br><span class="line"><span class="built_in">cat</span> &gt; .claudeignore &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">.env</span></span><br><span class="line"><span class="string">*.key</span></span><br><span class="line"><span class="string">*.pem</span></span><br><span class="line"><span class="string">secrets/</span></span><br><span class="line"><span class="string">node_modules/</span></span><br><span class="line"><span class="string">dist/</span></span><br><span class="line"><span class="string">.git/</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸è¦åœ¨å‘½ä»¤è¡Œä¸­ç›´æ¥ä½¿ç”¨ API Key</span></span><br><span class="line"><span class="comment"># âŒ é”™è¯¯</span></span><br><span class="line"><span class="built_in">export</span> API_KEY=<span class="string">&quot;sk-xxxx&quot;</span></span><br><span class="line">claude --api-key <span class="variable">$API_KEY</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ­£ç¡®</span></span><br><span class="line">claude  <span class="comment"># ä¼šè‡ªåŠ¨è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„ API Key</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-æ•ˆç‡ä¼˜åŒ–"><a href="#7-2-æ•ˆç‡ä¼˜åŒ–" class="headerlink" title="7.2 æ•ˆç‡ä¼˜åŒ–"></a>7.2 æ•ˆç‡ä¼˜åŒ–</h3><p><strong>æ‰¹é‡å¤„ç†ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸€æ¬¡åˆ†æå¤šä¸ªæ–‡ä»¶</span></span><br><span class="line">claude analyze \</span><br><span class="line">  src/components/*.tsx \</span><br><span class="line">  src/pages/*.tsx \</span><br><span class="line">  --output analysis.json</span><br></pre></td></tr></table></figure>

<p><strong>åå°è¿è¡Œï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é•¿æ—¶é—´ä»»åŠ¡æ”¾å…¥åå°</span></span><br><span class="line"><span class="built_in">nohup</span> claude refactor src/ &gt; refactor.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<h3 id="7-3-å›¢é˜Ÿåä½œ"><a href="#7-3-å›¢é˜Ÿåä½œ" class="headerlink" title="7.3 å›¢é˜Ÿåä½œ"></a>7.3 å›¢é˜Ÿåä½œ</h3><p><strong>å…±äº«é…ç½®ï¼š</strong></p>
<p>å°† <code>.claude/</code> ç›®å½•åŠ å…¥ç‰ˆæœ¬æ§åˆ¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># .claude/</span></span><br><span class="line">config.json</span><br><span class="line">prompts.json</span><br><span class="line">templates/</span><br></pre></td></tr></table></figure>

<p><strong>é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;team&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å‰ç«¯å›¢é˜Ÿ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;conventions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;codeStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Airbnb Style Guide&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;commitFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Conventional Commits&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;branchNaming&quot;</span><span class="punctuation">:</span> <span class="string">&quot;feature/issue-title&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;sharedPrompts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;pr-review&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯·æŒ‰ä»¥ä¸‹æ ‡å‡†å®¡æŸ¥ PRï¼š...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;bug-fix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä¿®å¤ bug æ—¶è¯·ç¡®ä¿ï¼š...&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-4-å¸¸è§é—®é¢˜"><a href="#7-4-å¸¸è§é—®é¢˜" class="headerlink" title="7.4 å¸¸è§é—®é¢˜"></a>7.4 å¸¸è§é—®é¢˜</h3><p><strong>Q1: Claude Code ä¼šä¿®æ”¹æˆ‘çš„ä»£ç å—ï¼Ÿ</strong></p>
<p>A: é»˜è®¤ä¸ä¼šï¼Œå®ƒåªä¼šæä¾›å»ºè®®ã€‚ä½¿ç”¨ <code>--write</code> æˆ– <code>--apply</code> æ ‡å¿—æ‰ä¼šå®é™…ä¿®æ”¹æ–‡ä»¶ã€‚</p>
<p><strong>Q2: å¦‚ä½•æŸ¥çœ‹ Claude ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ï¼Ÿ</strong></p>
<p>A: ä½¿ç”¨ <code>claude debug --show-context</code> å¯ä»¥çœ‹åˆ° Claude å½“å‰çœ‹åˆ°çš„ä»£ç ä¸Šä¸‹æ–‡ã€‚</p>
<p><strong>Q3: è¶…å‡º Token é™åˆ¶æ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>A: Claude Code ä¼šè‡ªåŠ¨åˆ†å‰²å¤§å‹æ–‡ä»¶ï¼Œæˆ–ä½¿ç”¨ <code>--max-tokens</code> å‚æ•°è°ƒæ•´ã€‚</p>
<p><strong>Q4: æ”¯æŒå“ªäº›ç¼–ç¨‹è¯­è¨€ï¼Ÿ</strong></p>
<p>A: å‡ ä¹æ‰€æœ‰ä¸»æµè¯­è¨€ï¼ŒåŒ…æ‹¬ JavaScript, TypeScript, Python, Java, Go, Rust, C++ ç­‰ã€‚</p>
<h2 id="å…«ã€ä¸å…¶ä»–å·¥å…·çš„å¯¹æ¯”"><a href="#å…«ã€ä¸å…¶ä»–å·¥å…·çš„å¯¹æ¯”" class="headerlink" title="å…«ã€ä¸å…¶ä»–å·¥å…·çš„å¯¹æ¯”"></a>å…«ã€ä¸å…¶ä»–å·¥å…·çš„å¯¹æ¯”</h2><h3 id="8-1-Claude-Code-vs-Cursor"><a href="#8-1-Claude-Code-vs-Cursor" class="headerlink" title="8.1 Claude Code vs Cursor"></a>8.1 Claude Code vs Cursor</h3><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Claude Code</th>
<th>Cursor</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æ¨¡å‹</strong></td>
<td>Claude 3 ç³»åˆ—</td>
<td>GPT-4</td>
</tr>
<tr>
<td><strong>ä»£ç åº“ç†è§£</strong></td>
<td>æ›´æ·±</td>
<td>æ·±</td>
</tr>
<tr>
<td><strong>å¤šæ–‡ä»¶ç¼–è¾‘</strong></td>
<td>å¼ºå¤§</td>
<td>å¼ºå¤§</td>
</tr>
<tr>
<td><strong>IDE é›†æˆ</strong></td>
<td>CLI ä¸ºä¸»</td>
<td>åŸç”Ÿ IDE</td>
</tr>
<tr>
<td><strong>ä»·æ ¼</strong></td>
<td>æŒ‰ç”¨é‡</td>
<td>è®¢é˜…åˆ¶</td>
</tr>
</tbody></table>
<h3 id="8-2-Claude-Code-vs-Aider"><a href="#8-2-Claude-Code-vs-Aider" class="headerlink" title="8.2 Claude Code vs Aider"></a>8.2 Claude Code vs Aider</h3><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Claude Code</th>
<th>Aider</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æ¨¡å‹é€‰æ‹©</strong></td>
<td>ä»… Claude</td>
<td>å¤šæ¨¡å‹</td>
</tr>
<tr>
<td><strong>ä»·æ ¼</strong></td>
<td>è¾ƒè´µ</td>
<td>è¾ƒä¾¿å®œ</td>
</tr>
<tr>
<td><strong>æ˜“ç”¨æ€§</strong></td>
<td>ç®€å•</td>
<td>éœ€è¦é…ç½®</td>
</tr>
<tr>
<td><strong>åŠŸèƒ½</strong></td>
<td>å…¨é¢</td>
<td>ä¸“æ³¨ä»£ç ç¼–è¾‘</td>
</tr>
</tbody></table>
<h2 id="ä¹ã€æœªæ¥å±•æœ›"><a href="#ä¹ã€æœªæ¥å±•æœ›" class="headerlink" title="ä¹ã€æœªæ¥å±•æœ›"></a>ä¹ã€æœªæ¥å±•æœ›</h2><h3 id="9-1-å³å°†æ¨å‡ºçš„åŠŸèƒ½"><a href="#9-1-å³å°†æ¨å‡ºçš„åŠŸèƒ½" class="headerlink" title="9.1 å³å°†æ¨å‡ºçš„åŠŸèƒ½"></a>9.1 å³å°†æ¨å‡ºçš„åŠŸèƒ½</h3><ul>
<li>ğŸ“ <strong>æ›´å¥½çš„æ–‡æ¡£ç”Ÿæˆ</strong></li>
<li>ğŸ”„ <strong>Git å·¥ä½œæµæ·±åº¦é›†æˆ</strong></li>
<li>ğŸ¨ <strong>UI ç•Œé¢ï¼ˆç›®å‰æ˜¯çº¯ CLIï¼‰</strong></li>
<li>ğŸŒ <strong>å¤šè¯­è¨€æ”¯æŒå¢å¼º</strong></li>
</ul>
<h3 id="9-2-ç¤¾åŒºç”Ÿæ€"><a href="#9-2-ç¤¾åŒºç”Ÿæ€" class="headerlink" title="9.2 ç¤¾åŒºç”Ÿæ€"></a>9.2 ç¤¾åŒºç”Ÿæ€</h3><ul>
<li><strong>æ’ä»¶ç³»ç»Ÿ</strong>ï¼šå…è®¸ç¬¬ä¸‰æ–¹æ‰©å±•åŠŸèƒ½</li>
<li><strong>æ¨¡æ¿åº“</strong>ï¼šåˆ†äº«å¸¸ç”¨çš„æç¤ºè¯æ¨¡æ¿</li>
<li><strong>æœ€ä½³å®è·µåº“</strong>ï¼šç¤¾åŒºè´¡çŒ®çš„ä½¿ç”¨æ¡ˆä¾‹</li>
</ul>
<h2 id="åã€æ€»ç»“"><a href="#åã€æ€»ç»“" class="headerlink" title="åã€æ€»ç»“"></a>åã€æ€»ç»“</h2><h3 id="å…³é”®è¦ç‚¹"><a href="#å…³é”®è¦ç‚¹" class="headerlink" title="å…³é”®è¦ç‚¹"></a>å…³é”®è¦ç‚¹</h3><ol>
<li>âœ… <strong>Claude Code æ˜¯å¼ºå¤§çš„ AI ç¼–ç¨‹åŠ©æ‰‹</strong>ï¼Œä¸åŒäºä¼ ç»Ÿä»£ç è¡¥å…¨å·¥å…·</li>
<li>âœ… <strong>å®‰è£…ç®€å•</strong>ï¼šä¸€è¡Œå‘½ä»¤å³å¯å®‰è£…</li>
<li>âœ… <strong>åŠŸèƒ½å…¨é¢</strong>ï¼šä»ä»£ç è§£é‡Šåˆ°è‡ªåŠ¨åŒ–é‡æ„</li>
<li>âœ… <strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥</strong>ï¼šç†è§£æ•´ä¸ªé¡¹ç›®ç»“æ„</li>
<li>âœ… <strong>æŒç»­è¿›åŒ–</strong>ï¼šAnthropic æŒç»­æ”¹è¿›åŠŸèƒ½</li>
</ol>
<h3 id="å­¦ä¹ è·¯å¾„"><a href="#å­¦ä¹ è·¯å¾„" class="headerlink" title="å­¦ä¹ è·¯å¾„"></a>å­¦ä¹ è·¯å¾„</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…¥é—¨é˜¶æ®µï¼ˆ1-2å‘¨ï¼‰</span><br><span class="line">â”œâ”€â”€ å®‰è£…é…ç½®</span><br><span class="line">â”œâ”€â”€ åŸºç¡€å‘½ä»¤</span><br><span class="line">â”œâ”€â”€ ç®€å•ä»£ç è§£é‡Š</span><br><span class="line">â””â”€â”€ ç”Ÿæˆå°å‡½æ•°</span><br><span class="line"></span><br><span class="line">è¿›é˜¶é˜¶æ®µï¼ˆ1-2æœˆï¼‰</span><br><span class="line">â”œâ”€â”€ å¤æ‚é‡æ„</span><br><span class="line">â”œâ”€â”€ è°ƒè¯•æŠ€å·§</span><br><span class="line">â”œâ”€â”€ æµ‹è¯•ç”Ÿæˆ</span><br><span class="line">â””â”€â”€ æ–‡æ¡£ç”Ÿæˆ</span><br><span class="line"></span><br><span class="line">ç²¾é€šé˜¶æ®µï¼ˆ3-6æœˆï¼‰</span><br><span class="line">â”œâ”€â”€ è‡ªå®šä¹‰æç¤ºè¯</span><br><span class="line">â”œâ”€â”€ å·¥ä½œæµé›†æˆ</span><br><span class="line">â”œâ”€â”€ æ€§èƒ½ä¼˜åŒ–</span><br><span class="line">â””â”€â”€ å›¢é˜Ÿåä½œ</span><br></pre></td></tr></table></figure>

<h3 id="æ¨èèµ„æº"><a href="#æ¨èèµ„æº" class="headerlink" title="æ¨èèµ„æº"></a>æ¨èèµ„æº</h3><ul>
<li>ğŸ“š <a href="https://docs.anthropic.com/claude-code">Claude Code å®˜æ–¹æ–‡æ¡£</a></li>
<li>ğŸ“š <a href="https://docs.anthropic.com/prompt-engineering">Anthropic Prompt Engineering Guide</a></li>
<li>ğŸ’¬ <a href="https://discord.gg/anthropic">Claude Discord ç¤¾åŒº</a></li>
<li>ğŸ¥ <a href="https://www.youtube.com/@claude">YouTube æ•™ç¨‹</a></li>
</ul>
<hr>
<p><strong>ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼š</strong></p>
<ol>
<li>å®‰è£… Claude Code</li>
<li>é€‰æ‹©ä¸€ä¸ªç°æœ‰é¡¹ç›®è¿›è¡Œå®éªŒ</li>
<li>ä»ç®€å•ä»»åŠ¡å¼€å§‹ï¼ˆä»£ç è§£é‡Šã€å°å‡½æ•°ç”Ÿæˆï¼‰</li>
<li>é€æ­¥å°è¯•æ›´å¤æ‚çš„ä»»åŠ¡</li>
<li>æ€»ç»“æœ€ä½³å®è·µå¹¶åˆ†äº«ç»™å›¢é˜Ÿ</li>
</ol>
<p><strong>è®°ä½</strong>ï¼šAI å·¥å…·æ˜¯åŠ©æ‰‹ï¼Œä¸æ˜¯æ›¿ä»£å“ã€‚æœ€å¥½çš„æ•ˆæœæ¥è‡ªäºäººæœºåä½œï¼</p>
<p>ğŸš€ <strong>Happy Coding with Claude!</strong></p>
<hr>
<p><em>æœ¬æ–‡æŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿åˆ†äº«ä½ çš„ä½¿ç”¨ç»éªŒï¼</em></p>
<p><strong>ç›¸å…³æ–‡ç« ï¼š</strong></p>
<ul>
<li><a href="/categories/AI/">æ„å»ºæ™ºèƒ½AIåº”ç”¨ï¼šä»LLMåˆ°AI Agent</a></li>
<li><a href="/categories/%E5%89%8D%E7%AB%AF/%E5%B7%A5%E7%A8%8B%E5%8C%96/">å‰ç«¯å·¥ç¨‹åŒ–å®æˆ˜</a></li>
<li><a href="/categories/%E5%89%8D%E7%AB%AF/TypeScript/">TypeScriptå®Œå…¨æŒ‡å—</a></li>
</ul>
]]></content>
      <categories>
        <category>å·¥å…·</category>
        <category>AI</category>
      </categories>
      <tags>
        <tag>Claude Code</tag>
        <tag>AI</tag>
        <tag>å¼€å‘å·¥å…·</tag>
        <tag>æ•ˆç‡å·¥å…·</tag>
        <tag>å®æˆ˜æ•™ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>AIåº”ç”¨å®æˆ˜ï¼šä»ç†è®ºåˆ°ç”Ÿäº§ç¯å¢ƒçš„å®Œæ•´æŒ‡å—</title>
    <url>/2026/01/20/ai-applications/</url>
    <content><![CDATA[<h2 id="AIåœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„åº”ç”¨"><a href="#AIåœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„åº”ç”¨" class="headerlink" title="AIåœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„åº”ç”¨"></a>AIåœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„åº”ç”¨</h2><p>å°†AIæ¨¡å‹ä»å®éªŒå®¤å¸¦åˆ°ç”Ÿäº§ç¯å¢ƒéœ€è¦è€ƒè™‘å¤šä¸ªæ–¹é¢ï¼šæ€§èƒ½ä¼˜åŒ–ã€å¯æ‰©å±•æ€§ã€ç›‘æ§ç»´æŠ¤ç­‰ã€‚æœ¬æ–‡å°†å¸¦ä½ äº†è§£å¦‚ä½•æ„å»ºå®Œæ•´çš„AIåº”ç”¨ã€‚</p>
<h2 id="å®é™…åº”ç”¨åœºæ™¯"><a href="#å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="å®é™…åº”ç”¨åœºæ™¯"></a>å®é™…åº”ç”¨åœºæ™¯</h2><h3 id="1-æ™ºèƒ½å®¢æœç³»ç»Ÿ"><a href="#1-æ™ºèƒ½å®¢æœç³»ç»Ÿ" class="headerlink" title="1. æ™ºèƒ½å®¢æœç³»ç»Ÿ"></a>1. æ™ºèƒ½å®¢æœç³»ç»Ÿ</h3><p>åŸºäºè‡ªç„¶è¯­è¨€å¤„ç†çš„èŠå¤©æœºå™¨äººï¼Œå¯ä»¥å¤„ç†ç”¨æˆ·å’¨è¯¢ã€è‡ªåŠ¨å›å¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨OpenAI APIæ„å»ºæ™ºèƒ½å®¢æœ</span></span><br><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, HTTPException</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®</span></span><br><span class="line">openai.api_key = <span class="string">&quot;your-api-key&quot;</span></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Message</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    content: <span class="built_in">str</span></span><br><span class="line">    conversation_history: <span class="built_in">list</span> = []</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/chat&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">chat</span>(<span class="params">message: Message</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># æ„å»ºå¯¹è¯ä¸Šä¸‹æ–‡</span></span><br><span class="line">        messages = [</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¢æœåŠ©æ‰‹&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">        messages.extend(message.conversation_history)</span><br><span class="line">        messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: message.content&#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è°ƒç”¨GPT API</span></span><br><span class="line">        response = openai.ChatCompletion.create(</span><br><span class="line">            model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">            messages=messages,</span><br><span class="line">            temperature=<span class="number">0.7</span>,</span><br><span class="line">            max_tokens=<span class="number">1000</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;reply&quot;</span>: response.choices[<span class="number">0</span>].message.content,</span><br><span class="line">            <span class="string">&quot;usage&quot;</span>: response.usage</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">500</span>, detail=<span class="built_in">str</span>(e))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œï¼šuvicorn chatbot:app --reload</span></span><br></pre></td></tr></table></figure>

<h3 id="2-å›¾åƒåˆ†ç±»API"><a href="#2-å›¾åƒåˆ†ç±»API" class="headerlink" title="2. å›¾åƒåˆ†ç±»API"></a>2. å›¾åƒåˆ†ç±»API</h3><p>ä½¿ç”¨FastAPIéƒ¨ç½²å›¾åƒåˆ†ç±»æ¨¡å‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, File, UploadFile</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line">app = FastAPI(title=<span class="string">&quot;å›¾åƒåˆ†ç±»API&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ¨¡å‹</span></span><br><span class="line">model = torch.load(<span class="string">&#x27;models/resnet50.pth&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›¾åƒé¢„å¤„ç†</span></span><br><span class="line">transform = transforms.Compose([</span><br><span class="line">    transforms.Resize(<span class="number">256</span>),</span><br><span class="line">    transforms.CenterCrop(<span class="number">224</span>),</span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">    transforms.Normalize(</span><br><span class="line">        mean=[<span class="number">0.485</span>, <span class="number">0.456</span>, <span class="number">0.406</span>],</span><br><span class="line">        std=[<span class="number">0.229</span>, <span class="number">0.224</span>, <span class="number">0.225</span>]</span><br><span class="line">    )</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç±»åˆ«æ ‡ç­¾ï¼ˆImageNetï¼‰</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;imagenet_classes.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    classes = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines()]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/predict&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">file: UploadFile = File(<span class="params">...</span>)</span>):</span><br><span class="line">    <span class="comment"># è¯»å–å›¾åƒ</span></span><br><span class="line">    image_data = <span class="keyword">await</span> file.read()</span><br><span class="line">    image = Image.<span class="built_in">open</span>(io.BytesIO(image_data))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é¢„å¤„ç†</span></span><br><span class="line">    image_tensor = transform(image).unsqueeze(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é¢„æµ‹</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        outputs = model(image_tensor)</span><br><span class="line">        _, predicted = torch.<span class="built_in">max</span>(outputs, <span class="number">1</span>)</span><br><span class="line">        probabilities = torch.nn.functional.softmax(outputs, dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–Top-3é¢„æµ‹</span></span><br><span class="line">    top3_prob, top3_indices = torch.topk(probabilities, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    results = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        results.append(&#123;</span><br><span class="line">            <span class="string">&quot;class&quot;</span>: classes[top3_indices[<span class="number">0</span>][i]],</span><br><span class="line">            <span class="string">&quot;confidence&quot;</span>: <span class="built_in">float</span>(top3_prob[<span class="number">0</span>][i])</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;filename&quot;</span>: file.filename,</span><br><span class="line">        <span class="string">&quot;predictions&quot;</span>: results</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-æ¨èç³»ç»Ÿ"><a href="#3-æ¨èç³»ç»Ÿ" class="headerlink" title="3. æ¨èç³»ç»Ÿ"></a>3. æ¨èç³»ç»Ÿ</h3><p>åŸºäºååŒè¿‡æ»¤çš„ä¸ªæ€§åŒ–æ¨èï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics.pairwise <span class="keyword">import</span> cosine_similarity</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RecommenderSystem</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.user_item_matrix = <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>.user_similarity = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, ratings</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®­ç»ƒæ¨èæ¨¡å‹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            ratings: ç”¨æˆ·-ç‰©å“è¯„åˆ†çŸ©é˜µ</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.user_item_matrix = ratings</span><br><span class="line">        <span class="comment"># è®¡ç®—ç”¨æˆ·ç›¸ä¼¼åº¦</span></span><br><span class="line">        <span class="variable language_">self</span>.user_similarity = cosine_similarity(ratings)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recommend</span>(<span class="params">self, user_id, top_k=<span class="number">5</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ä¸ºç”¨æˆ·æ¨èç‰©å“</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            user_id: ç”¨æˆ·ID</span></span><br><span class="line"><span class="string">            top_k: è¿”å›å‰Kä¸ªæ¨è</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># æ‰¾åˆ°ç›¸ä¼¼ç”¨æˆ·</span></span><br><span class="line">        similar_users = <span class="variable language_">self</span>.user_similarity[user_id]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®¡ç®—æ¨èåˆ†æ•°</span></span><br><span class="line">        scores = np.zeros(<span class="variable language_">self</span>.user_item_matrix.shape[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> item_id <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.user_item_matrix.shape[<span class="number">1</span>]):</span><br><span class="line">            <span class="comment"># è·³è¿‡å·²è¯„åˆ†ç‰©å“</span></span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.user_item_matrix[user_id, item_id] &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># åŠ æƒæ±‚å’Œ</span></span><br><span class="line">            numerator = <span class="number">0</span></span><br><span class="line">            denominator = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> other_user <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(similar_users)):</span><br><span class="line">                <span class="keyword">if</span> other_user == user_id:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                rating = <span class="variable language_">self</span>.user_item_matrix[other_user, item_id]</span><br><span class="line">                <span class="keyword">if</span> rating &gt; <span class="number">0</span>:</span><br><span class="line">                    numerator += similar_users[other_user] * rating</span><br><span class="line">                    denominator += <span class="built_in">abs</span>(similar_users[other_user])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> denominator &gt; <span class="number">0</span>:</span><br><span class="line">                scores[item_id] = numerator / denominator</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿”å›Top-Kæ¨è</span></span><br><span class="line">        top_items = np.argsort(scores)[::-<span class="number">1</span>][:top_k]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [(item, scores[item]) <span class="keyword">for</span> item <span class="keyword">in</span> top_items]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line">ratings = np.array([</span><br><span class="line">    [<span class="number">5</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>],  <span class="comment"># ç”¨æˆ·0</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],  <span class="comment"># ç”¨æˆ·1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">4</span>],  <span class="comment"># ç”¨æˆ·2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">4</span>],  <span class="comment"># ç”¨æˆ·3</span></span><br><span class="line">    [<span class="number">0</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>],  <span class="comment"># ç”¨æˆ·4</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">recommender = RecommenderSystem()</span><br><span class="line">recommender.fit(ratings)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºç”¨æˆ·0æ¨è</span></span><br><span class="line">recommendations = recommender.recommend(<span class="number">0</span>, top_k=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ¨èç‰©å“:&quot;</span>, recommendations)</span><br></pre></td></tr></table></figure>

<h2 id="æ¨¡å‹éƒ¨ç½²ç­–ç•¥"><a href="#æ¨¡å‹éƒ¨ç½²ç­–ç•¥" class="headerlink" title="æ¨¡å‹éƒ¨ç½²ç­–ç•¥"></a>æ¨¡å‹éƒ¨ç½²ç­–ç•¥</h2><h3 id="1-Dockerå®¹å™¨åŒ–"><a href="#1-Dockerå®¹å™¨åŒ–" class="headerlink" title="1. Dockerå®¹å™¨åŒ–"></a>1. Dockerå®¹å™¨åŒ–</h3><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dockerfile</span></span><br><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.9</span>-slim</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install --no-cache-dir -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶æ¨¡å‹å’Œä»£ç </span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> models/ ./models/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> app.py .</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²ç«¯å£</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;uvicorn&quot;</span>, <span class="string">&quot;app:app&quot;</span>, <span class="string">&quot;--host&quot;</span>, <span class="string">&quot;0.0.0.0&quot;</span>, <span class="string">&quot;--port&quot;</span>, <span class="string">&quot;8000&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># docker-compose.yml</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">api:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MODEL_PATH=/app/models</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./models:/app/models</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:alpine</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx.conf:/etc/nginx/nginx.conf</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">api</span></span><br></pre></td></tr></table></figure>

<h3 id="2-ä½¿ç”¨ONNXè¿›è¡Œæ¨¡å‹ä¼˜åŒ–"><a href="#2-ä½¿ç”¨ONNXè¿›è¡Œæ¨¡å‹ä¼˜åŒ–" class="headerlink" title="2. ä½¿ç”¨ONNXè¿›è¡Œæ¨¡å‹ä¼˜åŒ–"></a>2. ä½¿ç”¨ONNXè¿›è¡Œæ¨¡å‹ä¼˜åŒ–</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°†PyTorchæ¨¡å‹è½¬æ¢ä¸ºONNXæ ¼å¼</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.onnx</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ¨¡å‹</span></span><br><span class="line">model = torch.load(<span class="string">&#x27;model.pth&#x27;</span>)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆç¤ºä¾‹è¾“å…¥</span></span><br><span class="line">dummy_input = torch.randn(<span class="number">1</span>, <span class="number">3</span>, <span class="number">224</span>, <span class="number">224</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å‡ºä¸ºONNX</span></span><br><span class="line">torch.onnx.export(</span><br><span class="line">    model,</span><br><span class="line">    dummy_input,</span><br><span class="line">    <span class="string">&quot;model.onnx&quot;</span>,</span><br><span class="line">    export_params=<span class="literal">True</span>,</span><br><span class="line">    opset_version=<span class="number">12</span>,</span><br><span class="line">    do_constant_folding=<span class="literal">True</span>,</span><br><span class="line">    input_names=[<span class="string">&#x27;input&#x27;</span>],</span><br><span class="line">    output_names=[<span class="string">&#x27;output&#x27;</span>],</span><br><span class="line">    dynamic_axes=&#123;</span><br><span class="line">        <span class="string">&#x27;input&#x27;</span>: &#123;<span class="number">0</span>: <span class="string">&#x27;batch_size&#x27;</span>&#125;,</span><br><span class="line">        <span class="string">&#x27;output&#x27;</span>: &#123;<span class="number">0</span>: <span class="string">&#x27;batch_size&#x27;</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ONNX Runtimeè¿›è¡Œæ¨ç†</span></span><br><span class="line"><span class="keyword">import</span> onnxruntime <span class="keyword">as</span> ort</span><br><span class="line"></span><br><span class="line">session = ort.InferenceSession(<span class="string">&quot;model.onnx&quot;</span>)</span><br><span class="line">input_name = session.get_inputs()[<span class="number">0</span>].name</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨ç†</span></span><br><span class="line">outputs = session.run(<span class="literal">None</span>, &#123;input_name: dummy_input.numpy()&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="3-æ¨¡å‹é‡åŒ–ä¸å‹ç¼©"><a href="#3-æ¨¡å‹é‡åŒ–ä¸å‹ç¼©" class="headerlink" title="3. æ¨¡å‹é‡åŒ–ä¸å‹ç¼©"></a>3. æ¨¡å‹é‡åŒ–ä¸å‹ç¼©</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.quantization</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ¨æ€é‡åŒ–</span></span><br><span class="line">model_dynamic = torch.quantization.quantize_dynamic(</span><br><span class="line">    model, &#123;torch.nn.Linear&#125;, dtype=torch.qint8</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é™æ€é‡åŒ–ï¼ˆéœ€è¦æ ¡å‡†æ•°æ®ï¼‰</span></span><br><span class="line">model.qconfig = torch.quantization.get_default_qconfig(<span class="string">&#x27;fbgemm&#x27;</span>)</span><br><span class="line">model_prepared = torch.quantization.prepare(model)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ ¡å‡†æ•°æ®è¿›è¡Œæ ¡å‡†</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> calibration_dataset:</span><br><span class="line">        model_prepared(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬æ¢ä¸ºé‡åŒ–æ¨¡å‹</span></span><br><span class="line">model_quantized = torch.quantization.convert(model_prepared)</span><br></pre></td></tr></table></figure>

<h2 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h2><h3 id="1-æ‰¹å¤„ç†æ¨ç†"><a href="#1-æ‰¹å¤„ç†æ¨ç†" class="headerlink" title="1. æ‰¹å¤„ç†æ¨ç†"></a>1. æ‰¹å¤„ç†æ¨ç†</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BatchInferenceEngine</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, model, batch_size=<span class="number">32</span>, timeout=<span class="number">0.1</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.model = model</span><br><span class="line">        <span class="variable language_">self</span>.batch_size = batch_size</span><br><span class="line">        <span class="variable language_">self</span>.timeout = timeout</span><br><span class="line">        <span class="variable language_">self</span>.queue = queue.Queue()</span><br><span class="line">        <span class="variable language_">self</span>.executor = ThreadPoolExecutor(max_workers=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¼‚æ­¥é¢„æµ‹æ¥å£&quot;&quot;&quot;</span></span><br><span class="line">        future = <span class="variable language_">self</span>.executor.submit(<span class="variable language_">self</span>._add_to_batch, input_data)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> asyncio.wrap_future(future)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_add_to_batch</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ·»åŠ åˆ°æ‰¹æ¬¡å¹¶ç­‰å¾…ç»“æœ&quot;&quot;&quot;</span></span><br><span class="line">        result_future = &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>.queue.put((input_data, result_future))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç­‰å¾…æ‰¹æ¬¡å®Œæˆ</span></span><br><span class="line">        <span class="keyword">while</span> <span class="string">&#x27;result&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> result_future:</span><br><span class="line">            time.sleep(<span class="number">0.001</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result_future[<span class="string">&#x27;result&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_process_batches</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ‰¹é‡å¤„ç†&quot;&quot;&quot;</span></span><br><span class="line">        batch = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># æ”¶é›†æ‰¹æ¬¡</span></span><br><span class="line">                item, result_future = <span class="variable language_">self</span>.queue.get(timeout=<span class="variable language_">self</span>.timeout)</span><br><span class="line">                batch.append((item, result_future))</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(batch) &gt;= <span class="variable language_">self</span>.batch_size:</span><br><span class="line">                    <span class="variable language_">self</span>._execute_batch(batch)</span><br><span class="line">                    batch = []</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> queue.Empty:</span><br><span class="line">                <span class="keyword">if</span> batch:</span><br><span class="line">                    <span class="variable language_">self</span>._execute_batch(batch)</span><br><span class="line">                    batch = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_execute_batch</span>(<span class="params">self, batch</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ‰§è¡Œæ‰¹é‡æ¨ç†&quot;&quot;&quot;</span></span><br><span class="line">        inputs = [item[<span class="number">0</span>] <span class="keyword">for</span> item <span class="keyword">in</span> batch]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">            outputs = <span class="variable language_">self</span>.model(inputs)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿”å›ç»“æœ</span></span><br><span class="line">        <span class="keyword">for</span> (input_data, result_future), output <span class="keyword">in</span> <span class="built_in">zip</span>(batch, outputs):</span><br><span class="line">            result_future[<span class="string">&#x27;result&#x27;</span>] = output</span><br></pre></td></tr></table></figure>

<h3 id="2-ç¼“å­˜æœºåˆ¶"><a href="#2-ç¼“å­˜æœºåˆ¶" class="headerlink" title="2. ç¼“å­˜æœºåˆ¶"></a>2. ç¼“å­˜æœºåˆ¶</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelCache</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, model, cache_size=<span class="number">1000</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.model = model</span><br><span class="line">        <span class="variable language_">self</span>.cache_size = cache_size</span><br><span class="line"></span><br><span class="line"><span class="meta">    @lru_cache(<span class="params">maxsize=<span class="number">1000</span></span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_hash_input</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;ç”Ÿæˆè¾“å…¥å“ˆå¸Œ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> hashlib.md5(<span class="built_in">str</span>(input_data).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¸¦ç¼“å­˜çš„é¢„æµ‹&quot;&quot;&quot;</span></span><br><span class="line">        input_hash = <span class="variable language_">self</span>._hash_input(input_data)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ£€æŸ¥ç¼“å­˜</span></span><br><span class="line">        <span class="keyword">if</span> input_hash <span class="keyword">in</span> <span class="variable language_">self</span>.cache:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.cache[input_hash]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ¨¡å‹æ¨ç†</span></span><br><span class="line">        result = <span class="variable language_">self</span>.model(input_data)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¼“å­˜ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="variable language_">self</span>.cache) &lt; <span class="variable language_">self</span>.cache_size:</span><br><span class="line">            <span class="variable language_">self</span>.cache[input_hash] = result</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<h2 id="ç›‘æ§ä¸æ—¥å¿—"><a href="#ç›‘æ§ä¸æ—¥å¿—" class="headerlink" title="ç›‘æ§ä¸æ—¥å¿—"></a>ç›‘æ§ä¸æ—¥å¿—</h2><h3 id="1-æ¨¡å‹æ€§èƒ½ç›‘æ§"><a href="#1-æ¨¡å‹æ€§èƒ½ç›‘æ§" class="headerlink" title="1. æ¨¡å‹æ€§èƒ½ç›‘æ§"></a>1. æ¨¡å‹æ€§èƒ½ç›‘æ§</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> prometheus_client <span class="keyword">import</span> Counter, Histogram, Gauge</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æŒ‡æ ‡</span></span><br><span class="line">prediction_counter = Counter(<span class="string">&#x27;model_predictions_total&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;Total predictions&#x27;</span>,</span><br><span class="line">                            [<span class="string">&#x27;model_version&#x27;</span>, <span class="string">&#x27;status&#x27;</span>])</span><br><span class="line"></span><br><span class="line">prediction_latency = Histogram(<span class="string">&#x27;model_prediction_latency_seconds&#x27;</span>,</span><br><span class="line">                              <span class="string">&#x27;Prediction latency&#x27;</span>)</span><br><span class="line"></span><br><span class="line">model_accuracy = Gauge(<span class="string">&#x27;model_accuracy&#x27;</span>,</span><br><span class="line">                      <span class="string">&#x27;Model accuracy&#x27;</span>,</span><br><span class="line">                      [<span class="string">&#x27;model_version&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelMonitor</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, model</span>):</span><br><span class="line">        <span class="variable language_">self</span>.model = model</span><br><span class="line">        <span class="variable language_">self</span>.version = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @prediction_latency.time()</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            start_time = time.time()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># æ¨¡å‹æ¨ç†</span></span><br><span class="line">            result = <span class="variable language_">self</span>.model(input_data)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è®°å½•æˆåŠŸé¢„æµ‹</span></span><br><span class="line">            prediction_counter.labels(</span><br><span class="line">                model_version=<span class="variable language_">self</span>.version,</span><br><span class="line">                status=<span class="string">&#x27;success&#x27;</span></span><br><span class="line">            ).inc()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment"># è®°å½•å¤±è´¥é¢„æµ‹</span></span><br><span class="line">            prediction_counter.labels(</span><br><span class="line">                model_version=<span class="variable language_">self</span>.version,</span><br><span class="line">                status=<span class="string">&#x27;error&#x27;</span></span><br><span class="line">            ).inc()</span><br><span class="line">            <span class="keyword">raise</span> e</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update_accuracy</span>(<span class="params">self, accuracy</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ›´æ–°å‡†ç¡®ç‡æŒ‡æ ‡&quot;&quot;&quot;</span></span><br><span class="line">        model_accuracy.labels(model_version=<span class="variable language_">self</span>.version).<span class="built_in">set</span>(accuracy)</span><br></pre></td></tr></table></figure>

<h3 id="2-æ—¥å¿—è®°å½•"><a href="#2-æ—¥å¿—è®°å½•" class="headerlink" title="2. æ—¥å¿—è®°å½•"></a>2. æ—¥å¿—è®°å½•</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelLogger</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, model_name</span>):</span><br><span class="line">        <span class="variable language_">self</span>.model_name = model_name</span><br><span class="line">        <span class="variable language_">self</span>.logger = <span class="variable language_">self</span>._setup_logger()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_setup_logger</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;é…ç½®æ—¥å¿—&quot;&quot;&quot;</span></span><br><span class="line">        logger = logging.getLogger(<span class="variable language_">self</span>.model_name)</span><br><span class="line">        logger.setLevel(logging.INFO)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ–‡ä»¶å¤„ç†å™¨</span></span><br><span class="line">        fh = logging.FileHandler(<span class="string">f&#x27;<span class="subst">&#123;self.model_name&#125;</span>.log&#x27;</span>)</span><br><span class="line">        fh.setLevel(logging.INFO)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ§åˆ¶å°å¤„ç†å™¨</span></span><br><span class="line">        ch = logging.StreamHandler()</span><br><span class="line">        ch.setLevel(logging.INFO)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ ¼å¼åŒ–</span></span><br><span class="line">        formatter = logging.Formatter(</span><br><span class="line">            <span class="string">&#x27;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#x27;</span></span><br><span class="line">        )</span><br><span class="line">        fh.setFormatter(formatter)</span><br><span class="line">        ch.setFormatter(formatter)</span><br><span class="line"></span><br><span class="line">        logger.addHandler(fh)</span><br><span class="line">        logger.addHandler(ch)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> logger</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">log_prediction</span>(<span class="params">self, input_data, output, latency</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®°å½•é¢„æµ‹ä¿¡æ¯&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.logger.info(&#123;</span><br><span class="line">            <span class="string">&quot;timestamp&quot;</span>: datetime.now().isoformat(),</span><br><span class="line">            <span class="string">&quot;input_shape&quot;</span>: input_data.shape,</span><br><span class="line">            <span class="string">&quot;output&quot;</span>: output.tolist() <span class="keyword">if</span> <span class="built_in">hasattr</span>(output, <span class="string">&#x27;tolist&#x27;</span>) <span class="keyword">else</span> output,</span><br><span class="line">            <span class="string">&quot;latency_ms&quot;</span>: latency * <span class="number">1000</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">log_error</span>(<span class="params">self, error</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®°å½•é”™è¯¯&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.logger.error(<span class="string">f&quot;Prediction error: <span class="subst">&#123;<span class="built_in">str</span>(error)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="A-Bæµ‹è¯•æ¡†æ¶"><a href="#A-Bæµ‹è¯•æ¡†æ¶" class="headerlink" title="A&#x2F;Bæµ‹è¯•æ¡†æ¶"></a>A&#x2F;Bæµ‹è¯•æ¡†æ¶</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABC, abstractmethod</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelABTest</span>(<span class="title class_ inherited__">ABC</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;A/Bæµ‹è¯•åŸºç±»&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelA</span>(<span class="title class_ inherited__">ModelABTest</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.model = <span class="variable language_">self</span>._load_model(<span class="string">&#x27;model_a.pth&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.model(input_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelB</span>(<span class="title class_ inherited__">ModelABTest</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.model = <span class="variable language_">self</span>._load_model(<span class="string">&#x27;model_b.pth&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, input_data</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.model(input_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ABTestRouter</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;A/Bæµ‹è¯•è·¯ç”±å™¨&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, model_a, model_b, traffic_ratio=<span class="number">0.5</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.model_a = model_a</span><br><span class="line">        <span class="variable language_">self</span>.model_b = model_b</span><br><span class="line">        <span class="variable language_">self</span>.traffic_ratio = traffic_ratio</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç»Ÿè®¡æŒ‡æ ‡</span></span><br><span class="line">        <span class="variable language_">self</span>.metrics = &#123;</span><br><span class="line">            <span class="string">&#x27;model_a&#x27;</span>: &#123;<span class="string">&#x27;count&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;errors&#x27;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">            <span class="string">&#x27;model_b&#x27;</span>: &#123;<span class="string">&#x27;count&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;errors&#x27;</span>: <span class="number">0</span>&#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">route</span>(<span class="params">self, user_id, input_data</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ ¹æ®ç”¨æˆ·IDè·¯ç”±åˆ°ä¸åŒæ¨¡å‹&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># ä½¿ç”¨ç”¨æˆ·IDè¿›è¡Œå“ˆå¸Œï¼Œç¡®ä¿åŒä¸€ç”¨æˆ·æ€»æ˜¯ä½¿ç”¨åŒä¸€æ¨¡å‹</span></span><br><span class="line">        hash_val = <span class="built_in">hash</span>(user_id) % <span class="number">100</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> hash_val &lt; <span class="variable language_">self</span>.traffic_ratio * <span class="number">100</span>:</span><br><span class="line">            model = <span class="variable language_">self</span>.model_a</span><br><span class="line">            model_name = <span class="string">&#x27;model_a&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            model = <span class="variable language_">self</span>.model_b</span><br><span class="line">            model_name = <span class="string">&#x27;model_b&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = model.predict(input_data)</span><br><span class="line">            <span class="variable language_">self</span>.metrics[model_name][<span class="string">&#x27;count&#x27;</span>] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="variable language_">self</span>.metrics[model_name][<span class="string">&#x27;errors&#x27;</span>] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">raise</span> e</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_metrics</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è·å–A/Bæµ‹è¯•æŒ‡æ ‡&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.metrics</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ„å»ºç”Ÿäº§çº§AIåº”ç”¨éœ€è¦ç»¼åˆè€ƒè™‘ï¼š</p>
<ol>
<li><strong>æ¨¡å‹é€‰æ‹©</strong> - æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„ç®—æ³•</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong> - é‡åŒ–ã€æ‰¹å¤„ç†ã€ç¼“å­˜</li>
<li><strong>å¯æ‰©å±•æ€§</strong> - Dockerã€Kuberneteséƒ¨ç½²</li>
<li><strong>ç›‘æ§è¿ç»´</strong> - æ—¥å¿—ã€æŒ‡æ ‡ã€A&#x2F;Bæµ‹è¯•</li>
<li><strong>å®‰å…¨éšç§</strong> - æ•°æ®åŠ å¯†ã€æ¨¡å‹ä¿æŠ¤</li>
</ol>
<p><strong>æœ€ä½³å®è·µï¼š</strong></p>
<ul>
<li>ä½¿ç”¨å®¹å™¨åŒ–éƒ¨ç½²</li>
<li>å®æ–½å®Œå–„çš„ç›‘æ§</li>
<li>å»ºç«‹CI&#x2F;CDæµæ°´çº¿</li>
<li>å®šæœŸé‡æ–°è®­ç»ƒæ¨¡å‹</li>
<li>åšå¥½é”™è¯¯å¤„ç†å’Œé™çº§</li>
</ul>
<p>AIçš„é­…åŠ›åœ¨äºåº”ç”¨ï¼Œå¸Œæœ›è¿™äº›å®æˆ˜æ¡ˆä¾‹èƒ½å¸®åŠ©ä½ æ„å»ºè‡ªå·±çš„AIåº”ç”¨ï¼</p>
<hr>
<p><em>ç³»åˆ—æ–‡ç« å®Œç»“ï¼Œæ„Ÿè°¢é˜…è¯»ï¼æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„AIé¡¹ç›®ç»éªŒã€‚</em></p>
]]></content>
      <categories>
        <category>å…¨æ ˆ</category>
        <category>AI</category>
      </categories>
      <tags>
        <tag>AIåº”ç”¨</tag>
        <tag>å®æˆ˜é¡¹ç›®</tag>
        <tag>APIå¼€å‘</tag>
        <tag>æ¨¡å‹éƒ¨ç½²</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–å®Œå…¨æŒ‡å—ï¼šä»ç†è®ºåˆ°å®æˆ˜</title>
    <url>/2026/01/20/frontend-performance-optimization/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰ç«¯æ€§èƒ½ç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒå’Œä¸šåŠ¡æŒ‡æ ‡ã€‚æ®ç»Ÿè®¡ï¼Œé¡µé¢åŠ è½½æ—¶é—´æ¯å¢åŠ 1ç§’ï¼Œè½¬åŒ–ç‡å¯èƒ½ä¸‹é™7%ã€‚æœ¬æ–‡å°†ä»å¤šä¸ªç»´åº¦å…¨é¢ä»‹ç»å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„ç­–ç•¥å’Œå®æˆ˜æŠ€å·§ã€‚</p>
<h2 id="æ€§èƒ½æŒ‡æ ‡"><a href="#æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡"></a>æ€§èƒ½æŒ‡æ ‡</h2><h3 id="æ ¸å¿ƒWebæŒ‡æ ‡ï¼ˆCore-Web-Vitalsï¼‰"><a href="#æ ¸å¿ƒWebæŒ‡æ ‡ï¼ˆCore-Web-Vitalsï¼‰" class="headerlink" title="æ ¸å¿ƒWebæŒ‡æ ‡ï¼ˆCore Web Vitalsï¼‰"></a>æ ¸å¿ƒWebæŒ‡æ ‡ï¼ˆCore Web Vitalsï¼‰</h3><p>Google çš„ Core Web Vitals æ˜¯è¡¡é‡ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒæŒ‡æ ‡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚           Core Web Vitals æ ¸å¿ƒæŒ‡æ ‡               â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  LCP (Largest Contentful Paint)                â”‚</span><br><span class="line">â”‚  - æœ€å¤§å†…å®¹ç»˜åˆ¶                                  â”‚</span><br><span class="line">â”‚  - ç›®æ ‡: &lt; 2.5ç§’                                â”‚</span><br><span class="line">â”‚  - æµ‹é‡: ä¸»è¦å†…å®¹åŠ è½½é€Ÿåº¦                        â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  FID (First Input Delay)                        â”‚</span><br><span class="line">â”‚  - é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ                                  â”‚</span><br><span class="line">â”‚  - ç›®æ ‡: &lt; 100æ¯«ç§’                              â”‚</span><br><span class="line">â”‚  - æµ‹é‡: é¡µé¢äº¤äº’å“åº”é€Ÿåº¦                        â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  CLS (Cumulative Layout Shift)                 â”‚</span><br><span class="line">â”‚  - ç´¯ç§¯å¸ƒå±€åç§»                                  â”‚</span><br><span class="line">â”‚  - ç›®æ ‡: &lt; 0.1                                  â”‚</span><br><span class="line">â”‚  - æµ‹é‡: è§†è§‰ç¨³å®šæ€§                              â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure>

<h3 id="å…¶ä»–é‡è¦æŒ‡æ ‡"><a href="#å…¶ä»–é‡è¦æŒ‡æ ‡" class="headerlink" title="å…¶ä»–é‡è¦æŒ‡æ ‡"></a>å…¶ä»–é‡è¦æŒ‡æ ‡</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ€§èƒ½æŒ‡æ ‡ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> metrics = &#123;</span><br><span class="line">  <span class="comment">// åŠ è½½æ€§èƒ½</span></span><br><span class="line">  <span class="attr">FCP</span>: <span class="string">&#x27;First Contentful Paint &lt; 1.8s&#x27;</span>,  <span class="comment">// é¦–æ¬¡å†…å®¹ç»˜åˆ¶</span></span><br><span class="line">  <span class="attr">TTI</span>: <span class="string">&#x27;Time to Interactive &lt; 3.8s&#x27;</span>,     <span class="comment">// å¯äº¤äº’æ—¶é—´</span></span><br><span class="line">  <span class="title class_">SpeedIndex</span>: <span class="string">&#x27;é€Ÿåº¦æŒ‡æ•° &lt; 3.4s&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿è¡Œæ—¶æ€§èƒ½</span></span><br><span class="line">  <span class="attr">TBT</span>: <span class="string">&#x27;Total Blocking Time &lt; 200ms&#x27;</span>,   <span class="comment">// æ€»é˜»å¡æ—¶é—´</span></span><br><span class="line">  <span class="title class_">LongTasks</span>: <span class="string">&#x27;é•¿ä»»åŠ¡æ•°é‡ &lt; 5ä¸ª&#x27;</span>,         <span class="comment">// &gt;50msçš„ä»»åŠ¡</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰ä¸šåŠ¡æŒ‡æ ‡</span></span><br><span class="line">  <span class="title class_">TimeToInteractive</span>: <span class="string">&#x27;å¯äº¤äº’æ—¶é—´&#x27;</span>,</span><br><span class="line">  <span class="title class_">ConversionRate</span>: <span class="string">&#x27;è½¬åŒ–ç‡&#x27;</span>,</span><br><span class="line">  <span class="title class_">BounceRate</span>: <span class="string">&#x27;è·³å‡ºç‡&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="åŠ è½½æ€§èƒ½ä¼˜åŒ–"><a href="#åŠ è½½æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="åŠ è½½æ€§èƒ½ä¼˜åŒ–"></a>åŠ è½½æ€§èƒ½ä¼˜åŒ–</h2><h3 id="1-èµ„æºå‹ç¼©ä¸ä¼˜åŒ–"><a href="#1-èµ„æºå‹ç¼©ä¸ä¼˜åŒ–" class="headerlink" title="1. èµ„æºå‹ç¼©ä¸ä¼˜åŒ–"></a>1. èµ„æºå‹ç¼©ä¸ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TerserPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;terser-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CssMinimizerPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;css-minimizer-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimize</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">TerserPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">terserOptions</span>: &#123;</span><br><span class="line">          <span class="attr">compress</span>: &#123;</span><br><span class="line">            <span class="attr">drop_console</span>: <span class="literal">true</span>,  <span class="comment">// ç§»é™¤ console</span></span><br><span class="line">            <span class="attr">pure_funcs</span>: [<span class="string">&#x27;console.log&#x27;</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">CssMinimizerPlugin</span>()</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">performance</span>: &#123;</span><br><span class="line">    <span class="attr">maxEntrypointSize</span>: <span class="number">250000</span>,  <span class="comment">// å…¥å£æ–‡ä»¶å¤§å°é™åˆ¶</span></span><br><span class="line">    <span class="attr">maxAssetSize</span>: <span class="number">250000</span>        <span class="comment">// èµ„æºæ–‡ä»¶å¤§å°é™åˆ¶</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Gzip å‹ç¼©</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CompressionPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;compression-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CompressionPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">algorithm</span>: <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.(js|css|html|svg)$/</span>,</span><br><span class="line">      <span class="attr">threshold</span>: <span class="number">10240</span>,  <span class="comment">// åªå‹ç¼© &gt;10KB çš„æ–‡ä»¶</span></span><br><span class="line">      <span class="attr">minRatio</span>: <span class="number">0.8</span>      <span class="comment">// å‹ç¼©ç‡ &gt; 20% æ‰å‹ç¼©</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Brotli å‹ç¼©ï¼ˆæ¯” Gzip æ›´é«˜æ•ˆï¼‰</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CompressionPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;[path][base].br&#x27;</span>,</span><br><span class="line">      <span class="attr">algorithm</span>: <span class="string">&#x27;brotliCompress&#x27;</span>,</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.(js|css|html|svg)$/</span>,</span><br><span class="line">      <span class="attr">compressionOptions</span>: &#123;</span><br><span class="line">        <span class="attr">level</span>: <span class="number">11</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="2-ä»£ç åˆ†å‰²ï¼ˆCode-Splittingï¼‰"><a href="#2-ä»£ç åˆ†å‰²ï¼ˆCode-Splittingï¼‰" class="headerlink" title="2. ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰"></a>2. ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼1ï¼šè·¯ç”±çº§åˆ«åˆ†å‰²</span></span><br><span class="line"><span class="keyword">import</span> &#123; lazy, <span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/Home&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">About</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/About&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Dashboard</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/Dashboard&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">LoadingSpinner</span> /&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">About</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/dashboard&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Dashboard</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼2ï¼šç»„ä»¶çº§åˆ«åˆ†å‰²</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HeavyChart</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./components/HeavyChart&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Dashboard</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [showChart, setShowChart] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setShowChart(true)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        æ˜¾ç¤ºå›¾è¡¨</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;showChart &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>åŠ è½½å›¾è¡¨...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">HeavyChart</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      )&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼3ï¼šWebpack åŠ¨æ€å¯¼å…¥</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadModule</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">import</span>(<span class="string">&#x27;./utils/heavyModule&#x27;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">module</span>.<span class="title function_">doSomething</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;æ¨¡å—åŠ è½½å¤±è´¥&#x27;</span>, error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼4ï¼šNamed exportï¼ˆå‘½åå¯¼å‡ºï¼‰</span></span><br><span class="line"><span class="keyword">const</span> &#123; utils1, utils2 &#125; = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;./utils&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="3-Tree-Shaking"><a href="#3-Tree-Shaking" class="headerlink" title="3. Tree Shaking"></a>3. Tree Shaking</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ ES6 æ¨¡å—</span></span><br><span class="line"><span class="comment">// utils.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">func1</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">func2</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">func3</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js - åªå¯¼å…¥éœ€è¦çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">import</span> &#123; func1 &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils&#x27;</span>;</span><br><span class="line"><span class="title function_">func1</span>();</span><br><span class="line"><span class="comment">// func2 å’Œ func3 ä¼šè¢« tree-shaking åˆ é™¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šä½¿ç”¨ CommonJS</span></span><br><span class="line"><span class="comment">// utils.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">func1</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="attr">func2</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="attr">func3</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js - å³ä½¿åªç”¨ func1ï¼Œæ•´ä¸ªæ¨¡å—éƒ½ä¼šè¢«æ‰“åŒ…</span></span><br><span class="line"><span class="keyword">const</span> &#123; func1 &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./utils&#x27;</span>);</span><br><span class="line"><span class="title function_">func1</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// package.json é…ç½®</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;my-package&quot;</span>,</span><br><span class="line">  <span class="string">&quot;sideEffects&quot;</span>: <span class="literal">false</span>,  <span class="comment">// å‘Šè¯‰ webpack æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ— å‰¯ä½œç”¨çš„</span></span><br><span class="line">  <span class="comment">// æˆ–è€…æ˜ç¡®æŒ‡å®šæœ‰å‰¯ä½œç”¨çš„æ–‡ä»¶</span></span><br><span class="line">  <span class="string">&quot;sideEffects&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;*.css&quot;</span>,</span><br><span class="line">    <span class="string">&quot;./src/polyfills.js&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-èµ„æºåŠ è½½ä¼˜åŒ–"><a href="#4-èµ„æºåŠ è½½ä¼˜åŒ–" class="headerlink" title="4. èµ„æºåŠ è½½ä¼˜åŒ–"></a>4. èµ„æºåŠ è½½ä¼˜åŒ–</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1. é¢„åŠ è½½å…³é”®èµ„æº --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/fonts/main.woff2&quot;</span> <span class="attr">as</span>=<span class="string">&quot;font&quot;</span> <span class="attr">type</span>=<span class="string">&quot;font/woff2&quot;</span> <span class="attr">crossorigin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/styles/main.css&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2. é¢„è¿æ¥åˆ°è·¨åŸŸèµ„æº --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preconnect&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://api.example.com&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;dns-prefetch&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.example.com&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 3. é¢„è·å–ä¸‹ä¸€é¡µèµ„æº --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;prefetch&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/next-page.js&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;prerender&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/next-page.html&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 4. å»¶è¿ŸåŠ è½½éå…³é”®CSS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/styles/critical.css&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.onload=null;this.rel=&#x27;stylesheet&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">noscript</span>&gt;</span><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/styles/critical.css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 5. å¼‚æ­¥åŠ è½½JavaScript --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/analytics.js&quot;</span> <span class="attr">async</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  <span class="comment">&lt;!-- å¼‚æ­¥åŠ è½½ï¼Œä¸ä¿è¯é¡ºåº --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/main.js&quot;</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>      <span class="comment">&lt;!-- å»¶è¿Ÿåˆ°HTMLè§£æå®ŒæˆååŠ è½½ --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 6. å“åº”å¼å›¾ç‰‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">  <span class="attr">src</span>=<span class="string">&quot;small.jpg&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">srcset</span>=<span class="string">&quot;small.jpg 500w,</span></span></span><br><span class="line"><span class="string"><span class="tag">          medium.jpg 1000w,</span></span></span><br><span class="line"><span class="string"><span class="tag">          large.jpg 1500w&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">sizes</span>=<span class="string">&quot;(max-width: 600px) 500px,</span></span></span><br><span class="line"><span class="string"><span class="tag">         (max-width: 1200px) 1000px,</span></span></span><br><span class="line"><span class="string"><span class="tag">         1500px&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">alt</span>=<span class="string">&quot;å“åº”å¼å›¾ç‰‡&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 7. ç°ä»£å›¾ç‰‡æ ¼å¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">picture</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">srcset</span>=<span class="string">&quot;image.avif&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/avif&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">srcset</span>=<span class="string">&quot;image.webp&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/webp&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;é™çº§å›¾ç‰‡&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">picture</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–"><a href="#è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–"></a>è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–</h2><h3 id="1-è™šæ‹Ÿåˆ—è¡¨å’Œè™šæ‹Ÿæ»šåŠ¨"><a href="#1-è™šæ‹Ÿåˆ—è¡¨å’Œè™šæ‹Ÿæ»šåŠ¨" class="headerlink" title="1. è™šæ‹Ÿåˆ—è¡¨å’Œè™šæ‹Ÿæ»šåŠ¨"></a>1. è™šæ‹Ÿåˆ—è¡¨å’Œè™šæ‹Ÿæ»šåŠ¨</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ react-window</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FixedSizeList</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-window&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">VirtualizedList</span>(<span class="params">&#123; items &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">Row</span> = (<span class="params">&#123; index, style &#125;</span>) =&gt; (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span> <span class="attr">className</span>=<span class="string">&quot;list-item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;items[index].name&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">FixedSizeList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">height</span>=<span class="string">&#123;600&#125;</span>           // <span class="attr">å¯è§†åŒºåŸŸé«˜åº¦</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">itemCount</span>=<span class="string">&#123;items.length&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">itemSize</span>=<span class="string">&#123;50&#125;</span>          // <span class="attr">æ¯é¡¹é«˜åº¦</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;Row&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">FixedSizeList</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨æ€é«˜åº¦çš„è™šæ‹Ÿåˆ—è¡¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">VariableSizeList</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-window&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">VariableList</span>(<span class="params">&#123; items &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getItemSize</span> = (<span class="params">index</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®å†…å®¹åŠ¨æ€è®¡ç®—é«˜åº¦</span></span><br><span class="line">    <span class="keyword">return</span> items[index].<span class="property">height</span> || <span class="number">50</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">Row</span> = (<span class="params">&#123; index, style &#125;</span>) =&gt; (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;items[index].content&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">VariableSizeList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">height</span>=<span class="string">&#123;600&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">itemCount</span>=<span class="string">&#123;items.length&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">itemSize</span>=<span class="string">&#123;getItemSize&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;Row&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">VariableSizeList</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-é˜²æŠ–å’ŒèŠ‚æµ"><a href="#2-é˜²æŠ–å’ŒèŠ‚æµ" class="headerlink" title="2. é˜²æŠ–å’ŒèŠ‚æµ"></a>2. é˜²æŠ–å’ŒèŠ‚æµ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é˜²æŠ–ï¼ˆDebounceï¼‰ï¼šå»¶è¿Ÿæ‰§è¡Œï¼Œåªåœ¨æœ€åä¸€æ¬¡è§¦å‘åæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">func, wait</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">executedFunction</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">later</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">      <span class="title function_">func</span>(...args);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">    timeout = <span class="built_in">setTimeout</span>(later, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨åœºæ™¯ï¼šæœç´¢è¾“å…¥</span></span><br><span class="line"><span class="keyword">const</span> debouncedSearch = <span class="title function_">debounce</span>(<span class="function">(<span class="params">query</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">performSearch</span>(query);</span><br><span class="line">&#125;, <span class="number">300</span>);</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> debouncedSearch(e.target.value)&#125; /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// èŠ‚æµï¼ˆThrottleï¼‰ï¼šå›ºå®šæ—¶é—´é—´éš”æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">func, limit</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> inThrottle;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">executedFunction</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!inThrottle) &#123;</span><br><span class="line">      <span class="title function_">func</span>(...args);</span><br><span class="line">      inThrottle = <span class="literal">true</span>;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> inThrottle = <span class="literal">false</span>, limit);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨åœºæ™¯ï¼šæ»šåŠ¨äº‹ä»¶</span></span><br><span class="line"><span class="keyword">const</span> throttledScroll = <span class="title function_">throttle</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">handleScroll</span>();</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, throttledScroll);</span><br><span class="line"></span><br><span class="line"><span class="comment">// requestAnimationFrame ä¼˜åŒ–</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">rafThrottle</span>(<span class="params">func</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> rafId = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">executedFunction</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (rafId === <span class="literal">null</span>) &#123;</span><br><span class="line">      rafId = <span class="title function_">requestAnimationFrame</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">func</span>(...args);</span><br><span class="line">        rafId = <span class="literal">null</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="title function_">rafThrottle</span>(handleScroll));</span><br></pre></td></tr></table></figure>

<h3 id="3-Memo-å’Œ-useCallback"><a href="#3-Memo-å’Œ-useCallback" class="headerlink" title="3. Memo å’Œ useCallback"></a>3. Memo å’Œ useCallback</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; memo, useMemo, useCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// React.memoï¼šé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ExpensiveComponent</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">ExpensiveComponent</span>(<span class="params">&#123; data &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// å¤æ‚è®¡ç®—</span></span><br><span class="line">  <span class="keyword">const</span> result = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> data.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="title function_">expensiveCalculation</span>(item));</span><br><span class="line">  &#125;, [data]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;result&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserCard</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">UserCard</span>(<span class="params">&#123; user &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;, <span class="function">(<span class="params">prevProps, nextProps</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åªæ¯”è¾ƒ ID</span></span><br><span class="line">  <span class="keyword">return</span> prevProps.<span class="property">user</span>.<span class="property">id</span> === nextProps.<span class="property">user</span>.<span class="property">id</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// useCallbackï¼šç¼“å­˜å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ParentComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// âœ… ä½¿ç”¨ useCallback</span></span><br><span class="line">  <span class="keyword">const</span> handleClick = <span class="title function_">useCallback</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(<span class="function"><span class="params">c</span> =&gt;</span> c + <span class="number">1</span>);</span><br><span class="line">  &#125;, []); <span class="comment">// ç©ºä¾èµ–ï¼Œå‡½æ•°æ°¸è¿œä¸ä¼šæ”¹å˜</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// âŒ ä¸ä½¿ç”¨ useCallbackï¼Œæ¯æ¬¡éƒ½åˆ›å»ºæ–°å‡½æ•°</span></span><br><span class="line">  <span class="comment">// const handleClick = () =&gt; setCount(count + 1);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®é™…ç¤ºä¾‹ï¼šåˆ—è¡¨ä¼˜åŒ–</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserList</span>(<span class="params">&#123; users, onSelect &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> handleSelect = <span class="title function_">useCallback</span>(<span class="function">(<span class="params">userId</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">onSelect</span>(userId);</span><br><span class="line">  &#125;, [onSelect]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;users.map(user =&gt; (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">UserItem</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">key</span>=<span class="string">&#123;user.id&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">user</span>=<span class="string">&#123;user&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onSelect</span>=<span class="string">&#123;handleSelect&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      ))&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserItem</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">UserItem</span>(<span class="params">&#123; user, onSelect &#125;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ¸²æŸ“ UserItem:&#x27;</span>, user.<span class="property">id</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onSelect(user.id)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      &#123;user.name&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="4-é•¿ä»»åŠ¡ä¼˜åŒ–"><a href="#4-é•¿ä»»åŠ¡ä¼˜åŒ–" class="headerlink" title="4. é•¿ä»»åŠ¡ä¼˜åŒ–"></a>4. é•¿ä»»åŠ¡ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ†å‰²é•¿ä»»åŠ¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">splitTask</span>(<span class="params">tasks, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">BATCH_SIZE</span> = <span class="number">50</span>;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">processBatch</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> batch = tasks.<span class="title function_">slice</span>(index, index + <span class="variable constant_">BATCH_SIZE</span>);</span><br><span class="line">    batch.<span class="title function_">forEach</span>(<span class="function"><span class="params">task</span> =&gt;</span> <span class="title function_">callback</span>(task));</span><br><span class="line">    index += <span class="variable constant_">BATCH_SIZE</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (index &lt; tasks.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="comment">// ä½¿ç”¨ setTimeout è®©å‡ºä¸»çº¿ç¨‹</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(processBatch, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">processBatch</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> largeDataSet = <span class="title class_">Array</span>(<span class="number">10000</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">map</span>(<span class="function">(<span class="params">_, i</span>) =&gt;</span> i);</span><br><span class="line"></span><br><span class="line"><span class="title function_">splitTask</span>(largeDataSet, <span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">processData</span>(item);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ requestIdleCallback</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">processTasks</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">BATCH_SIZE</span> = <span class="number">50</span>;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">processBatch</span>(<span class="params">deadline</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span> (index &lt; tasks.<span class="property">length</span> &amp;&amp; deadline.<span class="title function_">timeRemaining</span>() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="title function_">processTask</span>(tasks[index]);</span><br><span class="line">      index++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (index &lt; tasks.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="title function_">requestIdleCallback</span>(processBatch);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">requestIdleCallback</span>(processBatch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Web Worker å¤„ç†å¯†é›†è®¡ç®—</span></span><br><span class="line"><span class="comment">// worker.js</span></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="title function_">heavyComputation</span>(e.<span class="property">data</span>);</span><br><span class="line">  self.<span class="title function_">postMessage</span>(result);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">const</span> worker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;worker.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line">worker.<span class="property">onmessage</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result = e.<span class="property">data</span>;</span><br><span class="line">  <span class="title function_">updateUI</span>(result);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">worker.<span class="title function_">postMessage</span>(largeDataSet);</span><br></pre></td></tr></table></figure>

<h2 id="æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–"><a href="#æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–"></a>æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–</h2><h3 id="1-CSS-ä¼˜åŒ–"><a href="#1-CSS-ä¼˜åŒ–" class="headerlink" title="1. CSS ä¼˜åŒ–"></a>1. CSS ä¼˜åŒ–</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 1. å‡å°‘é‡æ’å’Œé‡ç»˜ */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* âŒ ä¼šè§¦å‘é‡æ’ */</span></span><br><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* âœ… ä½¿ç”¨ transform ä»£æ›¿ position */</span></span><br><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">20px</span>);</span><br><span class="line">  <span class="attribute">will-change</span>: transform;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. ä½¿ç”¨ contain å±æ€§ */</span></span><br><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">  <span class="attribute">contain</span>: layout style paint;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3. GPU åŠ é€Ÿ */</span></span><br><span class="line"><span class="selector-class">.animated-element</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="attribute">will-change</span>: transform;</span><br><span class="line">  <span class="attribute">backface-visibility</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 4. ä¼˜åŒ–åŠ¨ç”» */</span></span><br><span class="line"><span class="keyword">@keyframes</span> slideIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.slide-in</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: slideIn <span class="number">0.3s</span> ease-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 5. é¿å… CSS è¡¨è¾¾å¼ */</span></span><br><span class="line"><span class="comment">/* âŒ ç³Ÿç³•çš„æ€§èƒ½ */</span></span><br><span class="line"><span class="selector-class">.bad</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">expression</span>(document.body.clientWidth &gt; <span class="number">800</span> ? <span class="string">&#x27;800px&#x27;</span> : <span class="string">&#x27;auto&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-DOM-ä¼˜åŒ–"><a href="#2-DOM-ä¼˜åŒ–" class="headerlink" title="2. DOM ä¼˜åŒ–"></a>2. DOM ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. å‡å°‘ DOM æ“ä½œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ æ¯æ¬¡å¾ªç¯éƒ½æ“ä½œ DOM</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>).<span class="property">innerHTML</span> += <span class="string">`&lt;li&gt;Item <span class="subst">$&#123;i&#125;</span>&lt;/li&gt;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… ä½¿ç”¨ DocumentFragment</span></span><br><span class="line"><span class="keyword">const</span> fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">  li.<span class="property">textContent</span> = <span class="string">`Item <span class="subst">$&#123;i&#125;</span>`</span>;</span><br><span class="line">  fragment.<span class="title function_">appendChild</span>(li);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>).<span class="title function_">appendChild</span>(fragment);</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… ä¸€æ¬¡æ€§æ›´æ–° DOM</span></span><br><span class="line"><span class="keyword">const</span> listItems = <span class="title class_">Array</span>(<span class="number">1000</span>).<span class="title function_">fill</span>(<span class="number">0</span>)</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function">(<span class="params">_, i</span>) =&gt;</span> <span class="string">`&lt;li&gt;Item <span class="subst">$&#123;i&#125;</span>&lt;/li&gt;`</span>)</span><br><span class="line">  .<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>).<span class="property">innerHTML</span> = listItems;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ‰¹é‡ DOM æ›´æ–°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateElement</span>(<span class="params">el, styles</span>) &#123;</span><br><span class="line">  <span class="comment">// âŒ å¤šæ¬¡é‡æ’</span></span><br><span class="line">  <span class="comment">// el.style.width = &#x27;100px&#x27;;</span></span><br><span class="line">  <span class="comment">// el.style.height = &#x27;100px&#x27;;</span></span><br><span class="line">  <span class="comment">// el.style.margin = &#x27;10px&#x27;;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// âœ… ä¸€æ¬¡æ€§ä¿®æ”¹ï¼Œåªè§¦å‘ä¸€æ¬¡é‡æ’</span></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">assign</span>(el.<span class="property">style</span>, &#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="string">&#x27;100px&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="string">&#x27;100px&#x27;</span>,</span><br><span class="line">    <span class="attr">margin</span>: <span class="string">&#x27;10px&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. ä½¿ç”¨è™šæ‹Ÿ DOMï¼ˆReact è‡ªåŠ¨ä¼˜åŒ–ï¼‰</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">List</span>(<span class="params">&#123; items &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;items.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span>&#123;item.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      ))&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-å›¾ç‰‡æ‡’åŠ è½½"><a href="#3-å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="3. å›¾ç‰‡æ‡’åŠ è½½"></a>3. å›¾ç‰‡æ‡’åŠ è½½</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ Intersection Observer API</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LazyImage</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">img</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">img</span> = img;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">src</span> = img.<span class="property">dataset</span>.<span class="property">src</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">observer</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">observer</span> = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(<span class="function">(<span class="params">entries</span>) =&gt;</span> &#123;</span><br><span class="line">      entries.<span class="title function_">forEach</span>(<span class="function"><span class="params">entry</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (entry.<span class="property">isIntersecting</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">load</span>();</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">observer</span>.<span class="title function_">unobserve</span>(<span class="variable language_">this</span>.<span class="property">img</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="attr">rootMargin</span>: <span class="string">&#x27;50px&#x27;</span>  <span class="comment">// æå‰50pxåŠ è½½</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">observer</span>.<span class="title function_">observe</span>(<span class="variable language_">this</span>.<span class="property">img</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">load</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">img</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">src</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">img</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;loaded&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;img[data-src]&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">LazyImage</span>(img);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// React Hook ç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useLazyImage</span>(<span class="params">src</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [imageSrc, setImageSrc] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> imgRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(</span><br><span class="line">      <span class="function">(<span class="params">[entry]</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (entry.<span class="property">isIntersecting</span>) &#123;</span><br><span class="line">          <span class="title function_">setImageSrc</span>(src);</span><br><span class="line">          observer.<span class="title function_">disconnect</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">rootMargin</span>: <span class="string">&#x27;100px&#x27;</span> &#125;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (imgRef.<span class="property">current</span>) &#123;</span><br><span class="line">      observer.<span class="title function_">observe</span>(imgRef.<span class="property">current</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> observer.<span class="title function_">disconnect</span>();</span><br><span class="line">  &#125;, [src]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [imgRef, imageSrc];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LazyImage</span>(<span class="params">&#123; src, alt &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [imgRef, imageSrc] = <span class="title function_">useLazyImage</span>(src);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">img</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">ref</span>=<span class="string">&#123;imgRef&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">src</span>=<span class="string">&#123;imageSrc</span> || &#x27;<span class="attr">placeholder.jpg</span>&#x27;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">alt</span>=<span class="string">&#123;alt&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">loading</span>=<span class="string">&quot;lazy&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    /&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç½‘ç»œä¼˜åŒ–"><a href="#ç½‘ç»œä¼˜åŒ–" class="headerlink" title="ç½‘ç»œä¼˜åŒ–"></a>ç½‘ç»œä¼˜åŒ–</h2><h3 id="1-HTTP-ç¼“å­˜"><a href="#1-HTTP-ç¼“å­˜" class="headerlink" title="1. HTTP ç¼“å­˜"></a>1. HTTP ç¼“å­˜</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Express.js è®¾ç½®ç¼“å­˜</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™æ€èµ„æºç¼“å­˜</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">maxAge</span>: <span class="string">&#x27;1y&#x27;</span>,           <span class="comment">// 1å¹´</span></span><br><span class="line">  <span class="attr">etag</span>: <span class="literal">true</span>,             <span class="comment">// å¯ç”¨ ETag</span></span><br><span class="line">  <span class="attr">lastModified</span>: <span class="literal">true</span>,     <span class="comment">// å¯ç”¨ Last-Modified</span></span><br><span class="line">  <span class="attr">setHeaders</span>: <span class="function">(<span class="params">res, path</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// HTML æ–‡ä»¶ä¸ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">if</span> (path.<span class="title function_">endsWith</span>(<span class="string">&#x27;.html&#x27;</span>)) &#123;</span><br><span class="line">      res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Cache-Control&#x27;</span>, <span class="string">&#x27;no-cache&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// API å“åº”ç¼“å­˜</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/data&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">set</span>(<span class="string">&#x27;Cache-Control&#x27;</span>, <span class="string">&#x27;public, max-age=300&#x27;</span>); <span class="comment">// 5åˆ†é’Ÿ</span></span><br><span class="line">  res.<span class="title function_">json</span>(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Service Worker ç¼“å­˜</span></span><br><span class="line"><span class="comment">// sw.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CACHE_NAME</span> = <span class="string">&#x27;v1&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> urlsToCache = [</span><br><span class="line">  <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;/styles/main.css&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;/scripts/main.js&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&#x27;install&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  event.<span class="title function_">waitUntil</span>(</span><br><span class="line">    caches.<span class="title function_">open</span>(<span class="variable constant_">CACHE_NAME</span>)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">cache</span>) =&gt;</span> cache.<span class="title function_">addAll</span>(urlsToCache))</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&#x27;fetch&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  event.<span class="title function_">respondWith</span>(</span><br><span class="line">    caches.<span class="title function_">match</span>(event.<span class="property">request</span>)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ç¼“å­˜å‘½ä¸­åˆ™è¿”å›ç¼“å­˜ï¼Œå¦åˆ™å‘èµ·ç½‘ç»œè¯·æ±‚</span></span><br><span class="line">        <span class="keyword">return</span> response || <span class="title function_">fetch</span>(event.<span class="property">request</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-CDN-åŠ é€Ÿ"><a href="#2-CDN-åŠ é€Ÿ" class="headerlink" title="2. CDN åŠ é€Ÿ"></a>2. CDN åŠ é€Ÿ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ CDN åŠ è½½ç¬¬ä¸‰æ–¹åº“</span></span><br><span class="line"><span class="comment">// âŒ ä»è‡ªå·±çš„æœåŠ¡å™¨åŠ è½½</span></span><br><span class="line">&lt;script src=<span class="string">&quot;/js/react.production.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… ä» CDN åŠ è½½</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½® webpack externals</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">externals</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;react&#x27;</span>: <span class="string">&#x27;React&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;react-dom&#x27;</span>: <span class="string">&#x27;ReactDOM&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šä¸ª CDN æºï¼ˆå®¹é”™ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> cdnUrls = [</span><br><span class="line">  <span class="string">&#x27;https://cdn.jsdelivr.net/npm/package@version/file.js&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/package/version/file.js&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;https://unpkg.com/package@version/file.js&#x27;</span></span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h3 id="3-API-ä¼˜åŒ–"><a href="#3-API-ä¼˜åŒ–" class="headerlink" title="3. API ä¼˜åŒ–"></a>3. API ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. è¯·æ±‚åˆå¹¶</span></span><br><span class="line"><span class="comment">// âŒ å¤šæ¬¡è¯·æ±‚</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/user&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> posts = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/posts&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> comments = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/comments&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… åˆå¹¶ä¸ºä¸€æ¬¡è¯·æ±‚</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/data?include=user,posts,comments&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. ä½¿ç”¨ GraphQL</span></span><br><span class="line"><span class="keyword">const</span> query = <span class="string">`</span></span><br><span class="line"><span class="string">  query &#123;</span></span><br><span class="line"><span class="string">    user &#123;</span></span><br><span class="line"><span class="string">      name</span></span><br><span class="line"><span class="string">      email</span></span><br><span class="line"><span class="string">      posts &#123;</span></span><br><span class="line"><span class="string">        title</span></span><br><span class="line"><span class="string">        comments &#123;</span></span><br><span class="line"><span class="string">          content</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/graphql&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">  <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; query &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. å“åº”å‹ç¼©</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> compression = <span class="built_in">require</span>(<span class="string">&#x27;compression&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">compression</span>());  <span class="comment">// å¯ç”¨ gzip å‹ç¼©</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. HTTP/2 æ¨é€</span></span><br><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="keyword">const</span> http2 = <span class="built_in">require</span>(<span class="string">&#x27;http2&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http2.<span class="title function_">createSecureServer</span>(&#123;</span><br><span class="line">  <span class="attr">key</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;private-key.pem&#x27;</span>),</span><br><span class="line">  <span class="attr">cert</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;certificate.pem&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;stream&#x27;</span>, <span class="function">(<span class="params">stream, headers</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ¨é€å…³é”®èµ„æº</span></span><br><span class="line">  <span class="keyword">if</span> (headers[<span class="string">&#x27;:path&#x27;</span>] === <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">    stream.<span class="title function_">pushStream</span>(&#123; <span class="string">&#x27;:path&#x27;</span>: <span class="string">&#x27;/styles/main.css&#x27;</span> &#125;, <span class="function">(<span class="params">pushStream</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// å‘é€ CSS æ–‡ä»¶</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="ç›‘æ§å’Œåˆ†æ"><a href="#ç›‘æ§å’Œåˆ†æ" class="headerlink" title="ç›‘æ§å’Œåˆ†æ"></a>ç›‘æ§å’Œåˆ†æ</h2><h3 id="1-æ€§èƒ½ç›‘æ§"><a href="#1-æ€§èƒ½ç›‘æ§" class="headerlink" title="1. æ€§èƒ½ç›‘æ§"></a>1. æ€§èƒ½ç›‘æ§</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ Performance API</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">measurePerformance</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// é¡µé¢åŠ è½½æ€§èƒ½</span></span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> perfData = performance.<span class="property">timing</span>;</span><br><span class="line">    <span class="keyword">const</span> pageLoadTime = perfData.<span class="property">loadEventEnd</span> - perfData.<span class="property">navigationStart</span>;</span><br><span class="line">    <span class="keyword">const</span> domReadyTime = perfData.<span class="property">domContentLoadedEventEnd</span> - perfData.<span class="property">navigationStart</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;é¡µé¢åŠ è½½æ—¶é—´:&#x27;</span>, pageLoadTime);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;DOM å°±ç»ªæ—¶é—´:&#x27;</span>, domReadyTime);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Core Web Vitals</span></span><br><span class="line">  <span class="keyword">import</span> &#123; getCLS, getFID, getFCP, getLCP, getTTFB &#125; <span class="keyword">from</span> <span class="string">&#x27;web-vitals&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getCLS</span>(<span class="variable language_">console</span>.<span class="property">log</span>);</span><br><span class="line">  <span class="title function_">getFID</span>(<span class="variable language_">console</span>.<span class="property">log</span>);</span><br><span class="line">  <span class="title function_">getFCP</span>(<span class="variable language_">console</span>.<span class="property">log</span>);</span><br><span class="line">  <span class="title function_">getLCP</span>(<span class="variable language_">console</span>.<span class="property">log</span>);</span><br><span class="line">  <span class="title function_">getTTFB</span>(<span class="variable language_">console</span>.<span class="property">log</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰æŒ‡æ ‡</span></span><br><span class="line">  performance.<span class="title function_">mark</span>(<span class="string">&#x27;feature-start&#x27;</span>);</span><br><span class="line">  <span class="comment">// ... åŠŸèƒ½ä»£ç </span></span><br><span class="line">  performance.<span class="title function_">mark</span>(<span class="string">&#x27;feature-end&#x27;</span>);</span><br><span class="line">  performance.<span class="title function_">measure</span>(<span class="string">&#x27;feature&#x27;</span>, <span class="string">&#x27;feature-start&#x27;</span>, <span class="string">&#x27;feature-end&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> measure = performance.<span class="title function_">getEntriesByName</span>(<span class="string">&#x27;feature&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åŠŸèƒ½æ‰§è¡Œæ—¶é—´:&#x27;</span>, measure.<span class="property">duration</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é€åˆ°åˆ†æå¹³å°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">trackPerformance</span>(<span class="params">metrics</span>) &#123;</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/api/analytics&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(metrics),</span><br><span class="line">    <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-Lighthouse-åˆ†æ"><a href="#2-Lighthouse-åˆ†æ" class="headerlink" title="2. Lighthouse åˆ†æ"></a>2. Lighthouse åˆ†æ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤è¡Œä½¿ç”¨ Lighthouse</span></span><br><span class="line">npx lighthouse https://example.com --output html --output-path report.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># CI/CD é›†æˆ</span></span><br><span class="line">npm install --save-dev lighthouse</span><br><span class="line"></span><br><span class="line"><span class="comment"># package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;lighthouse&quot;</span>: <span class="string">&quot;lighthouse https://example.com --output json --output-path ./lighthouse.json&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-æ€§èƒ½é¢„ç®—"><a href="#3-æ€§èƒ½é¢„ç®—" class="headerlink" title="3. æ€§èƒ½é¢„ç®—"></a>3. æ€§èƒ½é¢„ç®—</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack æ€§èƒ½é¢„ç®—</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">performance</span>: &#123;</span><br><span class="line">    <span class="attr">hints</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">    <span class="attr">maxEntrypointSize</span>: <span class="number">512000</span>,  <span class="comment">// å…¥å£æ–‡ä»¶ &lt; 500KB</span></span><br><span class="line">    <span class="attr">maxAssetSize</span>: <span class="number">512000</span>       <span class="comment">// èµ„æºæ–‡ä»¶ &lt; 500KB</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">BundleAnalyzerPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">analyzerMode</span>: <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">      <span class="attr">openAnalyzer</span>: <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ speed-measure-webpack-plugin</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SpeedMeasurePlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;speed-measure-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> smp = <span class="keyword">new</span> <span class="title class_">SpeedMeasurePlugin</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = smp.<span class="title function_">wrap</span>(&#123;</span><br><span class="line">  <span class="comment">// webpack é…ç½®</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="æ€§èƒ½ä¼˜åŒ–æ¸…å•"><a href="#æ€§èƒ½ä¼˜åŒ–æ¸…å•" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–æ¸…å•"></a>æ€§èƒ½ä¼˜åŒ–æ¸…å•</h2><h3 id="åŠ è½½æ€§èƒ½"><a href="#åŠ è½½æ€§èƒ½" class="headerlink" title="åŠ è½½æ€§èƒ½"></a>åŠ è½½æ€§èƒ½</h3><ul>
<li>âœ… å¯ç”¨ Gzip&#x2F;Brotli å‹ç¼©</li>
<li>âœ… ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½</li>
<li>âœ… Tree Shaking</li>
<li>âœ… å›¾ç‰‡ä¼˜åŒ–ï¼ˆWebPã€å“åº”å¼å›¾ç‰‡ï¼‰</li>
<li>âœ… é¢„åŠ è½½å…³é”®èµ„æº</li>
<li>âœ… CDN åŠ é€Ÿ</li>
<li>âœ… HTTP ç¼“å­˜</li>
</ul>
<h3 id="è¿è¡Œæ—¶æ€§èƒ½"><a href="#è¿è¡Œæ—¶æ€§èƒ½" class="headerlink" title="è¿è¡Œæ—¶æ€§èƒ½"></a>è¿è¡Œæ—¶æ€§èƒ½</h3><ul>
<li>âœ… è™šæ‹Ÿåˆ—è¡¨</li>
<li>âœ… é˜²æŠ–å’ŒèŠ‚æµ</li>
<li>âœ… React.memo å’Œ useCallback</li>
<li>âœ… é¿å…é•¿ä»»åŠ¡</li>
<li>âœ… ä½¿ç”¨ Web Worker</li>
</ul>
<h3 id="æ¸²æŸ“æ€§èƒ½"><a href="#æ¸²æŸ“æ€§èƒ½" class="headerlink" title="æ¸²æŸ“æ€§èƒ½"></a>æ¸²æŸ“æ€§èƒ½</h3><ul>
<li>âœ… GPU åŠ é€ŸåŠ¨ç”»</li>
<li>âœ… å‡å°‘ DOM æ“ä½œ</li>
<li>âœ… å›¾ç‰‡æ‡’åŠ è½½</li>
<li>âœ… ä¼˜åŒ– CSS é€‰æ‹©å™¨</li>
</ul>
<h3 id="ç›‘æ§"><a href="#ç›‘æ§" class="headerlink" title="ç›‘æ§"></a>ç›‘æ§</h3><ul>
<li>âœ… Core Web Vitals</li>
<li>âœ… æ€§èƒ½ç›‘æ§</li>
<li>âœ… Lighthouse å®šæœŸæ£€æŸ¥</li>
<li>âœ… æ€§èƒ½é¢„ç®—</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œéœ€è¦ä»å¤šä¸ªç»´åº¦ç»¼åˆè€ƒè™‘ï¼š</p>
<p><strong>å…³é”®è¦ç‚¹</strong>ï¼š</p>
<ol>
<li>ğŸ¯ å…ˆæµ‹é‡å†ä¼˜åŒ– - ä½¿ç”¨æ€§èƒ½å·¥å…·æ‰¾åˆ°ç“¶é¢ˆ</li>
<li>ğŸ“¦ ä¼˜åŒ–åŠ è½½ - ä»£ç åˆ†å‰²ã€èµ„æºå‹ç¼©ã€CDN</li>
<li>âš¡ æå‡è¿è¡Œæ—¶ - è™šæ‹ŸåŒ–ã€é˜²æŠ–èŠ‚æµã€é¿å…é‡æ’</li>
<li>ğŸ“Š æŒç»­ç›‘æ§ - å»ºç«‹æ€§èƒ½é¢„ç®—å’Œç›‘æ§ä½“ç³»</li>
</ol>
<p><strong>ä¼˜å…ˆçº§</strong>ï¼š</p>
<ol>
<li><strong>é«˜ä¼˜å…ˆçº§</strong>ï¼šLCP &gt; 2.5s, FID &gt; 100ms, CLS &gt; 0.1</li>
<li><strong>ä¸­ä¼˜å…ˆçº§</strong>ï¼šFCPã€TTIã€TBT</li>
<li><strong>ä½ä¼˜å…ˆçº§</strong>ï¼šè‡ªå®šä¹‰ä¸šåŠ¡æŒ‡æ ‡</li>
</ol>
<p>è®°ä½ï¼š<strong>æ€§èƒ½ä¼˜åŒ–æ²¡æœ‰é“¶å¼¹ï¼Œè¦æ ¹æ®å®é™…åœºæ™¯é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥ï¼</strong></p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†ä»‹ç»å‰ç«¯å·¥ç¨‹åŒ–å’Œæ„å»ºä¼˜åŒ–ï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>æ€§èƒ½ä¼˜åŒ–</tag>
        <tag>å‰ç«¯å¼€å‘</tag>
        <tag>Webæ€§èƒ½</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>æ™ºé€ æœªæ¥ï¼šAI+ä½ä»£ç é‡æ„å…¨æ ˆå¼€å‘èŒƒå¼</title>
    <url>/2026/01/22/ai-lowcode-future/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>â€œThe best way to predict the future is to invent it.â€ - Alan Kay</p>
</blockquote>
<p>åœ¨æŠ€æœ¯å˜é©çš„æµªæ½®ä¸­ï¼Œæˆ‘ä»¬æ­£ç«™åœ¨ä¸€ä¸ªå…³é”®çš„åå­—è·¯å£ï¼šAI çš„è¿…çŒ›å‘å±•ä¸ä½ä»£ç &#x2F;æ— ä»£ç å¹³å°çš„å¿«é€Ÿæ™®åŠï¼Œæ­£åœ¨æ·±åˆ»é‡å¡‘è½¯ä»¶å¼€å‘çš„æœªæ¥ã€‚å¯¹äºå…¨æ ˆå·¥ç¨‹å¸ˆè€Œè¨€ï¼Œè¿™æ—¢æ˜¯æŒ‘æˆ˜ï¼Œæ›´æ˜¯å‰æ‰€æœªæœ‰çš„æœºé‡ã€‚</p>
<h2 id="ä¸€ã€ä½ä»£ç -æ— ä»£ç ï¼šé™ä½å¼€å‘é—¨æ§›çš„é©å‘½"><a href="#ä¸€ã€ä½ä»£ç -æ— ä»£ç ï¼šé™ä½å¼€å‘é—¨æ§›çš„é©å‘½" class="headerlink" title="ä¸€ã€ä½ä»£ç &#x2F;æ— ä»£ç ï¼šé™ä½å¼€å‘é—¨æ§›çš„é©å‘½"></a>ä¸€ã€ä½ä»£ç &#x2F;æ— ä»£ç ï¼šé™ä½å¼€å‘é—¨æ§›çš„é©å‘½</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯ä½ä»£ç -æ— ä»£ç ï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯ä½ä»£ç -æ— ä»£ç ï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯ä½ä»£ç &#x2F;æ— ä»£ç ï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯ä½ä»£ç &#x2F;æ— ä»£ç ï¼Ÿ</h3><p>**ä½ä»£ç ï¼ˆLow-Codeï¼‰<strong>å’Œ</strong>æ— ä»£ç ï¼ˆNo-Codeï¼‰**æ˜¯è¿‘å¹´æ¥å…´èµ·çš„åº”ç”¨å¼€å‘å¹³å°ï¼Œå®ƒä»¬é€šè¿‡å¯è§†åŒ–ç•Œé¢ã€æ‹–æ‹½ç»„ä»¶å’Œé¢„ç½®æ¨¡æ¿ï¼Œå¤§å¹…é™ä½åº”ç”¨å¼€å‘çš„é—¨æ§›ã€‚</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>ä½ä»£ç </th>
<th>æ— ä»£ç </th>
</tr>
</thead>
<tbody><tr>
<td>ç›®æ ‡ç”¨æˆ·</td>
<td>ä¸“ä¸šå¼€å‘è€…</td>
<td>ä¸šåŠ¡äººå‘˜ã€éæŠ€æœ¯äººå‘˜</td>
</tr>
<tr>
<td>ç¼–ç¨‹éœ€æ±‚</td>
<td>éœ€è¦ä¸€å®šç¼–ç¨‹åŸºç¡€</td>
<td>å®Œå…¨æ— éœ€ç¼–ç¨‹</td>
</tr>
<tr>
<td>çµæ´»æ€§</td>
<td>è¾ƒé«˜ï¼Œå¯æ‰©å±•</td>
<td>å—é™äºå¹³å°èƒ½åŠ›</td>
</tr>
<tr>
<td>å…¸å‹åœºæ™¯</td>
<td>ä¼ä¸šåº”ç”¨ã€å¤æ‚ç³»ç»Ÿ</td>
<td>ç®€å•å·¥å…·ã€å†…éƒ¨æµç¨‹</td>
</tr>
</tbody></table>
<h3 id="1-2-å¸‚åœºç°çŠ¶ä¸è¶‹åŠ¿"><a href="#1-2-å¸‚åœºç°çŠ¶ä¸è¶‹åŠ¿" class="headerlink" title="1.2 å¸‚åœºç°çŠ¶ä¸è¶‹åŠ¿"></a>1.2 å¸‚åœºç°çŠ¶ä¸è¶‹åŠ¿</h3><p>æ ¹æ® Gartner çš„é¢„æµ‹ï¼š</p>
<ul>
<li>åˆ° 2025 å¹´ï¼Œ<strong>70%</strong> çš„æ–°åº”ç”¨å°†ç”±ä½ä»£ç &#x2F;æ— ä»£ç å¹³å°æ„å»º</li>
<li>å…¨çƒä½ä»£ç å¸‚åœºè§„æ¨¡å°†ä»¥ <strong>28.1%</strong> çš„å¹´å¤åˆå¢é•¿ç‡å¢é•¿</li>
<li>ä¼ä¸šå¯¹ä½ä»£ç å¹³å°çš„éœ€æ±‚æ¿€å¢ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°å­—åŒ–è½¬å‹åŠ é€Ÿçš„èƒŒæ™¯ä¸‹</li>
</ul>
<p><strong>ä¸»æµä½ä»£ç å¹³å°ï¼š</strong></p>
<ul>
<li><strong>OutSystems</strong>ï¼šä¼ä¸šçº§ä½ä»£ç é¢†å¯¼è€…</li>
<li><strong>Mendix</strong>ï¼šè¥¿é—¨å­æ——ä¸‹ï¼Œä¸“æ³¨å·¥ä¸šåº”ç”¨</li>
<li><strong>Retool</strong>ï¼šå†…éƒ¨å·¥å…·å¼€å‘ç¥å™¨</li>
<li><strong>Appsmith</strong>ï¼šå¼€æºä½ä»£ç å¹³å°</li>
<li><strong>Bubble</strong>ï¼šæ— ä»£ç Webåº”ç”¨æ„å»º</li>
</ul>
<h2 id="äºŒã€AI-èµ‹èƒ½ï¼šè®©ä½ä»£ç æ›´æ™ºèƒ½"><a href="#äºŒã€AI-èµ‹èƒ½ï¼šè®©ä½ä»£ç æ›´æ™ºèƒ½" class="headerlink" title="äºŒã€AI èµ‹èƒ½ï¼šè®©ä½ä»£ç æ›´æ™ºèƒ½"></a>äºŒã€AI èµ‹èƒ½ï¼šè®©ä½ä»£ç æ›´æ™ºèƒ½</h2><h3 id="2-1-AI-ä½ä»£ç çš„å®Œç¾èåˆ"><a href="#2-1-AI-ä½ä»£ç çš„å®Œç¾èåˆ" class="headerlink" title="2.1 AI + ä½ä»£ç çš„å®Œç¾èåˆ"></a>2.1 AI + ä½ä»£ç çš„å®Œç¾èåˆ</h3><p>AI æŠ€æœ¯çš„å¼•å…¥ï¼Œè®©ä½ä»£ç å¹³å°å¦‚è™æ·»ç¿¼ï¼š</p>
<h4 id="ğŸ¤–-æ™ºèƒ½ä»£ç ç”Ÿæˆ"><a href="#ğŸ¤–-æ™ºèƒ½ä»£ç ç”Ÿæˆ" class="headerlink" title="ğŸ¤– æ™ºèƒ½ä»£ç ç”Ÿæˆ"></a>ğŸ¤– æ™ºèƒ½ä»£ç ç”Ÿæˆ</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¼ ç»Ÿæ–¹å¼ï¼šæ‰‹å†™ä»£ç </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">validateEmail</span>(<span class="params">email</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> re = <span class="regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;</span><br><span class="line">  <span class="keyword">return</span> re.<span class="title function_">test</span>(email);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AIè¾…åŠ©ï¼šè‡ªç„¶è¯­è¨€æè¿°</span></span><br><span class="line"><span class="comment">// &quot;åˆ›å»ºä¸€ä¸ªé‚®ç®±éªŒè¯å‡½æ•°&quot;</span></span><br><span class="line"><span class="comment">// AIè‡ªåŠ¨ç”Ÿæˆä»£ç ï¼Œæ”¯æŒå¤šç§è¯­è¨€</span></span><br></pre></td></tr></table></figure>

<h4 id="ğŸ¨-æ™ºèƒ½UIè®¾è®¡"><a href="#ğŸ¨-æ™ºèƒ½UIè®¾è®¡" class="headerlink" title="ğŸ¨ æ™ºèƒ½UIè®¾è®¡"></a>ğŸ¨ æ™ºèƒ½UIè®¾è®¡</h4><p>AI å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªåŠ¨ç”Ÿæˆ UI ç»„ä»¶ï¼š</p>
<ul>
<li>åˆ†æå“ç‰Œè‰²ç³»ï¼Œè‡ªåŠ¨ç”Ÿæˆè®¾è®¡ç³»ç»Ÿ</li>
<li>æ ¹æ®ç”¨æˆ·ç”»åƒï¼Œæ¨èæœ€ä½³å¸ƒå±€</li>
<li>æ™ºèƒ½é€‚é…ä¸åŒè®¾å¤‡å’Œå±å¹•å°ºå¯¸</li>
</ul>
<h4 id="ğŸ“Š-æ™ºèƒ½æ•°æ®åˆ†æ"><a href="#ğŸ“Š-æ™ºèƒ½æ•°æ®åˆ†æ" class="headerlink" title="ğŸ“Š æ™ºèƒ½æ•°æ®åˆ†æ"></a>ğŸ“Š æ™ºèƒ½æ•°æ®åˆ†æ</h4><ul>
<li>è‡ªåŠ¨è¯†åˆ«æ•°æ®æ¨¡å¼ï¼Œç”Ÿæˆå¯è§†åŒ–å›¾è¡¨</li>
<li>é¢„æµ‹æ€§åˆ†æï¼Œå¸®åŠ©å†³ç­–</li>
<li>å¼‚å¸¸æ£€æµ‹ï¼Œè‡ªåŠ¨å‘Šè­¦</li>
</ul>
<h3 id="2-2-å®é™…åº”ç”¨æ¡ˆä¾‹"><a href="#2-2-å®é™…åº”ç”¨æ¡ˆä¾‹" class="headerlink" title="2.2 å®é™…åº”ç”¨æ¡ˆä¾‹"></a>2.2 å®é™…åº”ç”¨æ¡ˆä¾‹</h3><p><strong>æ¡ˆä¾‹ 1ï¼šç”µå•†ç®¡ç†ç³»ç»Ÿ</strong></p>
<blockquote>
<p>æŸç”µå•†å¹³å°ä½¿ç”¨ AI + ä½ä»£ç ï¼Œåœ¨ 2 å‘¨å†…æ„å»ºäº†å®Œæ•´çš„è®¢å•ç®¡ç†ç³»ç»Ÿï¼š</p>
<ul>
<li>AI è‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“æ¨¡å‹</li>
<li>æ™ºèƒ½è¡¨å•éªŒè¯è§„åˆ™</li>
<li>è‡ªåŠ¨åŒ–å·¥ä½œæµç¼–æ’</li>
<li>èŠ‚çœå¼€å‘æ—¶é—´ 60%</li>
</ul>
</blockquote>
<p><strong>æ¡ˆä¾‹ 2ï¼šå†…éƒ¨æ•°æ®çœ‹æ¿</strong></p>
<blockquote>
<p>ä¼ä¸šä½¿ç”¨ Retool + AI Copilotï¼š</p>
<ul>
<li>è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚</li>
<li>AI è‡ªåŠ¨ç”ŸæˆæŸ¥è¯¢è¯­å¥</li>
<li>æ™ºèƒ½æ¨èå›¾è¡¨ç±»å‹</li>
<li>å¼€å‘æ•ˆç‡æå‡ 5 å€</li>
</ul>
</blockquote>
<h2 id="ä¸‰ã€å…¨æ ˆå·¥ç¨‹å¸ˆçš„æ–°æœºé‡"><a href="#ä¸‰ã€å…¨æ ˆå·¥ç¨‹å¸ˆçš„æ–°æœºé‡" class="headerlink" title="ä¸‰ã€å…¨æ ˆå·¥ç¨‹å¸ˆçš„æ–°æœºé‡"></a>ä¸‰ã€å…¨æ ˆå·¥ç¨‹å¸ˆçš„æ–°æœºé‡</h2><h3 id="3-1-è§’è‰²è½¬å˜ï¼šä»ç¼–ç è€…åˆ°æ¶æ„å¸ˆ"><a href="#3-1-è§’è‰²è½¬å˜ï¼šä»ç¼–ç è€…åˆ°æ¶æ„å¸ˆ" class="headerlink" title="3.1 è§’è‰²è½¬å˜ï¼šä»ç¼–ç è€…åˆ°æ¶æ„å¸ˆ"></a>3.1 è§’è‰²è½¬å˜ï¼šä»ç¼–ç è€…åˆ°æ¶æ„å¸ˆ</h3><p>ä¼ ç»Ÿå…¨æ ˆå·¥ç¨‹å¸ˆ â†’ AI æ—¶ä»£çš„å…¨æ ˆå·¥ç¨‹å¸ˆ</p>
<table>
<thead>
<tr>
<th>èƒ½åŠ›ç»´åº¦</th>
<th>ä¼ ç»Ÿå…¨æ ˆ</th>
<th>AIæ—¶ä»£å…¨æ ˆ</th>
</tr>
</thead>
<tbody><tr>
<td>æ ¸å¿ƒæŠ€èƒ½</td>
<td>ç¼–ç èƒ½åŠ›</td>
<td>æ¶æ„è®¾è®¡</td>
</tr>
<tr>
<td>å·¥å…·ä½¿ç”¨</td>
<td>æ‰‹å†™ä»£ç </td>
<td>AI è¾…åŠ©å¼€å‘</td>
</tr>
<tr>
<td>ä»·å€¼åˆ›é€ </td>
<td>å®ç°åŠŸèƒ½</td>
<td>è§£å†³é—®é¢˜</td>
</tr>
<tr>
<td>å­¦ä¹ é‡ç‚¹</td>
<td>æ¡†æ¶API</td>
<td>ä¸šåŠ¡ç†è§£</td>
</tr>
</tbody></table>
<h3 id="3-2-æ–°çš„æ ¸å¿ƒç«äº‰åŠ›"><a href="#3-2-æ–°çš„æ ¸å¿ƒç«äº‰åŠ›" class="headerlink" title="3.2 æ–°çš„æ ¸å¿ƒç«äº‰åŠ›"></a>3.2 æ–°çš„æ ¸å¿ƒç«äº‰åŠ›</h3><h4 id="1ï¸âƒ£-æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt-Engineeringï¼‰"><a href="#1ï¸âƒ£-æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt-Engineeringï¼‰" class="headerlink" title="1ï¸âƒ£ æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰"></a>1ï¸âƒ£ <strong>æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰</strong></h4><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section"># ä¼˜ç§€çš„æç¤ºè¯ç¤ºä¾‹</span></span><br><span class="line"></span><br><span class="line">&quot;ä½œä¸ºä¸€ä¸ªèµ„æ·±çš„å…¨æ ˆå·¥ç¨‹å¸ˆï¼Œ</span><br><span class="line">å¸®æˆ‘åˆ›å»ºä¸€ä¸ªç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼š</span><br><span class="line"><span class="bullet">-</span> ä½¿ç”¨ JWT è¿›è¡Œèº«ä»½éªŒè¯</span><br><span class="line"><span class="bullet">-</span> åŒ…å«æ³¨å†Œã€ç™»å½•ã€å¯†ç é‡ç½®åŠŸèƒ½</span><br><span class="line"><span class="bullet">-</span> å‰ç«¯ä½¿ç”¨ React + TypeScript</span><br><span class="line"><span class="bullet">-</span> åç«¯ä½¿ç”¨ Node.js + Express</span><br><span class="line"><span class="bullet">-</span> æ•°æ®åº“ä½¿ç”¨ MongoDB</span><br><span class="line"><span class="bullet">-</span> éœ€è¦è€ƒè™‘å®‰å…¨æ€§æœ€ä½³å®è·µ&quot;</span><br></pre></td></tr></table></figure>

<h4 id="2ï¸âƒ£-AI-å·¥å…·é“¾æŒæ¡"><a href="#2ï¸âƒ£-AI-å·¥å…·é“¾æŒæ¡" class="headerlink" title="2ï¸âƒ£ AI å·¥å…·é“¾æŒæ¡"></a>2ï¸âƒ£ <strong>AI å·¥å…·é“¾æŒæ¡</strong></h4><ul>
<li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šGitHub Copilot, CodeLlama, StarCoder</li>
<li><strong>ä»£ç å®¡æŸ¥</strong>ï¼šCodeT5, CodeBERT</li>
<li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•</strong>ï¼šTestGen, AI æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ</li>
<li><strong>æ–‡æ¡£ç”Ÿæˆ</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ã€æŠ€æœ¯æ–‡æ¡£</li>
</ul>
<h4 id="3ï¸âƒ£-ä½ä»£ç å¹³å°æ¶æ„èƒ½åŠ›"><a href="#3ï¸âƒ£-ä½ä»£ç å¹³å°æ¶æ„èƒ½åŠ›" class="headerlink" title="3ï¸âƒ£ ä½ä»£ç å¹³å°æ¶æ„èƒ½åŠ›"></a>3ï¸âƒ£ <strong>ä½ä»£ç å¹³å°æ¶æ„èƒ½åŠ›</strong></h4><p>ç†è§£ä½ä»£ç å¹³å°çš„åº•å±‚åŸç†ï¼š</p>
<ul>
<li>å…ƒæ•°æ®é©±åŠ¨æ¶æ„</li>
<li>ç»„ä»¶åŒ–è®¾è®¡æ€æƒ³</li>
<li>å¯è§†åŒ–ç¼–è¾‘å™¨å®ç°</li>
<li>æ’ä»¶ç³»ç»Ÿè®¾è®¡</li>
</ul>
<h3 id="3-3-èŒä¸šå‘å±•æ–°è·¯å¾„"><a href="#3-3-èŒä¸šå‘å±•æ–°è·¯å¾„" class="headerlink" title="3.3 èŒä¸šå‘å±•æ–°è·¯å¾„"></a>3.3 èŒä¸šå‘å±•æ–°è·¯å¾„</h3><h4 id="ğŸš€-æŠ€æœ¯è·¯çº¿"><a href="#ğŸš€-æŠ€æœ¯è·¯çº¿" class="headerlink" title="ğŸš€ æŠ€æœ¯è·¯çº¿"></a>ğŸš€ æŠ€æœ¯è·¯çº¿</h4><ol>
<li><p><strong>å…¨æ ˆ AI å·¥ç¨‹å¸ˆ</strong></p>
<ul>
<li>æŒæ¡ AI å¼€å‘æ¡†æ¶</li>
<li>æ„å»º AI èµ‹èƒ½çš„åº”ç”¨</li>
<li>è–ªèµ„æº¢ä»· 30-50%</li>
</ul>
</li>
<li><p><strong>ä½ä»£ç å¹³å°å¼€å‘è€…</strong></p>
<ul>
<li>å‚ä¸å¹³å°å¼€å‘</li>
<li>æ„å»ºæ’ä»¶ç”Ÿæ€</li>
<li>æŠ€æœ¯é—¨æ§›é€‚ä¸­ï¼Œéœ€æ±‚æ—ºç››</li>
</ul>
</li>
<li><p><strong>è§£å†³æ–¹æ¡ˆæ¶æ„å¸ˆ</strong></p>
<ul>
<li>æ•´åˆ AI + ä½ä»£ç </li>
<li>ä¸ºä¼ä¸šæä¾›æ•°å­—åŒ–è½¬å‹æ–¹æ¡ˆ</li>
<li>é«˜ç«¯å’¨è¯¢è·¯çº¿</li>
</ul>
</li>
</ol>
<h4 id="ğŸ’¼-åˆ›ä¸šæœºä¼š"><a href="#ğŸ’¼-åˆ›ä¸šæœºä¼š" class="headerlink" title="ğŸ’¼ åˆ›ä¸šæœºä¼š"></a>ğŸ’¼ åˆ›ä¸šæœºä¼š</h4><ul>
<li><strong>å‚ç›´é¢†åŸŸä½ä»£ç å¹³å°</strong>ï¼šä¸“æ³¨ç‰¹å®šè¡Œä¸š</li>
<li><strong>AI è¾…åŠ©å¼€å‘å·¥å…·</strong>ï¼šæå‡å¼€å‘æ•ˆç‡</li>
<li><strong>ä¼ä¸šæ•°å­—åŒ–è½¬å‹å’¨è¯¢</strong>ï¼šå¸®åŠ©ä¼ ç»Ÿä¼ä¸šè½¬å‹</li>
</ul>
<h2 id="å››ã€å®æˆ˜å»ºè®®ï¼šå¦‚ä½•æŠŠæ¡æœºé‡"><a href="#å››ã€å®æˆ˜å»ºè®®ï¼šå¦‚ä½•æŠŠæ¡æœºé‡" class="headerlink" title="å››ã€å®æˆ˜å»ºè®®ï¼šå¦‚ä½•æŠŠæ¡æœºé‡"></a>å››ã€å®æˆ˜å»ºè®®ï¼šå¦‚ä½•æŠŠæ¡æœºé‡</h2><h3 id="4-1-æŠ€èƒ½æå‡æ¸…å•"><a href="#4-1-æŠ€èƒ½æå‡æ¸…å•" class="headerlink" title="4.1 æŠ€èƒ½æå‡æ¸…å•"></a>4.1 æŠ€èƒ½æå‡æ¸…å•</h3><h4 id="å¿…å­¦æŠ€èƒ½-âœ…"><a href="#å¿…å­¦æŠ€èƒ½-âœ…" class="headerlink" title="å¿…å­¦æŠ€èƒ½ âœ…"></a>å¿…å­¦æŠ€èƒ½ âœ…</h4><ul>
<li><p><input disabled="" type="checkbox"> 
<strong>AI å¼€å‘åŸºç¡€</strong></p>
<ul>
<li>LangChain &#x2F; LlamaIndex</li>
<li>OpenAI API &#x2F; Claude API</li>
<li>Prompt Engineering æœ€ä½³å®è·µ</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox"> 
<strong>ä½ä»£ç å¹³å°å®è·µ</strong></p>
<ul>
<li>è‡³å°‘æŒæ¡ 2-3 ä¸ªä¸»æµå¹³å°</li>
<li>ç†è§£å¹³å°æ¶æ„åŸç†</li>
<li>èƒ½å¤Ÿæ‰©å±•å’Œå®šåˆ¶</li>
</ul>
</li>
<li><p><input disabled="" type="checkbox"> 
<strong>ä¼ ç»Ÿå…¨æ ˆæŠ€èƒ½</strong></p>
<ul>
<li>React &#x2F; Vue &#x2F; Angular</li>
<li>Node.js &#x2F; Python &#x2F; Go</li>
<li>æ•°æ®åº“è®¾è®¡ä¸ä¼˜åŒ–</li>
</ul>
</li>
</ul>
<h4 id="åŠ åˆ†æŠ€èƒ½-ğŸŒŸ"><a href="#åŠ åˆ†æŠ€èƒ½-ğŸŒŸ" class="headerlink" title="åŠ åˆ†æŠ€èƒ½ ğŸŒŸ"></a>åŠ åˆ†æŠ€èƒ½ ğŸŒŸ</h4><ul>
<li><input disabled="" type="checkbox"> <strong>DevOps &amp; CI&#x2F;CD</strong></li>
<li><input disabled="" type="checkbox"> <strong>äº‘æœåŠ¡ï¼ˆAWS&#x2F;Azure&#x2F;GCPï¼‰</strong></li>
<li><input disabled="" type="checkbox"> <strong>å¾®æœåŠ¡æ¶æ„</strong></li>
<li><input disabled="" type="checkbox"> <strong>å®¹å™¨åŒ–ï¼ˆDocker&#x2F;K8sï¼‰</strong></li>
</ul>
<h3 id="4-2-å­¦ä¹ è·¯å¾„æ¨è"><a href="#4-2-å­¦ä¹ è·¯å¾„æ¨è" class="headerlink" title="4.2 å­¦ä¹ è·¯å¾„æ¨è"></a>4.2 å­¦ä¹ è·¯å¾„æ¨è</h3><h4 id="ç¬¬ä¸€æ­¥ï¼šå®è·µ-AI-è¾…åŠ©å¼€å‘ï¼ˆ1-2ä¸ªæœˆï¼‰"><a href="#ç¬¬ä¸€æ­¥ï¼šå®è·µ-AI-è¾…åŠ©å¼€å‘ï¼ˆ1-2ä¸ªæœˆï¼‰" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå®è·µ AI è¾…åŠ©å¼€å‘ï¼ˆ1-2ä¸ªæœˆï¼‰"></a>ç¬¬ä¸€æ­¥ï¼šå®è·µ AI è¾…åŠ©å¼€å‘ï¼ˆ1-2ä¸ªæœˆï¼‰</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨ AI å·¥å…·</span></span><br><span class="line">1. å®‰è£… GitHub Copilot</span><br><span class="line">2. å­¦ä¹ æç¤ºè¯æŠ€å·§</span><br><span class="line">3. å‚ä¸ AI å¼€æºé¡¹ç›®</span><br><span class="line">4. æ„å»º AI åŸå‹åº”ç”¨</span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬äºŒæ­¥ï¼šæŒæ¡ä½ä»£ç å¹³å°ï¼ˆ2-3ä¸ªæœˆï¼‰"><a href="#ç¬¬äºŒæ­¥ï¼šæŒæ¡ä½ä»£ç å¹³å°ï¼ˆ2-3ä¸ªæœˆï¼‰" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šæŒæ¡ä½ä»£ç å¹³å°ï¼ˆ2-3ä¸ªæœˆï¼‰"></a>ç¬¬äºŒæ­¥ï¼šæŒæ¡ä½ä»£ç å¹³å°ï¼ˆ2-3ä¸ªæœˆï¼‰</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ·±å…¥å­¦ä¹  1-2 ä¸ªå¹³å°</span></span><br><span class="line">1. é€‰æ‹©ä¸€ä¸ªä¸»æµå¹³å°ï¼ˆå¦‚ Retoolï¼‰</span><br><span class="line">2. å®Œæˆå®˜æ–¹æ•™ç¨‹</span><br><span class="line">3. æ„å»ºå®é™…é¡¹ç›®</span><br><span class="line">4. ç ”ç©¶å¹³å°æ‰©å±•æœºåˆ¶</span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬ä¸‰æ­¥ï¼šèåˆåˆ›æ–°ï¼ˆæŒç»­ï¼‰"><a href="#ç¬¬ä¸‰æ­¥ï¼šèåˆåˆ›æ–°ï¼ˆæŒç»­ï¼‰" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šèåˆåˆ›æ–°ï¼ˆæŒç»­ï¼‰"></a>ç¬¬ä¸‰æ­¥ï¼šèåˆåˆ›æ–°ï¼ˆæŒç»­ï¼‰</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç»“åˆ AI + ä½ä»£ç </span></span><br><span class="line">1. ä½¿ç”¨ AI ç”Ÿæˆä½ä»£ç ç»„ä»¶</span><br><span class="line">2. æ„å»ºè‡ªåŠ¨åŒ–å·¥ä½œæµ</span><br><span class="line">3. å¼€å‘ AI åŸç”Ÿåº”ç”¨</span><br><span class="line">4. åˆ†äº«ç»éªŒï¼Œå»ºç«‹å½±å“åŠ›</span><br></pre></td></tr></table></figure>

<h3 id="4-3-é¡¹ç›®å®æˆ˜å»ºè®®"><a href="#4-3-é¡¹ç›®å®æˆ˜å»ºè®®" class="headerlink" title="4.3 é¡¹ç›®å®æˆ˜å»ºè®®"></a>4.3 é¡¹ç›®å®æˆ˜å»ºè®®</h3><h4 id="ğŸ¯-æ–°æ‰‹é¡¹ç›®"><a href="#ğŸ¯-æ–°æ‰‹é¡¹ç›®" class="headerlink" title="ğŸ¯ æ–°æ‰‹é¡¹ç›®"></a>ğŸ¯ æ–°æ‰‹é¡¹ç›®</h4><p><strong>æ™ºèƒ½è¡¨å•ç”Ÿæˆå™¨</strong></p>
<ul>
<li>ä½¿ç”¨ AI ç”Ÿæˆè¡¨å•å­—æ®µ</li>
<li>è‡ªåŠ¨éªŒè¯è§„åˆ™</li>
<li>ä¸€é”®éƒ¨ç½²åˆ°ä½ä»£ç å¹³å°</li>
</ul>
<h4 id="ğŸš€-è¿›é˜¶é¡¹ç›®"><a href="#ğŸš€-è¿›é˜¶é¡¹ç›®" class="headerlink" title="ğŸš€ è¿›é˜¶é¡¹ç›®"></a>ğŸš€ è¿›é˜¶é¡¹ç›®</h4><p><strong>AI é©±åŠ¨çš„ CRM ç³»ç»Ÿ</strong></p>
<ul>
<li>ä½ä»£ç å¹³å°æ„å»ºåŸºç¡€åŠŸèƒ½</li>
<li>AI å®ç°æ™ºèƒ½å®¢æˆ·åˆ†ç±»</li>
<li>è‡ªåŠ¨åŒ–é”€å”®æµç¨‹</li>
<li>é¢„æµ‹æ€§å®¢æˆ·åˆ†æ</li>
</ul>
<h4 id="ğŸ’¡-é«˜çº§é¡¹ç›®"><a href="#ğŸ’¡-é«˜çº§é¡¹ç›®" class="headerlink" title="ğŸ’¡ é«˜çº§é¡¹ç›®"></a>ğŸ’¡ é«˜çº§é¡¹ç›®</h4><p><strong>ä¼ä¸šçº§ä½ä»£ç å¹³å°</strong></p>
<ul>
<li>å…ƒæ•°æ®é©±åŠ¨çš„æ¶æ„</li>
<li>AI è¾…åŠ©çš„ç»„ä»¶ç”Ÿæˆ</li>
<li>å¯è§†åŒ–ç¼–è¾‘å™¨</li>
<li>æ’ä»¶å¸‚åœºç”Ÿæ€</li>
</ul>
<h2 id="äº”ã€æœªæ¥å±•æœ›"><a href="#äº”ã€æœªæ¥å±•æœ›" class="headerlink" title="äº”ã€æœªæ¥å±•æœ›"></a>äº”ã€æœªæ¥å±•æœ›</h2><h3 id="5-1-æŠ€æœ¯è¶‹åŠ¿"><a href="#5-1-æŠ€æœ¯è¶‹åŠ¿" class="headerlink" title="5.1 æŠ€æœ¯è¶‹åŠ¿"></a>5.1 æŠ€æœ¯è¶‹åŠ¿</h3><ul>
<li><strong>AI Native åº”ç”¨</strong>ï¼šä» AI è¾…åŠ©åˆ° AI åŸç”Ÿ</li>
<li><strong>å¤šæ¨¡æ€äº¤äº’</strong>ï¼šè¯­éŸ³ã€å›¾åƒã€ä»£ç æ··åˆè¾“å…¥</li>
<li><strong>å®æ—¶åä½œ</strong>ï¼šå¤šäººååŒå¼€å‘</li>
<li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•ä¸éƒ¨ç½²</strong>ï¼šCI&#x2F;CD å…¨æµç¨‹ AI åŒ–</li>
</ul>
<h3 id="5-2-æŒ‘æˆ˜ä¸åº”å¯¹"><a href="#5-2-æŒ‘æˆ˜ä¸åº”å¯¹" class="headerlink" title="5.2 æŒ‘æˆ˜ä¸åº”å¯¹"></a>5.2 æŒ‘æˆ˜ä¸åº”å¯¹</h3><h4 id="âš ï¸-æ½œåœ¨æŒ‘æˆ˜"><a href="#âš ï¸-æ½œåœ¨æŒ‘æˆ˜" class="headerlink" title="âš ï¸ æ½œåœ¨æŒ‘æˆ˜"></a>âš ï¸ æ½œåœ¨æŒ‘æˆ˜</h4><ul>
<li><strong>æŠ€æœ¯æ›´æ–°å¿«</strong>ï¼šéœ€è¦æŒç»­å­¦ä¹ </li>
<li><strong>ç«äº‰åŠ å‰§</strong>ï¼šå…¥è¡Œé—¨æ§›é™ä½</li>
<li><strong>å®‰å…¨é£é™©</strong>ï¼šAI ç”Ÿæˆä»£ç çš„å®‰å…¨æ€§</li>
</ul>
<h4 id="âœ…-åº”å¯¹ç­–ç•¥"><a href="#âœ…-åº”å¯¹ç­–ç•¥" class="headerlink" title="âœ… åº”å¯¹ç­–ç•¥"></a>âœ… åº”å¯¹ç­–ç•¥</h4><ul>
<li><strong>å»ºç«‹æŒç»­å­¦ä¹ æœºåˆ¶</strong></li>
<li><strong>æ·±è€•å‚ç›´é¢†åŸŸ</strong></li>
<li><strong>åŸ¹å…»ä¸å¯æ›¿ä»£çš„è½¯æŠ€èƒ½</strong><ul>
<li>äº§å“æ€ç»´</li>
<li>ä¸šåŠ¡ç†è§£</li>
<li>å›¢é˜Ÿåä½œ</li>
<li>åˆ›æ–°èƒ½åŠ›</li>
</ul>
</li>
</ul>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>AI + ä½ä»£ç ä¸æ˜¯å¨èƒï¼Œè€Œæ˜¯èµ‹èƒ½ã€‚å®ƒè®©æˆ‘ä»¬ä»é‡å¤çš„ç¼–ç å·¥ä½œä¸­è§£æ”¾å‡ºæ¥ï¼Œä¸“æ³¨äºæ›´æœ‰ä»·å€¼çš„åˆ›é€ æ€§å·¥ä½œã€‚</p>
<p><strong>æœªæ¥çš„å…¨æ ˆå·¥ç¨‹å¸ˆï¼Œå°†æ˜¯ï¼š</strong></p>
<ul>
<li>ğŸ¯ <strong>é—®é¢˜è§£å†³è€…</strong>ï¼šè€Œéä»…ä»…æ˜¯ä»£ç ç¼–å†™è€…</li>
<li>ğŸ—ï¸ <strong>æ¶æ„è®¾è®¡è€…</strong>ï¼šèƒ½å¤Ÿæ„å»ºå¤æ‚çš„ç³»ç»Ÿ</li>
<li>ğŸ¤– <strong>AI é©¯æœè€…</strong>ï¼šå–„äºé©¾é©­ AI å·¥å…·</li>
<li>ğŸŒ± <strong>æŒç»­å­¦ä¹ è€…</strong>ï¼šæ‹¥æŠ±å˜åŒ–ï¼Œç»ˆèº«æˆé•¿</li>
</ul>
<blockquote>
<p>â€œThe future belongs to those who believe in the beauty of their dreams.â€ - Eleanor Roosevelt</p>
</blockquote>
<p>è®©æˆ‘ä»¬æ‹¥æŠ±å˜é©ï¼Œåœ¨ AI + ä½ä»£ç çš„æ—¶ä»£ï¼Œä¹¦å†™å…¨æ ˆå¼€å‘çš„æ–°ç¯‡ç« ï¼</p>
<hr>
<h2 id="å‚è€ƒèµ„æº"><a href="#å‚è€ƒèµ„æº" class="headerlink" title="å‚è€ƒèµ„æº"></a>å‚è€ƒèµ„æº</h2><ul>
<li><a href="https://www.gartner.com/reviews/market/low-code-application-platforms">ä½ä»£ç å¹³å°å¯¹æ¯”</a></li>
<li><a href="https://docs.github.com/en/copilot">GitHub Copilot æ–‡æ¡£</a></li>
<li><a href="https://python.langchain.com/">LangChain å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://docs.retool.com/">Retool å¼€å‘æŒ‡å—</a></li>
</ul>
<hr>
<p><strong>æ¨èé˜…è¯»ï¼š</strong></p>
<ul>
<li><a href="/tags/AI/">ã€ŠAI æ—¶ä»£çš„è½¯ä»¶å¼€å‘ã€‹</a></li>
<li><a href="/categories/%E5%85%A8%E6%A0%88/">ã€Šå…¨æ ˆå·¥ç¨‹å¸ˆæˆé•¿ä¹‹è·¯ã€‹</a></li>
<li><a href="/tags/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">ã€Šä½ä»£ç å¹³å°å®æˆ˜ã€‹</a></li>
</ul>
<p><strong>è®¨è®ºä¸äº¤æµï¼š</strong><br>æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«æ‚¨çš„çœ‹æ³•ï¼æ‚¨è®¤ä¸º AI + ä½ä»£ç ä¼šå¦‚ä½•æ”¹å˜å…¨æ ˆå¼€å‘ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ¢è®¨æœªæ¥ï¼ğŸ’¬</p>
]]></content>
      <categories>
        <category>å…¨æ ˆ</category>
        <category>AI</category>
      </categories>
      <tags>
        <tag>AI</tag>
        <tag>ä½ä»£ç </tag>
        <tag>æ— ä»£ç </tag>
        <tag>å…¨æ ˆå¼€å‘</tag>
        <tag>æŠ€æœ¯è¶‹åŠ¿</tag>
        <tag>æœªæ¥å±•æœ›</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯å·¥ç¨‹åŒ–å®æˆ˜ï¼šWebpackä¸Viteé…ç½®å®Œå…¨æŒ‡å—</title>
    <url>/2026/01/21/frontend-engineering-webpack-vite/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰ç«¯å·¥ç¨‹åŒ–æ˜¯ç°ä»£Webå¼€å‘çš„åŸºçŸ³ã€‚Webpackå’ŒViteæ˜¯ç›®å‰æœ€æµè¡Œçš„æ„å»ºå·¥å…·ï¼Œç†è§£å®ƒä»¬çš„å·¥ä½œåŸç†å’Œé…ç½®æŠ€å·§ï¼Œå¯¹æå‡å¼€å‘æ•ˆç‡å’Œé¡¹ç›®æ€§èƒ½è‡³å…³é‡è¦ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥è®²è§£Webpackå’ŒViteçš„é…ç½®ä¸ä¼˜åŒ–ã€‚</p>
<h2 id="ä¸€ã€Webpack-åŸºç¡€é…ç½®"><a href="#ä¸€ã€Webpack-åŸºç¡€é…ç½®" class="headerlink" title="ä¸€ã€Webpack åŸºç¡€é…ç½®"></a>ä¸€ã€Webpack åŸºç¡€é…ç½®</h2><h3 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Webpack å·¥ä½œæµç¨‹:</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   Entry     â”‚ å…¥å£æ–‡ä»¶</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚</span><br><span class="line">       â–¼</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   Loader    â”‚ è½¬æ¢é JS æ–‡ä»¶</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚</span><br><span class="line">       â–¼</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   Plugin    â”‚ æ‰©å±•åŠŸèƒ½</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">       â”‚</span><br><span class="line">       â–¼</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   Output    â”‚ è¾“å‡ºæ–‡ä»¶</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure>

<h3 id="åŸºç¡€é…ç½®"><a href="#åŸºç¡€é…ç½®" class="headerlink" title="åŸºç¡€é…ç½®"></a>åŸºç¡€é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// å…¥å£</span></span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¾“å‡º</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name].[contenthash:8].js&#x27;</span>,</span><br><span class="line">    <span class="attr">chunkFilename</span>: <span class="string">&#x27;[name].[contenthash:8].chunk.js&#x27;</span>,</span><br><span class="line">    <span class="attr">publicPath</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¨¡å¼</span></span><br><span class="line">  <span class="attr">mode</span>: process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;production&#x27;</span> : <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¨¡å—</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      <span class="comment">// JS/JSX</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(js|jsx|ts|tsx)$/</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">cacheDirectory</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">cacheCompression</span>: <span class="literal">false</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// CSS</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;postcss-loader&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// SCSS/SASS</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(scss|sass)$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;postcss-loader&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;sass-loader&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// å›¾ç‰‡</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg|webp)$/</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;asset&#x27;</span>,</span><br><span class="line">        <span class="attr">parser</span>: &#123;</span><br><span class="line">          <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">            <span class="attr">maxSize</span>: <span class="number">10</span> * <span class="number">1024</span> <span class="comment">// 10KB</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">generator</span>: &#123;</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">&#x27;images/[name].[hash:8][ext]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// å­—ä½“</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(woff2?|eot|ttf|otf)$/</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;asset/resource&#x27;</span>,</span><br><span class="line">        <span class="attr">generator</span>: &#123;</span><br><span class="line">          <span class="attr">filename</span>: <span class="string">&#x27;fonts/[name].[hash:8][ext]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ’ä»¶</span></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>(),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">template</span>: <span class="string">&#x27;./public/index.html&#x27;</span>,</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">      <span class="attr">minify</span>: &#123;</span><br><span class="line">        <span class="attr">removeComments</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">removeAttributeQuotes</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è§£æ</span></span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">extensions</span>: [<span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.jsx&#x27;</span>, <span class="string">&#x27;.ts&#x27;</span>, <span class="string">&#x27;.tsx&#x27;</span>, <span class="string">&#x27;.json&#x27;</span>],</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">      <span class="string">&#x27;@components&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src/components&#x27;</span>),</span><br><span class="line">      <span class="string">&#x27;@utils&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src/utils&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¼€å‘æœåŠ¡å™¨</span></span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">static</span>: &#123;</span><br><span class="line">      <span class="attr">directory</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">compress</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">3000</span>,</span><br><span class="line">    <span class="attr">hot</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">historyApiFallback</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://localhost:8080&#x27;</span>,</span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">pathRewrite</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Babel-é…ç½®"><a href="#Babel-é…ç½®" class="headerlink" title="Babel é…ç½®"></a>Babel é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// babel.config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">presets</span>: [</span><br><span class="line">    [<span class="string">&#x27;@babel/preset-env&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">modules</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">useBuiltIns</span>: <span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">      <span class="attr">corejs</span>: <span class="number">3</span>,</span><br><span class="line">      <span class="attr">targets</span>: &#123;</span><br><span class="line">        <span class="attr">browsers</span>: [<span class="string">&#x27;&gt; 1%&#x27;</span>, <span class="string">&#x27;last 2 versions&#x27;</span>, <span class="string">&#x27;not ie &lt;= 8&#x27;</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;],</span><br><span class="line">    [<span class="string">&#x27;@babel/preset-react&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">runtime</span>: <span class="string">&#x27;automatic&#x27;</span> <span class="comment">// React 17+ ä¸éœ€è¦å¯¼å…¥ React</span></span><br><span class="line">    &#125;],</span><br><span class="line">    <span class="string">&#x27;@babel/preset-typescript&#x27;</span></span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="string">&#x27;@babel/plugin-transform-runtime&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@babel/plugin-proposal-class-properties&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@babel/plugin-proposal-optional-chaining&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;@babel/plugin-proposal-nullish-coalescing-operator&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .browserslistrc</span></span><br><span class="line">&gt; <span class="number">1</span>%</span><br><span class="line">last <span class="number">2</span> versions</span><br><span class="line">not dead</span><br><span class="line">not ie <span class="number">11</span></span><br></pre></td></tr></table></figure>

<h3 id="PostCSS-é…ç½®"><a href="#PostCSS-é…ç½®" class="headerlink" title="PostCSS é…ç½®"></a>PostCSS é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// postcss.config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="string">&#x27;autoprefixer&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cssnano&#x27;</span>(&#123;</span><br><span class="line">      <span class="attr">preset</span>: <span class="string">&#x27;default&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;browserslist&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;&gt; 1%&quot;</span>,</span><br><span class="line">    <span class="string">&quot;last 2 versions&quot;</span>,</span><br><span class="line">    <span class="string">&quot;not dead&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€Webpack-é«˜çº§é…ç½®"><a href="#äºŒã€Webpack-é«˜çº§é…ç½®" class="headerlink" title="äºŒã€Webpack é«˜çº§é…ç½®"></a>äºŒã€Webpack é«˜çº§é…ç½®</h2><h3 id="å¤šå…¥å£é…ç½®"><a href="#å¤šå…¥å£é…ç½®" class="headerlink" title="å¤šå…¥å£é…ç½®"></a>å¤šå…¥å£é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: &#123;</span><br><span class="line">    <span class="attr">main</span>: <span class="string">&#x27;./src/main.js&#x27;</span>,</span><br><span class="line">    <span class="attr">vendor</span>: [<span class="string">&#x27;./src/react.js&#x27;</span>, <span class="string">&#x27;./src/react-dom.js&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name].[contenthash:8].js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">splitChunks</span>: &#123;</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">      <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">        <span class="attr">vendors</span>: &#123;</span><br><span class="line">          <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">          <span class="attr">priority</span>: -<span class="number">10</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;vendors&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">default</span>: &#123;</span><br><span class="line">          <span class="attr">minChunks</span>: <span class="number">2</span>,</span><br><span class="line">          <span class="attr">priority</span>: -<span class="number">20</span>,</span><br><span class="line">          <span class="attr">reuseExistingChunk</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">runtimeChunk</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;runtime&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ç¯å¢ƒå˜é‡é…ç½®"><a href="#ç¯å¢ƒå˜é‡é…ç½®" class="headerlink" title="ç¯å¢ƒå˜é‡é…ç½®"></a>ç¯å¢ƒå˜é‡é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.dev.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">merge</span>(baseConfig, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  <span class="attr">devtool</span>: <span class="string">&#x27;cheap-module-source-map&#x27;</span>,</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">devMiddleware</span>: &#123;</span><br><span class="line">      <span class="attr">stats</span>: <span class="string">&#x27;errors-warnings&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.prod.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">merge</span>(baseConfig, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">  <span class="attr">devtool</span>: <span class="string">&#x27;source-map&#x27;</span>,</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimize</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">TerserPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">terserOptions</span>: &#123;</span><br><span class="line">          <span class="attr">compress</span>: &#123;</span><br><span class="line">            <span class="attr">drop_console</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">drop_debugger</span>: <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">env</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (env.<span class="property">production</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">&#x27;./webpack.prod.js&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">&#x27;./webpack.dev.js&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;webpack --env production&quot;</span>,</span><br><span class="line">    <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;webpack serve --env development&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ€§èƒ½ä¼˜åŒ–é…ç½®"><a href="#æ€§èƒ½ä¼˜åŒ–é…ç½®" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–é…ç½®"></a>æ€§èƒ½ä¼˜åŒ–é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">TerserPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;terser-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CssMinimizerPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;css-minimizer-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CompressionPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;compression-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimize</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">TerserPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">parallel</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">terserOptions</span>: &#123;</span><br><span class="line">          <span class="attr">compress</span>: &#123;</span><br><span class="line">            <span class="attr">drop_console</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">drop_debugger</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">pure_funcs</span>: [<span class="string">&#x27;console.log&#x27;</span>]</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">output</span>: &#123;</span><br><span class="line">            <span class="attr">comments</span>: <span class="literal">false</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">extractComments</span>: <span class="literal">false</span></span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">CssMinimizerPlugin</span>()</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">splitChunks</span>: &#123;</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">      <span class="attr">minSize</span>: <span class="number">20000</span>,</span><br><span class="line">      <span class="attr">maxSize</span>: <span class="number">244000</span>,</span><br><span class="line">      <span class="attr">minChunks</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">maxAsyncRequests</span>: <span class="number">30</span>,</span><br><span class="line">      <span class="attr">maxInitialRequests</span>: <span class="number">30</span>,</span><br><span class="line">      <span class="attr">automaticNameDelimiter</span>: <span class="string">&#x27;~&#x27;</span>,</span><br><span class="line">      <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">        <span class="attr">react</span>: &#123;</span><br><span class="line">          <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/](react|react-dom)[\\/]/</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;react&#x27;</span>,</span><br><span class="line">          <span class="attr">priority</span>: <span class="number">20</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">vue</span>: &#123;</span><br><span class="line">          <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/](vue|@vue|vuex|vue-router)[\\/]/</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;vue&#x27;</span>,</span><br><span class="line">          <span class="attr">priority</span>: <span class="number">20</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">libs</span>: &#123;</span><br><span class="line">          <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;libs&#x27;</span>,</span><br><span class="line">          <span class="attr">priority</span>: <span class="number">10</span>,</span><br><span class="line">          <span class="attr">minChunks</span>: <span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">moduleIds</span>: <span class="string">&#x27;deterministic&#x27;</span>,</span><br><span class="line">    <span class="attr">runtimeChunk</span>: <span class="string">&#x27;single&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// Gzip å‹ç¼©</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CompressionPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;[path][base].gz&#x27;</span>,</span><br><span class="line">      <span class="attr">algorithm</span>: <span class="string">&#x27;gzip&#x27;</span>,</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.(js|css|html|svg)$/</span>,</span><br><span class="line">      <span class="attr">threshold</span>: <span class="number">10240</span>,</span><br><span class="line">      <span class="attr">minRatio</span>: <span class="number">0.8</span></span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Brotli å‹ç¼©</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CompressionPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;[path][base].br&#x27;</span>,</span><br><span class="line">      <span class="attr">algorithm</span>: <span class="string">&#x27;brotliCompress&#x27;</span>,</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.(js|css|html|svg)$/</span>,</span><br><span class="line">      <span class="attr">compressionOptions</span>: &#123;</span><br><span class="line">        <span class="attr">level</span>: <span class="number">11</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ€§èƒ½æç¤º</span></span><br><span class="line">  <span class="attr">performance</span>: &#123;</span><br><span class="line">    <span class="attr">hints</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">    <span class="attr">maxEntrypointSize</span>: <span class="number">512000</span>,</span><br><span class="line">    <span class="attr">maxAssetSize</span>: <span class="number">512000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ç¼“å­˜ç­–ç•¥"><a href="#ç¼“å­˜ç­–ç•¥" class="headerlink" title="ç¼“å­˜ç­–ç•¥"></a>ç¼“å­˜ç­–ç•¥</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">cache</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;filesystem&#x27;</span>,</span><br><span class="line">    <span class="attr">buildDependencies</span>: &#123;</span><br><span class="line">      <span class="attr">config</span>: [__filename]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;[name].[contenthash:8].js&#x27;</span>,</span><br><span class="line">    <span class="attr">chunkFilename</span>: <span class="string">&#x27;[name].[contenthash:8].chunk.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">template</span>: <span class="string">&#x27;./public/index.html&#x27;</span>,</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;index.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€Vite-å®Œå…¨æŒ‡å—"><a href="#ä¸‰ã€Vite-å®Œå…¨æŒ‡å—" class="headerlink" title="ä¸‰ã€Vite å®Œå…¨æŒ‡å—"></a>ä¸‰ã€Vite å®Œå…¨æŒ‡å—</h2><h3 id="Vite-vs-Webpack"><a href="#Vite-vs-Webpack" class="headerlink" title="Vite vs Webpack"></a>Vite vs Webpack</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Vite çš„ä¼˜åŠ¿:</span></span><br><span class="line"><span class="comment">âœ… å¼€å‘æœåŠ¡å™¨å¯åŠ¨å¿«ï¼ˆä½¿ç”¨ esbuildï¼‰</span></span><br><span class="line"><span class="comment">âœ… çƒ­æ›´æ–°æå¿«ï¼ˆåŸç”Ÿ ESMï¼‰</span></span><br><span class="line"><span class="comment">âœ… å¼€ç®±å³ç”¨çš„ TypeScript æ”¯æŒ</span></span><br><span class="line"><span class="comment">âœ… æ›´ç®€æ´çš„é…ç½®</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Webpack çš„ä¼˜åŠ¿:</span></span><br><span class="line"><span class="comment">âœ… æ›´æˆç†Ÿçš„ç”Ÿæ€ç³»ç»Ÿ</span></span><br><span class="line"><span class="comment">âœ… æ›´å¼ºçš„å®šåˆ¶èƒ½åŠ›</span></span><br><span class="line"><span class="comment">âœ… æ›´å¥½çš„ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="Vite-åŸºç¡€é…ç½®"><a href="#Vite-åŸºç¡€é…ç½®" class="headerlink" title="Vite åŸºç¡€é…ç½®"></a>Vite åŸºç¡€é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vite.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> react <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">react</span>()],</span><br><span class="line"></span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./src&#x27;</span>),</span><br><span class="line">      <span class="string">&#x27;@components&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./src/components&#x27;</span>),</span><br><span class="line">      <span class="string">&#x27;@utils&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./src/utils&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">server</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: <span class="number">3000</span>,</span><br><span class="line">    <span class="attr">host</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://localhost:8080&#x27;</span>,</span><br><span class="line">        <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">rewrite</span>: <span class="function">(<span class="params">path</span>) =&gt;</span> path.<span class="title function_">replace</span>(<span class="regexp">/^\/api/</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">outDir</span>: <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">    <span class="attr">assetsDir</span>: <span class="string">&#x27;assets&#x27;</span>,</span><br><span class="line">    <span class="attr">sourcemap</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">minify</span>: <span class="string">&#x27;terser&#x27;</span>,</span><br><span class="line">    <span class="attr">terserOptions</span>: &#123;</span><br><span class="line">      <span class="attr">compress</span>: &#123;</span><br><span class="line">        <span class="attr">drop_console</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">drop_debugger</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">manualChunks</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;react-vendor&#x27;</span>: [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;react-dom&#x27;</span>],</span><br><span class="line">          <span class="string">&#x27;vue-vendor&#x27;</span>: [<span class="string">&#x27;vue&#x27;</span>, <span class="string">&#x27;vue-router&#x27;</span>, <span class="string">&#x27;pinia&#x27;</span>],</span><br><span class="line">          <span class="string">&#x27;ui-library&#x27;</span>: [<span class="string">&#x27;antd&#x27;</span>, <span class="string">&#x27;element-plus&#x27;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">chunkFileNames</span>: <span class="string">&#x27;js/[name]-[hash].js&#x27;</span>,</span><br><span class="line">        <span class="attr">entryFileNames</span>: <span class="string">&#x27;js/[name]-[hash].js&#x27;</span>,</span><br><span class="line">        <span class="attr">assetFileNames</span>: <span class="string">&#x27;[ext]/[name]-[hash].[ext]&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">chunkSizeWarningLimit</span>: <span class="number">1000</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">css</span>: &#123;</span><br><span class="line">    <span class="attr">modules</span>: &#123;</span><br><span class="line">      <span class="attr">localsConvention</span>: <span class="string">&#x27;camelCase&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">preprocessorOptions</span>: &#123;</span><br><span class="line">      <span class="attr">scss</span>: &#123;</span><br><span class="line">        <span class="attr">additionalData</span>: <span class="string">`@import &quot;@/styles/variables.scss&quot;;`</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">optimizeDeps</span>: &#123;</span><br><span class="line">    <span class="attr">include</span>: [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;react-dom&#x27;</span>],</span><br><span class="line">    <span class="attr">exclude</span>: []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Vite-ç¯å¢ƒå˜é‡"><a href="#Vite-ç¯å¢ƒå˜é‡" class="headerlink" title="Vite ç¯å¢ƒå˜é‡"></a>Vite ç¯å¢ƒå˜é‡</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .env</span></span><br><span class="line"><span class="variable constant_">VITE_APP_TITLE</span>=<span class="title class_">My</span> <span class="title class_">App</span></span><br><span class="line"><span class="variable constant_">VITE_API_BASE_URL</span>=<span class="attr">https</span>:<span class="comment">//api.example.com</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// .env.development</span></span><br><span class="line"><span class="variable constant_">VITE_API_BASE_URL</span>=<span class="attr">http</span>:<span class="comment">//localhost:8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// .env.production</span></span><br><span class="line"><span class="variable constant_">VITE_API_BASE_URL</span>=<span class="attr">https</span>:<span class="comment">//api.example.com</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_APP_TITLE</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">API_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»å‹å®šä¹‰</span></span><br><span class="line"><span class="comment">/// &lt;reference types=&quot;vite/client&quot; /&gt;</span></span><br><span class="line"></span><br><span class="line">interface <span class="title class_">ImportMetaEnv</span> &#123;</span><br><span class="line">  readonly <span class="attr">VITE_APP_TITLE</span>: string;</span><br><span class="line">  readonly <span class="attr">VITE_API_BASE_URL</span>: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface <span class="title class_">ImportMeta</span> &#123;</span><br><span class="line">  readonly <span class="attr">env</span>: <span class="title class_">ImportMetaEnv</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Vite-æ’ä»¶å¼€å‘"><a href="#Vite-æ’ä»¶å¼€å‘" class="headerlink" title="Vite æ’ä»¶å¼€å‘"></a>Vite æ’ä»¶å¼€å‘</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// my-plugin.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPlugin</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;my-plugin&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é’©å­å‡½æ•°</span></span><br><span class="line">    <span class="title function_">config</span>(<span class="params">config, &#123; command &#125;</span>) &#123;</span><br><span class="line">      <span class="comment">// ä¿®æ”¹é…ç½®</span></span><br><span class="line">      <span class="keyword">if</span> (command === <span class="string">&#x27;serve&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">server</span>: &#123;</span><br><span class="line">            <span class="attr">port</span>: <span class="number">3000</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="title function_">configureServer</span>(<span class="params">server</span>) &#123;</span><br><span class="line">      <span class="comment">// é…ç½®å¼€å‘æœåŠ¡å™¨</span></span><br><span class="line">      server.<span class="property">middlewares</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (req.<span class="property">url</span> === <span class="string">&#x27;/hello&#x27;</span>) &#123;</span><br><span class="line">          res.<span class="title function_">end</span>(<span class="string">&#x27;Hello from Vite plugin!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">next</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="title function_">transform</span>(<span class="params">code, id</span>) &#123;</span><br><span class="line">      <span class="comment">// è½¬æ¢ä»£ç </span></span><br><span class="line">      <span class="keyword">if</span> (id.<span class="title function_">endsWith</span>(<span class="string">&#x27;.special&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`export default <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(code)&#125;</span>`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="title function_">buildStart</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// æ„å»ºå¼€å§‹</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Build started&#x27;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="title function_">buildEnd</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// æ„å»ºç»“æŸ</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Build ended&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="comment">// vite.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; myPlugin &#125; <span class="keyword">from</span> <span class="string">&#x27;./my-plugin&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">react</span>(),</span><br><span class="line">    <span class="title function_">myPlugin</span>()</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€æ„å»ºä¼˜åŒ–å®æˆ˜"><a href="#å››ã€æ„å»ºä¼˜åŒ–å®æˆ˜" class="headerlink" title="å››ã€æ„å»ºä¼˜åŒ–å®æˆ˜"></a>å››ã€æ„å»ºä¼˜åŒ–å®æˆ˜</h2><h3 id="ä»£ç åˆ†å‰²ç­–ç•¥"><a href="#ä»£ç åˆ†å‰²ç­–ç•¥" class="headerlink" title="ä»£ç åˆ†å‰²ç­–ç•¥"></a>ä»£ç åˆ†å‰²ç­–ç•¥</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Webpack ä»£ç åˆ†å‰²</span></span><br><span class="line"><span class="comment">// åŠ¨æ€å¯¼å…¥</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/Home&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">About</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/About&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¢„åŠ è½½</span></span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackPrefetch: true */</span> <span class="string">&#x27;./path/to/Login&#x27;</span>);</span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackPreload: true */</span> <span class="string">&#x27;./path/to/HeavyComponent&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vite ä»£ç åˆ†å‰²</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">defineAsyncComponent</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/Home&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">About</span> = <span class="title function_">defineAsyncComponent</span>(&#123;</span><br><span class="line">  <span class="attr">loader</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/About&#x27;</span>),</span><br><span class="line">  <span class="attr">loadingComponent</span>: <span class="title class_">Loading</span>,</span><br><span class="line">  <span class="attr">errorComponent</span>: <span class="title class_">Error</span>,</span><br><span class="line">  <span class="attr">delay</span>: <span class="number">200</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">3000</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Tree-Shaking"><a href="#Tree-Shaking" class="headerlink" title="Tree Shaking"></a>Tree Shaking</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">usedExports</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">sideEffects</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;sideEffects&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;*.css&quot;</span>,</span><br><span class="line">    <span class="string">&quot;*.scss&quot;</span>,</span><br><span class="line">    <span class="string">&quot;./src/polyfills.js&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ ES6 æ¨¡å—</span></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡® - å¯ä»¥ tree-shaking</span></span><br><span class="line"><span class="keyword">export</span> &#123; fn1, fn2 &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; fn1 &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ - æ— æ³• tree-shaking</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; fn1, fn2 &#125;;</span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;./utils&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="èµ„æºä¼˜åŒ–"><a href="#èµ„æºä¼˜åŒ–" class="headerlink" title="èµ„æºä¼˜åŒ–"></a>èµ„æºä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å›¾ç‰‡ä¼˜åŒ–</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ImageMinimizerPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;image-minimizer-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [&#123;</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">      <span class="attr">use</span>: [&#123;</span><br><span class="line">        <span class="attr">loader</span>: <span class="title class_">ImageMinimizerPlugin</span>.<span class="property">loader</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">minimizer</span>: &#123;</span><br><span class="line">            <span class="attr">implementation</span>: <span class="title class_">ImageMinimizerPlugin</span>.<span class="property">imageminGenerate</span>,</span><br><span class="line">            <span class="attr">options</span>: &#123;</span><br><span class="line">              <span class="attr">plugins</span>: [</span><br><span class="line">                [<span class="string">&#x27;gifsicle&#x27;</span>, &#123; <span class="attr">interlaced</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">                [<span class="string">&#x27;jpegtran&#x27;</span>, &#123; <span class="attr">progressive</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">                [<span class="string">&#x27;optipng&#x27;</span>, &#123; <span class="attr">optimizationLevel</span>: <span class="number">5</span> &#125;],</span><br><span class="line">                [<span class="string">&#x27;svgo&#x27;</span>, &#123;</span><br><span class="line">                  <span class="attr">plugins</span>: [</span><br><span class="line">                    &#123;</span><br><span class="line">                      <span class="attr">name</span>: <span class="string">&#x27;preset-default&#x27;</span>,</span><br><span class="line">                      <span class="attr">params</span>: &#123;</span><br><span class="line">                        <span class="attr">overrides</span>: &#123;</span><br><span class="line">                          <span class="attr">removeViewBox</span>: <span class="literal">false</span>,</span><br><span class="line">                          <span class="attr">addAttributesToSVGElement</span>: &#123;</span><br><span class="line">                            <span class="attr">params</span>: &#123;</span><br><span class="line">                              <span class="attr">attributes</span>: [</span><br><span class="line">                                &#123; <span class="attr">xmlns</span>: <span class="string">&#x27;http://www.w3.org/2000/svg&#x27;</span> &#125;</span><br><span class="line">                              ]</span><br><span class="line">                            &#125;</span><br><span class="line">                          &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  ]</span><br><span class="line">                &#125;]</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—ä½“ä¼˜åŒ–</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [&#123;</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.(woff2?|eot|ttf|otf)$/</span>,</span><br><span class="line">      <span class="attr">use</span>: [&#123;</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">limit</span>: <span class="number">10000</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;[name].[hash:8].[ext]&#x27;</span>,</span><br><span class="line">          <span class="attr">outputPath</span>: <span class="string">&#x27;fonts/&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="CDN-åŠ é€Ÿ"><a href="#CDN-åŠ é€Ÿ" class="headerlink" title="CDN åŠ é€Ÿ"></a>CDN åŠ é€Ÿ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">externals</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;react&#x27;</span>: <span class="string">&#x27;React&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;react-dom&#x27;</span>: <span class="string">&#x27;ReactDOM&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;vue&#x27;</span>: <span class="string">&#x27;Vue&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;lodash&#x27;</span>: <span class="string">&#x27;_&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.html</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€CI-CD-é›†æˆ"><a href="#äº”ã€CI-CD-é›†æˆ" class="headerlink" title="äº”ã€CI&#x2F;CD é›†æˆ"></a>äº”ã€CI&#x2F;CD é›†æˆ</h2><h3 id="GitHub-Actions-é…ç½®"><a href="#GitHub-Actions-é…ç½®" class="headerlink" title="GitHub Actions é…ç½®"></a>GitHub Actions é…ç½®</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># .github/workflows/build.yml</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">Deploy</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">main</span>, <span class="string">develop</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">strategy:</span></span><br><span class="line">      <span class="attr">matrix:</span></span><br><span class="line">        <span class="attr">node-version:</span> [<span class="number">16.</span><span class="string">x</span>, <span class="number">18.</span><span class="string">x</span>]</span><br><span class="line"></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">code</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Node.js</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.node-version</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.node-version</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">cache:</span> <span class="string">&#x27;npm&#x27;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">dependencies</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">ci</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">linter</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">lint</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">tests</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">test</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">project</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">build</span> <span class="string">artifacts</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/upload-artifact@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">dist</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">dist/</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">matrix.node-version</span> <span class="string">==</span> <span class="string">&#x27;18.x&#x27;</span> <span class="string">&amp;&amp;</span> <span class="string">github.ref</span> <span class="string">==</span> <span class="string">&#x27;refs/heads/main&#x27;</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">github_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">publish_dir:</span> <span class="string">./dist</span></span><br></pre></td></tr></table></figure>

<h3 id="Docker-éƒ¨ç½²"><a href="#Docker-éƒ¨ç½²" class="headerlink" title="Docker éƒ¨ç½²"></a>Docker éƒ¨ç½²</h3><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dockerfile</span></span><br><span class="line"><span class="comment"># æ„å»ºé˜¶æ®µ</span></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">18</span>-alpine as builder</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package*.json ./</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm ci</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm run build</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿäº§é˜¶æ®µ</span></span><br><span class="line"><span class="keyword">FROM</span> nginx:alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /app/dist /usr/share/nginx/html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> nginx.conf /etc/nginx/nginx.conf</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;nginx&quot;</span>, <span class="string">&quot;-g&quot;</span>, <span class="string">&quot;daemon off;&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// nginx.conf</span></span><br><span class="line">server &#123;</span><br><span class="line">  listen <span class="number">80</span>;</span><br><span class="line">  server_name localhost;</span><br><span class="line"></span><br><span class="line">  root /usr/share/nginx/html;</span><br><span class="line">  index index.<span class="property">html</span>;</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    try_files $uri $uri/ /index.<span class="property">html</span>;</span><br><span class="line"></span><br><span class="line">    # ç¼“å­˜ç­–ç•¥</span><br><span class="line">    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ &#123;</span><br><span class="line">      expires 1y;</span><br><span class="line">      add_header <span class="title class_">Cache</span>-<span class="title class_">Control</span> <span class="string">&quot;public, immutable&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~* \.(html)$ &#123;</span><br><span class="line">      expires -<span class="number">1</span>;</span><br><span class="line">      add_header <span class="title class_">Cache</span>-<span class="title class_">Control</span> <span class="string">&quot;no-cache&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  # <span class="title class_">Gzip</span> å‹ç¼©</span><br><span class="line">  gzip on;</span><br><span class="line">  gzip_types text/plain text/css application/json application/javascript text/xml application/xml text/javascript;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€æ€§èƒ½ç›‘æ§"><a href="#å…­ã€æ€§èƒ½ç›‘æ§" class="headerlink" title="å…­ã€æ€§èƒ½ç›‘æ§"></a>å…­ã€æ€§èƒ½ç›‘æ§</h2><h3 id="Bundle-åˆ†æ"><a href="#Bundle-åˆ†æ" class="headerlink" title="Bundle åˆ†æ"></a>Bundle åˆ†æ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">BundleAnalyzerPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-bundle-analyzer&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">BundleAnalyzerPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">analyzerMode</span>: <span class="string">&#x27;static&#x27;</span>,</span><br><span class="line">      <span class="attr">openAnalyzer</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">reportFilename</span>: <span class="string">&#x27;bundle-report.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vite</span></span><br><span class="line"><span class="keyword">import</span> &#123; visualizer &#125; <span class="keyword">from</span> <span class="string">&#x27;rollup-plugin-visualizer&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">visualizer</span>(&#123;</span><br><span class="line">      <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;dist/stats.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="æ„å»ºé€Ÿåº¦ä¼˜åŒ–"><a href="#æ„å»ºé€Ÿåº¦ä¼˜åŒ–" class="headerlink" title="æ„å»ºé€Ÿåº¦ä¼˜åŒ–"></a>æ„å»ºé€Ÿåº¦ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ cache-loader</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [&#123;</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      <span class="attr">use</span>: [</span><br><span class="line">        <span class="string">&#x27;cache-loader&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;babel-loader&#x27;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨æŒä¹…åŒ–ç¼“å­˜</span></span><br><span class="line">  <span class="attr">cache</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;filesystem&#x27;</span>,</span><br><span class="line">    <span class="attr">cacheDirectory</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;.temp_cache&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šçº¿ç¨‹æ„å»º</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TerserPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;terser-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimizer</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">TerserPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">parallel</span>: <span class="literal">true</span></span><br><span class="line">      &#125;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="Webpack-vs-Vite-é€‰æ‹©"><a href="#Webpack-vs-Vite-é€‰æ‹©" class="headerlink" title="Webpack vs Vite é€‰æ‹©"></a>Webpack vs Vite é€‰æ‹©</h3><p><strong>é€‰æ‹© Webpack å¦‚æœä½ éœ€è¦ï¼š</strong></p>
<ul>
<li>âœ… å¤æ‚çš„å®šåˆ¶éœ€æ±‚</li>
<li>âœ… æˆç†Ÿçš„æ’ä»¶ç”Ÿæ€</li>
<li>âœ… ç»†ç²’åº¦çš„é…ç½®æ§åˆ¶</li>
</ul>
<p><strong>é€‰æ‹© Vite å¦‚æœä½ éœ€è¦ï¼š</strong></p>
<ul>
<li>âœ… å¿«é€Ÿçš„å¼€å‘ä½“éªŒ</li>
<li>âœ… å¼€ç®±å³ç”¨çš„é…ç½®</li>
<li>âœ… ç°ä»£åŒ–çš„æ„å»ºå·¥å…·</li>
</ul>
<h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><ol>
<li><strong>ä»£ç åˆ†å‰²</strong> - æŒ‰è·¯ç”±å’Œä¾›åº”å•†æ‹†åˆ†ä»£ç </li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong> - contenthash + é•¿æœŸç¼“å­˜</li>
<li><strong>å‹ç¼©ä¼˜åŒ–</strong> - Gzip&#x2F;Brotli + ä»£ç å‹ç¼©</li>
<li><strong>CDN åŠ é€Ÿ</strong> - é™æ€èµ„æº CDN æ‰˜ç®¡</li>
<li><strong>æ€§èƒ½ç›‘æ§</strong> - æŒç»­ç›‘æµ‹æ„å»ºäº§ç‰©</li>
</ol>
<p><strong>å­¦ä¹ è·¯å¾„</strong>ï¼š</p>
<ol>
<li>æŒæ¡åŸºç¡€é…ç½®</li>
<li>å­¦ä¹ æ€§èƒ½ä¼˜åŒ–</li>
<li>å®è·µ CI&#x2F;CD</li>
<li>ç›‘æ§å’Œè°ƒä¼˜</li>
</ol>
<p>å‰ç«¯å·¥ç¨‹åŒ–æ˜¯ä¸€ä¸ªæŒç»­ä¼˜åŒ–çš„è¿‡ç¨‹ï¼Œæ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„å·¥å…·å’Œç­–ç•¥ï¼</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†ä»‹ç» TypeScript è¿›é˜¶ï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>å·¥ç¨‹åŒ–</category>
      </categories>
      <tags>
        <tag>æ€§èƒ½ä¼˜åŒ–</tag>
        <tag>Webpack</tag>
        <tag>Vite</tag>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>æ„å»ºå·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>äººå·¥æ™ºèƒ½å…¥é—¨ï¼šä»é›¶å¼€å§‹äº†è§£AI</title>
    <url>/2026/01/20/ai-introduction/</url>
    <content><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ</h2><p>äººå·¥æ™ºèƒ½ï¼ˆArtificial Intelligenceï¼Œç®€ç§°AIï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œè‡´åŠ›äºåˆ›å»ºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½çš„ä»»åŠ¡çš„ç³»ç»Ÿã€‚è¿™äº›ä»»åŠ¡åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å­¦ä¹ </strong> - ä»æ•°æ®ä¸­è·å–ä¿¡æ¯å’Œè§„åˆ™</li>
<li><strong>æ¨ç†</strong> - ä½¿ç”¨è§„åˆ™å¾—å‡ºè¿‘ä¼¼æˆ–ç¡®å®šçš„ç»“è®º</li>
<li><strong>è‡ªæˆ‘ä¿®æ­£</strong> - åœ¨è¿‡ç¨‹ä¸­ä¸æ–­ä¼˜åŒ–æ”¹è¿›</li>
<li><strong>æ„ŸçŸ¥</strong> - åŒ…æ‹¬è§†è§‰ã€è¯­éŸ³è¯†åˆ«ç­‰</li>
</ul>
<h2 id="AIçš„å‘å±•å†ç¨‹"><a href="#AIçš„å‘å±•å†ç¨‹" class="headerlink" title="AIçš„å‘å±•å†ç¨‹"></a>AIçš„å‘å±•å†ç¨‹</h2><h3 id="ç¬¬ä¸€ä»£ï¼šç¬¦å·ä¸»ä¹‰AIï¼ˆ1956-1980sï¼‰"><a href="#ç¬¬ä¸€ä»£ï¼šç¬¦å·ä¸»ä¹‰AIï¼ˆ1956-1980sï¼‰" class="headerlink" title="ç¬¬ä¸€ä»£ï¼šç¬¦å·ä¸»ä¹‰AIï¼ˆ1956-1980sï¼‰"></a>ç¬¬ä¸€ä»£ï¼šç¬¦å·ä¸»ä¹‰AIï¼ˆ1956-1980sï¼‰</h3><p>åŸºäºé€»è¾‘å’Œè§„åˆ™ï¼Œä»£è¡¨ç³»ç»ŸåŒ…æ‹¬ä¸“å®¶ç³»ç»Ÿã€‚è¿™ç±»AIé€šè¿‡äººå·¥ç¼–å†™çš„è§„åˆ™æ¥è§£å†³é—®é¢˜ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç®€å•çš„è§„åˆ™ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">diagnose_symptoms</span>(<span class="params">fever, cough, fatigue</span>):</span><br><span class="line">    <span class="keyword">if</span> fever <span class="keyword">and</span> cough:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¯èƒ½æ˜¯æ„Ÿå†’&quot;</span></span><br><span class="line">    <span class="keyword">if</span> fatigue <span class="keyword">and</span> <span class="keyword">not</span> fever:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¯èƒ½æ˜¯ç–²åŠ³&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬äºŒä»£ï¼šè¿æ¥ä¸»ä¹‰AIï¼ˆ1980s-2010sï¼‰"><a href="#ç¬¬äºŒä»£ï¼šè¿æ¥ä¸»ä¹‰AIï¼ˆ1980s-2010sï¼‰" class="headerlink" title="ç¬¬äºŒä»£ï¼šè¿æ¥ä¸»ä¹‰AIï¼ˆ1980s-2010sï¼‰"></a>ç¬¬äºŒä»£ï¼šè¿æ¥ä¸»ä¹‰AIï¼ˆ1980s-2010sï¼‰</h3><p>åŸºäºç¥ç»ç½‘ç»œï¼Œæ¨¡æ‹Ÿäººè„‘ç¥ç»å…ƒè¿æ¥ã€‚æ·±åº¦å­¦ä¹ å°±å±äºè¿™ä¸€ç±»ã€‚</p>
<h3 id="ç¬¬ä¸‰ä»£ï¼šé€šç”¨äººå·¥æ™ºèƒ½ï¼ˆ2010s-è‡³ä»Šï¼‰"><a href="#ç¬¬ä¸‰ä»£ï¼šé€šç”¨äººå·¥æ™ºèƒ½ï¼ˆ2010s-è‡³ä»Šï¼‰" class="headerlink" title="ç¬¬ä¸‰ä»£ï¼šé€šç”¨äººå·¥æ™ºèƒ½ï¼ˆ2010s-è‡³ä»Šï¼‰"></a>ç¬¬ä¸‰ä»£ï¼šé€šç”¨äººå·¥æ™ºèƒ½ï¼ˆ2010s-è‡³ä»Šï¼‰</h3><p>æ›´æ¥è¿‘äººç±»æ™ºèƒ½ï¼Œå…·å¤‡å¤šé¢†åŸŸå­¦ä¹ å’Œæ¨ç†èƒ½åŠ›ã€‚</p>
<h2 id="AIçš„ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯"><a href="#AIçš„ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="AIçš„ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯"></a>AIçš„ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯</h2><h3 id="1-æœºå™¨å­¦ä¹ ï¼ˆMachine-Learningï¼‰"><a href="#1-æœºå™¨å­¦ä¹ ï¼ˆMachine-Learningï¼‰" class="headerlink" title="1. æœºå™¨å­¦ä¹ ï¼ˆMachine Learningï¼‰"></a>1. æœºå™¨å­¦ä¹ ï¼ˆMachine Learningï¼‰</h3><p>æœºå™¨å­¦ä¹ æ˜¯AIçš„æ ¸å¿ƒï¼Œè®©è®¡ç®—æœºä»æ•°æ®ä¸­å­¦ä¹ è§„å¾‹ï¼Œè€Œä¸æ˜¯æ˜¾å¼ç¼–ç¨‹ã€‚</p>
<p><strong>å¸¸è§ç®—æ³•ç±»å‹ï¼š</strong></p>
<ul>
<li>ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰</li>
<li>æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰</li>
<li>å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼‰</li>
</ul>
<h3 id="2-æ·±åº¦å­¦ä¹ ï¼ˆDeep-Learningï¼‰"><a href="#2-æ·±åº¦å­¦ä¹ ï¼ˆDeep-Learningï¼‰" class="headerlink" title="2. æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰"></a>2. æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰</h3><p>åŸºäºå¤šå±‚ç¥ç»ç½‘ç»œçš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œåœ¨å›¾åƒè¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸè¡¨ç°å“è¶Šã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç®€å•çš„ç¥ç»ç½‘ç»œç¤ºä¾‹ï¼ˆä½¿ç”¨Kerasï¼‰</span></span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Dense(<span class="number">128</span>, activation=<span class="string">&#x27;relu&#x27;</span>, input_shape=(<span class="number">784</span>,)),</span><br><span class="line">    layers.Dropout(<span class="number">0.2</span>),</span><br><span class="line">    layers.Dense(<span class="number">64</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">              loss=<span class="string">&#x27;categorical_crossentropy&#x27;</span>,</span><br><span class="line">              metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h3 id="3-è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰"><a href="#3-è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰" class="headerlink" title="3. è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰"></a>3. è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰</h3><p>è®©è®¡ç®—æœºç†è§£ã€ç”Ÿæˆå’Œå¤„ç†äººç±»è¯­è¨€çš„æŠ€æœ¯ã€‚ChatGPTã€BERTç­‰éƒ½æ˜¯NLPçš„æ°å‡ºä»£è¡¨ã€‚</p>
<h2 id="AIçš„åº”ç”¨é¢†åŸŸ"><a href="#AIçš„åº”ç”¨é¢†åŸŸ" class="headerlink" title="AIçš„åº”ç”¨é¢†åŸŸ"></a>AIçš„åº”ç”¨é¢†åŸŸ</h2><table>
<thead>
<tr>
<th>é¢†åŸŸ</th>
<th>åº”ç”¨æ¡ˆä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>åŒ»ç–—å¥åº·</td>
<td>ç–¾ç—…è¯Šæ–­ã€è¯ç‰©ç ”å‘</td>
</tr>
<tr>
<td>é‡‘è</td>
<td>é£é™©è¯„ä¼°ã€é‡åŒ–äº¤æ˜“</td>
</tr>
<tr>
<td>äº¤é€š</td>
<td>è‡ªåŠ¨é©¾é©¶ã€äº¤é€šä¼˜åŒ–</td>
</tr>
<tr>
<td>æ•™è‚²</td>
<td>ä¸ªæ€§åŒ–å­¦ä¹ ã€æ™ºèƒ½è¾…å¯¼</td>
</tr>
<tr>
<td>å¨±ä¹</td>
<td>å†…å®¹æ¨èã€æ¸¸æˆAI</td>
</tr>
</tbody></table>
<h2 id="å¦‚ä½•å¼€å§‹å­¦ä¹ AIï¼Ÿ"><a href="#å¦‚ä½•å¼€å§‹å­¦ä¹ AIï¼Ÿ" class="headerlink" title="å¦‚ä½•å¼€å§‹å­¦ä¹ AIï¼Ÿ"></a>å¦‚ä½•å¼€å§‹å­¦ä¹ AIï¼Ÿ</h2><h3 id="1-æ•°å­¦åŸºç¡€"><a href="#1-æ•°å­¦åŸºç¡€" class="headerlink" title="1. æ•°å­¦åŸºç¡€"></a>1. æ•°å­¦åŸºç¡€</h3><ul>
<li>çº¿æ€§ä»£æ•°</li>
<li>æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡</li>
<li>å¾®ç§¯åˆ†</li>
</ul>
<h3 id="2-ç¼–ç¨‹æŠ€èƒ½"><a href="#2-ç¼–ç¨‹æŠ€èƒ½" class="headerlink" title="2. ç¼–ç¨‹æŠ€èƒ½"></a>2. ç¼–ç¨‹æŠ€èƒ½</h3><ul>
<li>Pythonï¼ˆAIé¢†åŸŸæœ€æµè¡Œçš„è¯­è¨€ï¼‰</li>
<li>Rè¯­è¨€</li>
<li>SQLï¼ˆæ•°æ®å¤„ç†ï¼‰</li>
</ul>
<h3 id="3-æ¡†æ¶å’Œå·¥å…·"><a href="#3-æ¡†æ¶å’Œå·¥å…·" class="headerlink" title="3. æ¡†æ¶å’Œå·¥å…·"></a>3. æ¡†æ¶å’Œå·¥å…·</h3><ul>
<li>TensorFlow &#x2F; PyTorchï¼ˆæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼‰</li>
<li>Scikit-learnï¼ˆæœºå™¨å­¦ä¹ åº“ï¼‰</li>
<li>Jupyter Notebookï¼ˆå¼€å‘ç¯å¢ƒï¼‰</li>
</ul>
<h3 id="æ¨èå­¦ä¹ èµ„æº"><a href="#æ¨èå­¦ä¹ èµ„æº" class="headerlink" title="æ¨èå­¦ä¹ èµ„æº"></a>æ¨èå­¦ä¹ èµ„æº</h3><p><strong>åœ¨çº¿è¯¾ç¨‹ï¼š</strong></p>
<ul>
<li>Andrew Ngçš„Machine Learningè¯¾ç¨‹ï¼ˆCourseraï¼‰</li>
<li>Fast.aiçš„æ·±åº¦å­¦ä¹ è¯¾ç¨‹</li>
<li>å´æ©è¾¾æ·±åº¦å­¦ä¹ ä¸“é¡¹è¯¾ç¨‹</li>
</ul>
<p><strong>å®è·µå¹³å°ï¼š</strong></p>
<ul>
<li>Kaggleï¼ˆæ•°æ®ç«èµ›å¹³å°ï¼‰</li>
<li>GitHubï¼ˆå¼€æºé¡¹ç›®ï¼‰</li>
<li>Google Colabï¼ˆå…è´¹GPUï¼‰</li>
</ul>
<h2 id="AIçš„æœªæ¥å±•æœ›"><a href="#AIçš„æœªæ¥å±•æœ›" class="headerlink" title="AIçš„æœªæ¥å±•æœ›"></a>AIçš„æœªæ¥å±•æœ›</h2><p>éšç€æŠ€æœ¯ä¸æ–­è¿›æ­¥ï¼ŒAIæ­£åœ¨å‘ä»¥ä¸‹æ–¹å‘å‘å±•ï¼š</p>
<ol>
<li><strong>æ›´æ™ºèƒ½çš„å¯¹è¯ç³»ç»Ÿ</strong> - æ›´è‡ªç„¶çš„äººæœºäº¤äº’</li>
<li><strong>å¤šæ¨¡æ€AI</strong> - åŒæ—¶å¤„ç†æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘</li>
<li><strong>è¾¹ç¼˜AI</strong> - åœ¨è®¾å¤‡ç«¯è¿è¡Œï¼Œä¿æŠ¤éšç§</li>
<li><strong>å¯è§£é‡ŠAI</strong> - è®©AIå†³ç­–è¿‡ç¨‹æ›´é€æ˜</li>
<li><strong>AIä¼¦ç†</strong> - ç¡®ä¿AIçš„å®‰å…¨ã€å…¬å¹³å’Œè´Ÿè´£ä»»</li>
</ol>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>äººå·¥æ™ºèƒ½æ­£åœ¨æ”¹å˜æˆ‘ä»¬çš„ä¸–ç•Œï¼Œä»æ—¥å¸¸åº”ç”¨åˆ°ç§‘å­¦ç ”ç©¶ï¼ŒAIçš„å½±å“æ— å¤„ä¸åœ¨ã€‚ä½œä¸ºæŠ€æœ¯äººå‘˜ï¼Œäº†è§£å’ŒæŒæ¡AIçŸ¥è¯†å°†æˆä¸ºæœªæ¥ç«äº‰åŠ›çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p>
<p>å¼€å§‹å­¦ä¹ AIçš„æœ€å¥½æ–¹å¼æ˜¯åŠ¨æ‰‹å®è·µï¼šé€‰æ‹©ä¸€ä¸ªå°é¡¹ç›®ï¼Œä½¿ç”¨å¼€æºæ•°æ®é›†ï¼Œè®­ç»ƒä½ çš„ç¬¬ä¸€ä¸ªæ¨¡å‹ï¼</p>
<hr>
<p><em>æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„AIå­¦ä¹ å¿ƒå¾—ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>AI</category>
      </categories>
      <tags>
        <tag>AI</tag>
        <tag>äººå·¥æ™ºèƒ½</tag>
        <tag>å…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±åº¦å­¦ä¹ å®Œå…¨æŒ‡å—ï¼šç¥ç»ç½‘ç»œä¸å®æˆ˜åº”ç”¨</title>
    <url>/2026/01/20/deep-learning-guide/</url>
    <content><![CDATA[<h2 id="æ·±åº¦å­¦ä¹ ç®€ä»‹"><a href="#æ·±åº¦å­¦ä¹ ç®€ä»‹" class="headerlink" title="æ·±åº¦å­¦ä¹ ç®€ä»‹"></a>æ·±åº¦å­¦ä¹ ç®€ä»‹</h2><p>æ·±åº¦å­¦ä¹ ï¼ˆDeep Learningï¼‰æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­é›†ï¼Œä½¿ç”¨å¤šå±‚ç¥ç»ç½‘ç»œæ¥å­¦ä¹ æ•°æ®çš„å¤æ‚æ¨¡å¼ã€‚å®ƒåœ¨å›¾åƒè¯†åˆ«ã€è¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸå–å¾—äº†çªç ´æ€§è¿›å±•ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆé€‰æ‹©æ·±åº¦å­¦ä¹ ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©æ·±åº¦å­¦ä¹ ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©æ·±åº¦å­¦ä¹ ï¼Ÿ"></a>ä¸ºä»€ä¹ˆé€‰æ‹©æ·±åº¦å­¦ä¹ ï¼Ÿ</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¼ ç»Ÿæœºå™¨å­¦ä¹  vs æ·±åº¦å­¦ä¹ </span></span><br><span class="line">ä¼ ç»Ÿæœºå™¨å­¦ä¹ :</span><br><span class="line">    - éœ€è¦æ‰‹åŠ¨æå–ç‰¹å¾</span><br><span class="line">    - é€‚åˆç»“æ„åŒ–æ•°æ®</span><br><span class="line">    - è§£é‡Šæ€§å¼º</span><br><span class="line"></span><br><span class="line">æ·±åº¦å­¦ä¹ :</span><br><span class="line">    - è‡ªåŠ¨å­¦ä¹ ç‰¹å¾è¡¨ç¤º</span><br><span class="line">    - é€‚åˆéç»“æ„åŒ–æ•°æ®ï¼ˆå›¾åƒã€æ–‡æœ¬ã€éŸ³é¢‘ï¼‰</span><br><span class="line">    - éœ€è¦å¤§é‡æ•°æ®å’Œè®¡ç®—èµ„æº</span><br></pre></td></tr></table></figure>

<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><h3 id="å®‰è£…PyTorch"><a href="#å®‰è£…PyTorch" class="headerlink" title="å®‰è£…PyTorch"></a>å®‰è£…PyTorch</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># CPUç‰ˆæœ¬</span></span><br><span class="line">pip install torch torchvision torchaudio</span><br><span class="line"></span><br><span class="line"><span class="comment"># GPUç‰ˆæœ¬ï¼ˆCUDA 11.8ï¼‰</span></span><br><span class="line">pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯å®‰è£…</span></span><br><span class="line">python -c <span class="string">&quot;import torch; print(torch.__version__)&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="å®‰è£…TensorFlowï¼ˆå¯é€‰ï¼‰"><a href="#å®‰è£…TensorFlowï¼ˆå¯é€‰ï¼‰" class="headerlink" title="å®‰è£…TensorFlowï¼ˆå¯é€‰ï¼‰"></a>å®‰è£…TensorFlowï¼ˆå¯é€‰ï¼‰</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install tensorflow</span><br></pre></td></tr></table></figure>

<h2 id="ç¥ç»ç½‘ç»œåŸºç¡€"><a href="#ç¥ç»ç½‘ç»œåŸºç¡€" class="headerlink" title="ç¥ç»ç½‘ç»œåŸºç¡€"></a>ç¥ç»ç½‘ç»œåŸºç¡€</h2><h3 id="1-æ„ŸçŸ¥æœº-ç¥ç»ç½‘ç»œçš„åŸºçŸ³"><a href="#1-æ„ŸçŸ¥æœº-ç¥ç»ç½‘ç»œçš„åŸºçŸ³" class="headerlink" title="1. æ„ŸçŸ¥æœº - ç¥ç»ç½‘ç»œçš„åŸºçŸ³"></a>1. æ„ŸçŸ¥æœº - ç¥ç»ç½‘ç»œçš„åŸºçŸ³</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®€å•çš„æ„ŸçŸ¥æœº</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Perceptron</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_size</span>):</span><br><span class="line">        <span class="built_in">super</span>(Perceptron, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.linear = nn.Linear(input_size, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> torch.sigmoid(<span class="variable language_">self</span>.linear(x))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line">perceptron = Perceptron(input_size=<span class="number">2</span>)</span><br><span class="line">x = torch.tensor([[<span class="number">1.0</span>, <span class="number">2.0</span>]])</span><br><span class="line">output = perceptron(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è¾“å‡º: <span class="subst">&#123;output.item():<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰"><a href="#2-å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰" class="headerlink" title="2. å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰"></a>2. å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MLP</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_size, hidden_size, output_size</span>):</span><br><span class="line">        <span class="built_in">super</span>(MLP, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.layer1 = nn.Linear(input_size, hidden_size)</span><br><span class="line">        <span class="variable language_">self</span>.relu = nn.ReLU()</span><br><span class="line">        <span class="variable language_">self</span>.layer2 = nn.Linear(hidden_size, hidden_size)</span><br><span class="line">        <span class="variable language_">self</span>.layer3 = nn.Linear(hidden_size, output_size)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = <span class="variable language_">self</span>.relu(<span class="variable language_">self</span>.layer1(x))</span><br><span class="line">        x = <span class="variable language_">self</span>.relu(<span class="variable language_">self</span>.layer2(x))</span><br><span class="line">        x = <span class="variable language_">self</span>.layer3(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ¨¡å‹</span></span><br><span class="line">model = MLP(input_size=<span class="number">784</span>, hidden_size=<span class="number">256</span>, output_size=<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(model)</span><br></pre></td></tr></table></figure>

<h2 id="æ¿€æ´»å‡½æ•°è¯¦è§£"><a href="#æ¿€æ´»å‡½æ•°è¯¦è§£" class="headerlink" title="æ¿€æ´»å‡½æ•°è¯¦è§£"></a>æ¿€æ´»å‡½æ•°è¯¦è§£</h2><p>æ¿€æ´»å‡½æ•°å¼•å…¥éçº¿æ€§ï¼Œä½¿ç¥ç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å¤æ‚æ¨¡å¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line">x = torch.linspace(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸ç”¨æ¿€æ´»å‡½æ•°</span></span><br><span class="line">activations = &#123;</span><br><span class="line">    <span class="string">&#x27;ReLU&#x27;</span>: F.relu(x),</span><br><span class="line">    <span class="string">&#x27;Sigmoid&#x27;</span>: torch.sigmoid(x),</span><br><span class="line">    <span class="string">&#x27;Tanh&#x27;</span>: torch.tanh(x),</span><br><span class="line">    <span class="string">&#x27;LeakyReLU&#x27;</span>: F.leaky_relu(x, negative_slope=<span class="number">0.01</span>),</span><br><span class="line">    <span class="string">&#x27;GELU&#x27;</span>: F.gelu(x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¿€æ´»å‡½æ•°é€‰æ‹©æŒ‡å—</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">- ReLU: é»˜è®¤é€‰æ‹©ï¼Œè®¡ç®—å¿«é€Ÿ</span></span><br><span class="line"><span class="string">- LeakyReLU: è§£å†³ReLUç¥ç»å…ƒæ­»äº¡é—®é¢˜</span></span><br><span class="line"><span class="string">- Sigmoid: è¾“å‡ºæ¦‚ç‡ï¼ˆ0-1ä¹‹é—´ï¼‰</span></span><br><span class="line"><span class="string">- Tanh: è¾“å‡ºèŒƒå›´-1åˆ°1</span></span><br><span class="line"><span class="string">- GELU: Transformerä¸­å¸¸ç”¨ï¼Œæ€§èƒ½æ›´å¥½</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰"><a href="#å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰" class="headerlink" title="å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰"></a>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰</h2><p>CNNæ˜¯å¤„ç†å›¾åƒçš„åˆ©å™¨ï¼Œé€šè¿‡å·ç§¯å±‚è‡ªåŠ¨æå–å›¾åƒç‰¹å¾ã€‚</p>
<h3 id="CNNæ¶æ„ç¤ºä¾‹"><a href="#CNNæ¶æ„ç¤ºä¾‹" class="headerlink" title="CNNæ¶æ„ç¤ºä¾‹"></a>CNNæ¶æ„ç¤ºä¾‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CNN</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, num_classes=<span class="number">10</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(CNN, <span class="variable language_">self</span>).__init__()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å·ç§¯å±‚</span></span><br><span class="line">        <span class="variable language_">self</span>.conv1 = nn.Conv2d(<span class="number">1</span>, <span class="number">32</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.conv2 = nn.Conv2d(<span class="number">32</span>, <span class="number">64</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.conv3 = nn.Conv2d(<span class="number">64</span>, <span class="number">128</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ± åŒ–å±‚</span></span><br><span class="line">        <span class="variable language_">self</span>.pool = nn.MaxPool2d(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å…¨è¿æ¥å±‚</span></span><br><span class="line">        <span class="variable language_">self</span>.fc1 = nn.Linear(<span class="number">128</span> * <span class="number">3</span> * <span class="number">3</span>, <span class="number">512</span>)</span><br><span class="line">        <span class="variable language_">self</span>.fc2 = nn.Linear(<span class="number">512</span>, num_classes)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Dropouté˜²æ­¢è¿‡æ‹Ÿåˆ</span></span><br><span class="line">        <span class="variable language_">self</span>.dropout = nn.Dropout(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># å·ç§¯å—1</span></span><br><span class="line">        x = <span class="variable language_">self</span>.pool(F.relu(<span class="variable language_">self</span>.conv1(x)))  <span class="comment"># 28x28 -&gt; 14x14</span></span><br><span class="line">        x = <span class="variable language_">self</span>.pool(F.relu(<span class="variable language_">self</span>.conv2(x)))  <span class="comment"># 14x14 -&gt; 7x7</span></span><br><span class="line">        x = <span class="variable language_">self</span>.pool(F.relu(<span class="variable language_">self</span>.conv3(x)))  <span class="comment"># 7x7 -&gt; 3x3</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å±•å¹³</span></span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">128</span> * <span class="number">3</span> * <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å…¨è¿æ¥å±‚</span></span><br><span class="line">        x = <span class="variable language_">self</span>.dropout(F.relu(<span class="variable language_">self</span>.fc1(x)))</span><br><span class="line">        x = <span class="variable language_">self</span>.fc2(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºCNNæ¨¡å‹</span></span><br><span class="line">cnn = CNN(num_classes=<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;CNNå‚æ•°é‡: <span class="subst">&#123;<span class="built_in">sum</span>(p.numel() <span class="keyword">for</span> p <span class="keyword">in</span> cnn.parameters()):,&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="ç»å…¸CNNæ¶æ„"><a href="#ç»å…¸CNNæ¶æ„" class="headerlink" title="ç»å…¸CNNæ¶æ„"></a>ç»å…¸CNNæ¶æ„</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ResNetæ®‹å·®è¿æ¥</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResidualBlock</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, stride=<span class="number">1</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(ResidualBlock, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.conv1 = nn.Conv2d(in_channels, out_channels,</span><br><span class="line">                               kernel_size=<span class="number">3</span>, stride=stride, padding=<span class="number">1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.bn1 = nn.BatchNorm2d(out_channels)</span><br><span class="line">        <span class="variable language_">self</span>.conv2 = nn.Conv2d(out_channels, out_channels,</span><br><span class="line">                               kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.bn2 = nn.BatchNorm2d(out_channels)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ®‹å·®è¿æ¥</span></span><br><span class="line">        <span class="variable language_">self</span>.shortcut = nn.Sequential()</span><br><span class="line">        <span class="keyword">if</span> stride != <span class="number">1</span> <span class="keyword">or</span> in_channels != out_channels:</span><br><span class="line">            <span class="variable language_">self</span>.shortcut = nn.Sequential(</span><br><span class="line">                nn.Conv2d(in_channels, out_channels,</span><br><span class="line">                         kernel_size=<span class="number">1</span>, stride=stride),</span><br><span class="line">                nn.BatchNorm2d(out_channels)</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        out = F.relu(<span class="variable language_">self</span>.bn1(<span class="variable language_">self</span>.conv1(x)))</span><br><span class="line">        out = <span class="variable language_">self</span>.bn2(<span class="variable language_">self</span>.conv2(out))</span><br><span class="line">        out += <span class="variable language_">self</span>.shortcut(x)  <span class="comment"># æ®‹å·®è¿æ¥</span></span><br><span class="line">        out = F.relu(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>

<h2 id="å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ä¸LSTM"><a href="#å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ä¸LSTM" class="headerlink" title="å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ä¸LSTM"></a>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ä¸LSTM</h2><p>RNNé€‚åˆå¤„ç†åºåˆ—æ•°æ®ï¼Œå¦‚æ–‡æœ¬ã€æ—¶é—´åºåˆ—ã€‚</p>
<h3 id="LSTMæ¨¡å‹"><a href="#LSTMæ¨¡å‹" class="headerlink" title="LSTMæ¨¡å‹"></a>LSTMæ¨¡å‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LSTMModel</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, vocab_size, embedding_dim, hidden_dim, output_dim</span>):</span><br><span class="line">        <span class="built_in">super</span>(LSTMModel, <span class="variable language_">self</span>).__init__()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¯åµŒå…¥å±‚</span></span><br><span class="line">        <span class="variable language_">self</span>.embedding = nn.Embedding(vocab_size, embedding_dim)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># LSTMå±‚</span></span><br><span class="line">        <span class="variable language_">self</span>.lstm = nn.LSTM(</span><br><span class="line">            embedding_dim,</span><br><span class="line">            hidden_dim,</span><br><span class="line">            num_layers=<span class="number">2</span>,</span><br><span class="line">            bidirectional=<span class="literal">True</span>,</span><br><span class="line">            dropout=<span class="number">0.5</span>,</span><br><span class="line">            batch_first=<span class="literal">True</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å…¨è¿æ¥å±‚</span></span><br><span class="line">        <span class="variable language_">self</span>.fc = nn.Linear(hidden_dim * <span class="number">2</span>, output_dim)</span><br><span class="line">        <span class="variable language_">self</span>.dropout = nn.Dropout(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, text</span>):</span><br><span class="line">        <span class="comment"># text: [batch_size, seq_len]</span></span><br><span class="line">        embedded = <span class="variable language_">self</span>.dropout(<span class="variable language_">self</span>.embedding(text))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># lstm: [batch_size, seq_len, hidden_dim * 2]</span></span><br><span class="line">        output, (hidden, cell) = <span class="variable language_">self</span>.lstm(embedded)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‹¼æ¥åŒå‘LSTMçš„æœ€åéšè—çŠ¶æ€</span></span><br><span class="line">        hidden = torch.cat((hidden[-<span class="number">2</span>,:,:], hidden[-<span class="number">1</span>,:,:]), dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.fc(<span class="variable language_">self</span>.dropout(hidden))</span><br></pre></td></tr></table></figure>

<h2 id="Transformeræ¶æ„"><a href="#Transformeræ¶æ„" class="headerlink" title="Transformeræ¶æ„"></a>Transformeræ¶æ„</h2><p>Transformeræ˜¯ç°ä»£NLPçš„æ ¸å¿ƒæ¶æ„ï¼Œç”¨äºGPTã€BERTç­‰æ¨¡å‹ã€‚</p>
<h3 id="è‡ªæ³¨æ„åŠ›æœºåˆ¶"><a href="#è‡ªæ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="è‡ªæ³¨æ„åŠ›æœºåˆ¶"></a>è‡ªæ³¨æ„åŠ›æœºåˆ¶</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MultiHeadAttention</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model, num_heads</span>):</span><br><span class="line">        <span class="built_in">super</span>(MultiHeadAttention, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="keyword">assert</span> d_model % num_heads == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.d_model = d_model</span><br><span class="line">        <span class="variable language_">self</span>.num_heads = num_heads</span><br><span class="line">        <span class="variable language_">self</span>.d_k = d_model // num_heads</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Q, K, Vçº¿æ€§å˜æ¢</span></span><br><span class="line">        <span class="variable language_">self</span>.W_q = nn.Linear(d_model, d_model)</span><br><span class="line">        <span class="variable language_">self</span>.W_k = nn.Linear(d_model, d_model)</span><br><span class="line">        <span class="variable language_">self</span>.W_v = nn.Linear(d_model, d_model)</span><br><span class="line">        <span class="variable language_">self</span>.W_o = nn.Linear(d_model, d_model)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">attention</span>(<span class="params">self, Q, K, V, mask=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="comment"># è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°</span></span><br><span class="line">        scores = torch.matmul(Q, K.transpose(-<span class="number">2</span>, -<span class="number">1</span>)) / math.sqrt(<span class="variable language_">self</span>.d_k)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> mask <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            scores = scores.masked_fill(mask == <span class="number">0</span>, -<span class="number">1e9</span>)</span><br><span class="line"></span><br><span class="line">        attention_weights = F.softmax(scores, dim=-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> torch.matmul(attention_weights, V)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, query, key, value, mask=<span class="literal">None</span></span>):</span><br><span class="line">        batch_size = query.size(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># çº¿æ€§å˜æ¢å¹¶åˆ†å‰²æˆå¤šä¸ªå¤´</span></span><br><span class="line">        Q = <span class="variable language_">self</span>.W_q(query).view(batch_size, -<span class="number">1</span>, <span class="variable language_">self</span>.num_heads, <span class="variable language_">self</span>.d_k).transpose(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        K = <span class="variable language_">self</span>.W_k(key).view(batch_size, -<span class="number">1</span>, <span class="variable language_">self</span>.num_heads, <span class="variable language_">self</span>.d_k).transpose(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        V = <span class="variable language_">self</span>.W_v(value).view(batch_size, -<span class="number">1</span>, <span class="variable language_">self</span>.num_heads, <span class="variable language_">self</span>.d_k).transpose(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®¡ç®—æ³¨æ„åŠ›</span></span><br><span class="line">        x = <span class="variable language_">self</span>.attention(Q, K, V, mask)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‹¼æ¥å¤šä¸ªå¤´</span></span><br><span class="line">        x = x.transpose(<span class="number">1</span>, <span class="number">2</span>).contiguous().view(batch_size, -<span class="number">1</span>, <span class="variable language_">self</span>.d_model)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.W_o(x)</span><br></pre></td></tr></table></figure>

<h2 id="å®Œæ•´è®­ç»ƒæµç¨‹ç¤ºä¾‹"><a href="#å®Œæ•´è®­ç»ƒæµç¨‹ç¤ºä¾‹" class="headerlink" title="å®Œæ•´è®­ç»ƒæµç¨‹ç¤ºä¾‹"></a>å®Œæ•´è®­ç»ƒæµç¨‹ç¤ºä¾‹</h2><h3 id="MNISTæ‰‹å†™æ•°å­—è¯†åˆ«"><a href="#MNISTæ‰‹å†™æ•°å­—è¯†åˆ«" class="headerlink" title="MNISTæ‰‹å†™æ•°å­—è¯†åˆ«"></a>MNISTæ‰‹å†™æ•°å­—è¯†åˆ«</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æ•°æ®å‡†å¤‡</span></span><br><span class="line">transform = transforms.Compose([</span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">    transforms.Normalize((<span class="number">0.1307</span>,), (<span class="number">0.3081</span>,))</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">train_dataset = datasets.MNIST(<span class="string">&#x27;./data&#x27;</span>, train=<span class="literal">True</span>,</span><br><span class="line">                                download=<span class="literal">True</span>, transform=transform)</span><br><span class="line">test_dataset = datasets.MNIST(<span class="string">&#x27;./data&#x27;</span>, train=<span class="literal">False</span>,</span><br><span class="line">                               transform=transform)</span><br><span class="line"></span><br><span class="line">train_loader = DataLoader(train_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line">test_loader = DataLoader(test_dataset, batch_size=<span class="number">1000</span>, shuffle=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å®šä¹‰æ¨¡å‹</span></span><br><span class="line">model = CNN(num_classes=<span class="number">10</span>)</span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">model.to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span></span><br><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">optimizer = optim.Adam(model.parameters(), lr=<span class="number">0.001</span>)</span><br><span class="line">scheduler = optim.lr_scheduler.ReduceLROnPlateau(</span><br><span class="line">    optimizer, mode=<span class="string">&#x27;min&#x27;</span>, factor=<span class="number">0.5</span>, patience=<span class="number">3</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. è®­ç»ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">epoch</span>):</span><br><span class="line">    model.train()</span><br><span class="line">    train_loss = <span class="number">0</span></span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> batch_idx, (data, target) <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_loader):</span><br><span class="line">        data, target = data.to(device), target.to(device)</span><br><span class="line"></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        output = model(data)</span><br><span class="line">        loss = criterion(output, target)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        train_loss += loss.item()</span><br><span class="line">        pred = output.argmax(dim=<span class="number">1</span>, keepdim=<span class="literal">True</span>)</span><br><span class="line">        correct += pred.eq(target.view_as(pred)).<span class="built_in">sum</span>().item()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> batch_idx % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Train Epoch: <span class="subst">&#123;epoch&#125;</span> [<span class="subst">&#123;batch_idx * <span class="built_in">len</span>(data)&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(train_loader.dataset)&#125;</span> &#x27;</span></span><br><span class="line">                  <span class="string">f&#x27;(<span class="subst">&#123;<span class="number">100.</span> * batch_idx / <span class="built_in">len</span>(train_loader):<span class="number">.0</span>f&#125;</span>%)]\tLoss: <span class="subst">&#123;loss.item():<span class="number">.6</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    train_loss /= <span class="built_in">len</span>(train_loader)</span><br><span class="line">    accuracy = <span class="number">100.</span> * correct / <span class="built_in">len</span>(train_loader.dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\nTrain set: Average loss: <span class="subst">&#123;train_loss:<span class="number">.4</span>f&#125;</span>, Accuracy: <span class="subst">&#123;correct&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(train_loader.dataset)&#125;</span> (<span class="subst">&#123;accuracy:<span class="number">.2</span>f&#125;</span>%)\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> train_loss</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. æµ‹è¯•å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    test_loss = <span class="number">0</span></span><br><span class="line">    correct = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> data, target <span class="keyword">in</span> test_loader:</span><br><span class="line">            data, target = data.to(device), target.to(device)</span><br><span class="line">            output = model(data)</span><br><span class="line">            test_loss += criterion(output, target).item()</span><br><span class="line">            pred = output.argmax(dim=<span class="number">1</span>, keepdim=<span class="literal">True</span>)</span><br><span class="line">            correct += pred.eq(target.view_as(pred)).<span class="built_in">sum</span>().item()</span><br><span class="line"></span><br><span class="line">    test_loss /= <span class="built_in">len</span>(test_loader)</span><br><span class="line">    accuracy = <span class="number">100.</span> * correct / <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Test set: Average loss: <span class="subst">&#123;test_loss:<span class="number">.4</span>f&#125;</span>, Accuracy: <span class="subst">&#123;correct&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(test_loader.dataset)&#125;</span> (<span class="subst">&#123;accuracy:<span class="number">.2</span>f&#125;</span>%)\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> test_loss</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. è®­ç»ƒå¾ªç¯</span></span><br><span class="line">best_loss = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    train_loss = train(epoch)</span><br><span class="line">    test_loss = test()</span><br><span class="line"></span><br><span class="line">    scheduler.step(test_loss)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜æœ€ä½³æ¨¡å‹</span></span><br><span class="line">    <span class="keyword">if</span> test_loss &lt; best_loss:</span><br><span class="line">        best_loss = test_loss</span><br><span class="line">        torch.save(model.state_dict(), <span class="string">&#x27;best_model.pth&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Saved best model with loss: <span class="subst">&#123;best_loss:<span class="number">.4</span>f&#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Training completed! Best test loss: <span class="subst">&#123;best_loss:<span class="number">.4</span>f&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸ç”¨æŠ€å·§"><a href="#å¸¸ç”¨æŠ€å·§" class="headerlink" title="å¸¸ç”¨æŠ€å·§"></a>å¸¸ç”¨æŠ€å·§</h2><h3 id="1-æ•°æ®å¢å¼º"><a href="#1-æ•°æ®å¢å¼º" class="headerlink" title="1. æ•°æ®å¢å¼º"></a>1. æ•°æ®å¢å¼º</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line">train_transform = transforms.Compose([</span><br><span class="line">    transforms.RandomHorizontalFlip(),</span><br><span class="line">    transforms.RandomRotation(<span class="number">10</span>),</span><br><span class="line">    transforms.ColorJitter(brightness=<span class="number">0.2</span>, contrast=<span class="number">0.2</span>),</span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">    transforms.Normalize(mean=[<span class="number">0.485</span>, <span class="number">0.456</span>, <span class="number">0.406</span>],</span><br><span class="line">                        std=[<span class="number">0.229</span>, <span class="number">0.224</span>, <span class="number">0.225</span>])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<h3 id="2-å­¦ä¹ ç‡è°ƒåº¦"><a href="#2-å­¦ä¹ ç‡è°ƒåº¦" class="headerlink" title="2. å­¦ä¹ ç‡è°ƒåº¦"></a>2. å­¦ä¹ ç‡è°ƒåº¦</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½™å¼¦é€€ç«</span></span><br><span class="line">scheduler = optim.lr_scheduler.CosineAnnealingLR(</span><br><span class="line">    optimizer, T_max=<span class="number">50</span>, eta_min=<span class="number">1e-6</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒ</span></span><br><span class="line">scheduler = optim.lr_scheduler.CyclicLR(</span><br><span class="line">    optimizer, base_lr=<span class="number">1e-5</span>, max_lr=<span class="number">1e-3</span>,</span><br><span class="line">    cycle_momentum=<span class="literal">False</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="3-æ—©åœæ³•"><a href="#3-æ—©åœæ³•" class="headerlink" title="3. æ—©åœæ³•"></a>3. æ—©åœæ³•</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EarlyStopping</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, patience=<span class="number">7</span>, min_delta=<span class="number">0</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.patience = patience</span><br><span class="line">        <span class="variable language_">self</span>.min_delta = min_delta</span><br><span class="line">        <span class="variable language_">self</span>.counter = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.best_loss = <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>.early_stop = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, val_loss</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.best_loss <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="variable language_">self</span>.best_loss = val_loss</span><br><span class="line">        <span class="keyword">elif</span> val_loss &gt; <span class="variable language_">self</span>.best_loss - <span class="variable language_">self</span>.min_delta:</span><br><span class="line">            <span class="variable language_">self</span>.counter += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.counter &gt;= <span class="variable language_">self</span>.patience:</span><br><span class="line">                <span class="variable language_">self</span>.early_stop = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="variable language_">self</span>.best_loss = val_loss</span><br><span class="line">            <span class="variable language_">self</span>.counter = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h2 id="è¿ç§»å­¦ä¹ å®æˆ˜"><a href="#è¿ç§»å­¦ä¹ å®æˆ˜" class="headerlink" title="è¿ç§»å­¦ä¹ å®æˆ˜"></a>è¿ç§»å­¦ä¹ å®æˆ˜</h2><p>ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹åŠ é€Ÿè®­ç»ƒï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision.models <span class="keyword">as</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½é¢„è®­ç»ƒResNet</span></span><br><span class="line">resnet = models.resnet50(pretrained=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†»ç»“æ‰€æœ‰å±‚</span></span><br><span class="line"><span class="keyword">for</span> param <span class="keyword">in</span> resnet.parameters():</span><br><span class="line">    param.requires_grad = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›¿æ¢æœ€åçš„åˆ†ç±»å±‚</span></span><br><span class="line">num_features = resnet.fc.in_features</span><br><span class="line">resnet.fc = nn.Linear(num_features, <span class="number">10</span>)  <span class="comment"># 10ä¸ªç±»åˆ«</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åªè®­ç»ƒæœ€åä¸€å±‚</span></span><br><span class="line">optimizer = optim.SGD(resnet.fc.parameters(), lr=<span class="number">0.01</span>, momentum=<span class="number">0.9</span>)</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ·±åº¦å­¦ä¹ æ˜¯ä¸€ä¸ªå¿«é€Ÿå‘å±•çš„é¢†åŸŸï¼ŒæŒæ¡åŸºç¡€çŸ¥è¯†åï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¢ç´¢ï¼š</p>
<ul>
<li><strong>è®¡ç®—æœºè§†è§‰</strong>: ç›®æ ‡æ£€æµ‹ã€å›¾åƒåˆ†å‰²ã€é£æ ¼è¿ç§»</li>
<li><strong>è‡ªç„¶è¯­è¨€å¤„ç†</strong>: GPTã€BERTã€æœºå™¨ç¿»è¯‘</li>
<li><strong>ç”Ÿæˆæ¨¡å‹</strong>: GANã€VAEã€Diffusion Models</li>
<li><strong>å¼ºåŒ–å­¦ä¹ </strong>: æ¸¸æˆAIã€æœºå™¨äººæ§åˆ¶</li>
</ul>
<p><strong>å­¦ä¹ èµ„æºï¼š</strong></p>
<ul>
<li>fast.ai - å®ç”¨æ·±åº¦å­¦ä¹ è¯¾ç¨‹</li>
<li>Stanford CS231n - è®¡ç®—æœºè§†è§‰</li>
<li>Stanford CS224n - è‡ªç„¶è¯­è¨€å¤„ç†</li>
</ul>
<p>æŒç»­å­¦ä¹ å’Œå®è·µæ˜¯æŒæ¡æ·±åº¦å­¦ä¹ çš„å…³é”®ï¼</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†ä»‹ç»AIçš„å®é™…åº”ç”¨åœºæ™¯å’Œé¡¹ç›®æ¡ˆä¾‹ï¼Œæ•¬è¯·å…³æ³¨ï¼</em></p>
]]></content>
      <categories>
        <category>å…¨æ ˆ</category>
        <category>AI</category>
      </categories>
      <tags>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>ç¥ç»ç½‘ç»œ</tag>
        <tag>PyTorch</tag>
        <tag>è®¡ç®—æœºè§†è§‰</tag>
      </tags>
  </entry>
  <entry>
    <title>GitHubå¸¸ç”¨å‘½ä»¤å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç²¾é€š</title>
    <url>/2026/01/20/github-commands-guide/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Gitæ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œè€ŒGitHubæ˜¯åŸºäºGitçš„ä»£ç æ‰˜ç®¡å¹³å°ã€‚æŒæ¡Gitå’ŒGitHubçš„å¸¸ç”¨å‘½ä»¤æ˜¯æ¯ä¸ªå¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ã€‚</p>
<p>æœ¬æ–‡å°†ä»åŸºç¡€åˆ°é«˜çº§ï¼Œå…¨é¢ä»‹ç»Gitå’ŒGitHubçš„å¸¸ç”¨å‘½ä»¤åŠå®æˆ˜æŠ€å·§ã€‚</p>
<h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><h3 id="å®‰è£…Git"><a href="#å®‰è£…Git" class="headerlink" title="å®‰è£…Git"></a>å®‰è£…Git</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># macOS</span></span><br><span class="line">brew install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows</span></span><br><span class="line"><span class="comment"># ä¸‹è½½å®‰è£…åŒ…ï¼šhttps://git-scm.com/download/win</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Linux (Ubuntu/Debian)</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯å®‰è£…</span></span><br><span class="line">git --version</span><br></pre></td></tr></table></figure>

<h3 id="åˆå§‹é…ç½®"><a href="#åˆå§‹é…ç½®" class="headerlink" title="åˆå§‹é…ç½®"></a>åˆå§‹é…ç½®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ç”¨æˆ·å</span></span><br><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é‚®ç®±</span></span><br><span class="line">git config --global user.email <span class="string">&quot;your.email@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é»˜è®¤åˆ†æ”¯å</span></span><br><span class="line">git config --global init.defaultBranch main</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é…ç½®</span></span><br><span class="line">git config --list</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ç¼–è¾‘å™¨</span></span><br><span class="line">git config --global core.editor vim</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å·®å¼‚æ¯”è¾ƒå·¥å…·</span></span><br><span class="line">git config --global merge.tool vscode</span><br></pre></td></tr></table></figure>

<h2 id="åŸºç¡€å‘½ä»¤"><a href="#åŸºç¡€å‘½ä»¤" class="headerlink" title="åŸºç¡€å‘½ä»¤"></a>åŸºç¡€å‘½ä»¤</h2><h3 id="ä»“åº“åˆå§‹åŒ–"><a href="#ä»“åº“åˆå§‹åŒ–" class="headerlink" title="ä»“åº“åˆå§‹åŒ–"></a>ä»“åº“åˆå§‹åŒ–</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–æ–°ä»“åº“</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…‹éš†è¿œç¨‹ä»“åº“</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/username/repo.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…‹éš†åˆ°æŒ‡å®šç›®å½•</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/username/repo.git my-folder</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…‹éš†æŒ‡å®šåˆ†æ”¯</span></span><br><span class="line">git <span class="built_in">clone</span> -b dev https://github.com/username/repo.git</span><br></pre></td></tr></table></figure>

<h3 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰çŠ¶æ€</span></span><br><span class="line">git status</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git add file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬æœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼‰</span></span><br><span class="line">git add -u</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬åˆ é™¤çš„æ–‡ä»¶ï¼‰</span></span><br><span class="line">git add -A</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’¤é”€æš‚å­˜åŒºçš„æ–‡ä»¶</span></span><br><span class="line">git restore --staged file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸¢å¼ƒå·¥ä½œåŒºçš„ä¿®æ”¹</span></span><br><span class="line">git restore file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æ–‡ä»¶</span></span><br><span class="line">git <span class="built_in">rm</span> file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½åæ–‡ä»¶</span></span><br><span class="line">git <span class="built_in">mv</span> old.txt new.txt</span><br></pre></td></tr></table></figure>

<h3 id="æäº¤æ›´æ”¹"><a href="#æäº¤æ›´æ”¹" class="headerlink" title="æäº¤æ›´æ”¹"></a>æäº¤æ›´æ”¹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æäº¤æš‚å­˜åŒºçš„æ›´æ”¹</span></span><br><span class="line">git commit -m <span class="string">&quot;commit message&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å¹¶æäº¤ï¼ˆè·³è¿‡git addï¼‰</span></span><br><span class="line">git commit -am <span class="string">&quot;commit message&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤</span></span><br><span class="line">git commit --amend</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤ä¿¡æ¯</span></span><br><span class="line">git commit --amend -m <span class="string">&quot;new message&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤æ—¶è·³è¿‡é’©å­</span></span><br><span class="line">git commit --no-verify -m <span class="string">&quot;message&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹å·®å¼‚"><a href="#æŸ¥çœ‹å·®å¼‚" class="headerlink" title="æŸ¥çœ‹å·®å¼‚"></a>æŸ¥çœ‹å·®å¼‚</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„å·®å¼‚</span></span><br><span class="line">git diff</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æš‚å­˜åŒºå’Œä¸Šæ¬¡æäº¤çš„å·®å¼‚</span></span><br><span class="line">git diff --staged</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·¥ä½œåŒºå’Œä¸Šæ¬¡æäº¤çš„å·®å¼‚</span></span><br><span class="line">git diff HEAD</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä¸¤ä¸ªæäº¤ä¹‹é—´çš„å·®å¼‚</span></span><br><span class="line">git diff commit1 commit2</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„å·®å¼‚</span></span><br><span class="line">git diff file.txt</span><br></pre></td></tr></table></figure>

<h2 id="åˆ†æ”¯ç®¡ç†"><a href="#åˆ†æ”¯ç®¡ç†" class="headerlink" title="åˆ†æ”¯ç®¡ç†"></a>åˆ†æ”¯ç®¡ç†</h2><h3 id="åˆ†æ”¯æ“ä½œ"><a href="#åˆ†æ”¯æ“ä½œ" class="headerlink" title="åˆ†æ”¯æ“ä½œ"></a>åˆ†æ”¯æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line">git branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch -r</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆåŒ…æ‹¬è¿œç¨‹ï¼‰</span></span><br><span class="line">git branch -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°åˆ†æ”¯</span></span><br><span class="line">git branch feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ†æ”¯</span></span><br><span class="line">git checkout feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</span></span><br><span class="line">git checkout -b feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯</span></span><br><span class="line">git checkout -</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git branch -d feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶åˆ é™¤åˆ†æ”¯</span></span><br><span class="line">git branch -D feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½ååˆ†æ”¯</span></span><br><span class="line">git branch -m old-branch new-branch</span><br></pre></td></tr></table></figure>

<h3 id="åˆ†æ”¯åˆå¹¶"><a href="#åˆ†æ”¯åˆå¹¶" class="headerlink" title="åˆ†æ”¯åˆå¹¶"></a>åˆ†æ”¯åˆå¹¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line">git merge feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¦ç”¨å¿«è¿›åˆå¹¶</span></span><br><span class="line">git merge --no-ff feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨squashåˆå¹¶ï¼ˆåˆå¹¶ä¸ºä¸€ä¸ªæäº¤ï¼‰</span></span><br><span class="line">git merge --squash feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># å˜åŸºï¼ˆå°†å½“å‰åˆ†æ”¯å˜åŸºåˆ°æŒ‡å®šåˆ†æ”¯ï¼‰</span></span><br><span class="line">git rebase main</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»§ç»­å˜åŸº</span></span><br><span class="line">git rebase --<span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·³è¿‡å½“å‰æäº¤</span></span><br><span class="line">git rebase --skip</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¾å¼ƒå˜åŸº</span></span><br><span class="line">git rebase --abort</span><br></pre></td></tr></table></figure>

<h3 id="åˆ†æ”¯æœ€ä½³å®è·µ"><a href="#åˆ†æ”¯æœ€ä½³å®è·µ" class="headerlink" title="åˆ†æ”¯æœ€ä½³å®è·µ"></a>åˆ†æ”¯æœ€ä½³å®è·µ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸»åˆ†æ”¯ç»“æ„:</span><br><span class="line">â”œâ”€â”€ main (ç”Ÿäº§ç¯å¢ƒ)</span><br><span class="line">â”‚   â””â”€â”€ å§‹ç»ˆä¿æŒç¨³å®šï¼Œå¯éƒ¨ç½²</span><br><span class="line">â”œâ”€â”€ develop (å¼€å‘ç¯å¢ƒ)</span><br><span class="line">â”‚   â””â”€â”€ å¼€å‘é›†æˆåˆ†æ”¯</span><br><span class="line">â””â”€â”€ feature/* (åŠŸèƒ½åˆ†æ”¯)</span><br><span class="line">    â”œâ”€â”€ feature/user-auth</span><br><span class="line">    â”œâ”€â”€ feature-payment</span><br><span class="line">    â””â”€â”€ feature-search</span><br></pre></td></tr></table></figure>

<h2 id="è¿œç¨‹æ“ä½œ"><a href="#è¿œç¨‹æ“ä½œ" class="headerlink" title="è¿œç¨‹æ“ä½œ"></a>è¿œç¨‹æ“ä½œ</h2><h3 id="è¿œç¨‹ä»“åº“ç®¡ç†"><a href="#è¿œç¨‹ä»“åº“ç®¡ç†" class="headerlink" title="è¿œç¨‹ä»“åº“ç®¡ç†"></a>è¿œç¨‹ä»“åº“ç®¡ç†</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote add origin https://github.com/username/repo.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹ä»“åº“</span></span><br><span class="line">git remote remove origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è¿œç¨‹ä»“åº“URL</span></span><br><span class="line">git remote set-url origin https://github.com/username/new-repo.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯</span></span><br><span class="line">git remote show origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½åè¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git remote rename origin upstream</span><br></pre></td></tr></table></figure>

<h3 id="æ‹‰å–å’Œæ¨é€"><a href="#æ‹‰å–å’Œæ¨é€" class="headerlink" title="æ‹‰å–å’Œæ¨é€"></a>æ‹‰å–å’Œæ¨é€</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‹‰å–è¿œç¨‹æ›´æ”¹å¹¶åˆå¹¶</span></span><br><span class="line">git pull origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹‰å–è¿œç¨‹æ›´æ”¹ä½†ä¸åˆå¹¶</span></span><br><span class="line">git fetch origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹‰å–æ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git fetch --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹‰å–è¿œç¨‹æ›´æ”¹å¹¶å˜åŸº</span></span><br><span class="line">git pull --rebase origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line">git push origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line">git push --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ ‡ç­¾</span></span><br><span class="line">git push --tags</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€å¹¶å»ºç«‹ä¸Šæ¸¸åˆ†æ”¯</span></span><br><span class="line">git push -u origin feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶æ¨é€ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰</span></span><br><span class="line">git push --force origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶æ¨é€æ›´å®‰å…¨çš„æ–¹å¼</span></span><br><span class="line">git push --force-with-lease origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git push origin --delete feature-branch</span><br></pre></td></tr></table></figure>

<h2 id="æ—¥å¿—å’ŒæŸ¥çœ‹"><a href="#æ—¥å¿—å’ŒæŸ¥çœ‹" class="headerlink" title="æ—¥å¿—å’ŒæŸ¥çœ‹"></a>æ—¥å¿—å’ŒæŸ¥çœ‹</h2><h3 id="æŸ¥çœ‹æäº¤å†å²"><a href="#æŸ¥çœ‹æäº¤å†å²" class="headerlink" title="æŸ¥çœ‹æäº¤å†å²"></a>æŸ¥çœ‹æäº¤å†å²</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æäº¤å†å²</span></span><br><span class="line">git <span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç®€æ´çš„æäº¤å†å²</span></span><br><span class="line">git <span class="built_in">log</span> --oneline</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†æ”¯å›¾</span></span><br><span class="line">git <span class="built_in">log</span> --graph --oneline --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœ€è¿‘Næ¬¡æäº¤</span></span><br><span class="line">git <span class="built_in">log</span> -n 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„æäº¤å†å²</span></span><br><span class="line">git <span class="built_in">log</span> file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æäº¤ç»Ÿè®¡</span></span><br><span class="line">git <span class="built_in">log</span> --<span class="built_in">stat</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¾åŒ–è¾“å‡º</span></span><br><span class="line">git <span class="built_in">log</span> --pretty=format:<span class="string">&quot;%h - %an, %ar : %s&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç‰¹å®šä½œè€…çš„æäº¤</span></span><br><span class="line">git <span class="built_in">log</span> --author=<span class="string">&quot;John&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#æŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æŒ‡å®šæäº¤çš„æ–‡ä»¶å†…å®¹</span></span><br><span class="line">git show commit_hash:file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æäº¤è¯¦æƒ…</span></span><br><span class="line">git show commit_hash</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŸæ¬¡æäº¤çš„ä¿®æ”¹</span></span><br><span class="line">git show HEAD~1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶çš„æ¯ä¸€è¡Œæ˜¯è°ä¿®æ”¹çš„</span></span><br><span class="line">git blame file.txt</span><br></pre></td></tr></table></figure>

<h2 id="æ’¤é”€æ“ä½œ"><a href="#æ’¤é”€æ“ä½œ" class="headerlink" title="æ’¤é”€æ“ä½œ"></a>æ’¤é”€æ“ä½œ</h2><h3 id="æ’¤é”€æ›´æ”¹"><a href="#æ’¤é”€æ›´æ”¹" class="headerlink" title="æ’¤é”€æ›´æ”¹"></a>æ’¤é”€æ›´æ”¹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ’¤é”€å·¥ä½œåŒºçš„ä¿®æ”¹</span></span><br><span class="line">git restore file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’¤é”€æš‚å­˜åŒºçš„ä¿®æ”¹</span></span><br><span class="line">git restore --staged file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›é€€åˆ°æŒ‡å®šæäº¤ï¼ˆä¿ç•™å·¥ä½œåŒºä¿®æ”¹ï¼‰</span></span><br><span class="line">git reset --soft HEAD~1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›é€€åˆ°æŒ‡å®šæäº¤ï¼ˆæ’¤é”€æš‚å­˜åŒºä¿®æ”¹ï¼‰</span></span><br><span class="line">git reset --mixed HEAD~1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›é€€åˆ°æŒ‡å®šæäº¤ï¼ˆæ’¤é”€å·¥ä½œåŒºå’Œæš‚å­˜åŒºä¿®æ”¹ï¼‰</span></span><br><span class="line">git reset --hard HEAD~1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›é€€åˆ°æŒ‡å®šæäº¤ï¼ˆå±é™©æ“ä½œï¼‰</span></span><br><span class="line">git reset --hard commit_hash</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤æŒ‡å®šæäº¤çš„æ–‡ä»¶</span></span><br><span class="line">git checkout commit_hash -- file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°çš„æäº¤æ¥æ’¤é”€æŒ‡å®šæäº¤</span></span><br><span class="line">git revert commit_hash</span><br></pre></td></tr></table></figure>

<h3 id="reset-vs-revert"><a href="#reset-vs-revert" class="headerlink" title="reset vs revert"></a>reset vs revert</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># reset - åˆ é™¤å†å²ï¼ˆé€‚ç”¨äºæœ¬åœ°ï¼‰</span></span><br><span class="line">git reset --hard HEAD~1</span><br><span class="line"></span><br><span class="line"><span class="comment"># revert - åˆ›å»ºæ–°æäº¤æ¥æ’¤é”€ï¼ˆé€‚ç”¨äºå…¬å…±åˆ†æ”¯ï¼‰</span></span><br><span class="line">git revert HEAD</span><br></pre></td></tr></table></figure>

<h2 id="æ ‡ç­¾ç®¡ç†"><a href="#æ ‡ç­¾ç®¡ç†" class="headerlink" title="æ ‡ç­¾ç®¡ç†"></a>æ ‡ç­¾ç®¡ç†</h2><h3 id="æ ‡ç­¾æ“ä½œ"><a href="#æ ‡ç­¾æ“ä½œ" class="headerlink" title="æ ‡ç­¾æ“ä½œ"></a>æ ‡ç­¾æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">git tag</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºè½»é‡æ ‡ç­¾</span></span><br><span class="line">git tag v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé™„æ³¨æ ‡ç­¾</span></span><br><span class="line">git tag -a v1.0.0 -m <span class="string">&quot;Version 1.0.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™æŒ‡å®šæäº¤æ‰“æ ‡ç­¾</span></span><br><span class="line">git tag -a v0.9.0 commit_hash -m <span class="string">&quot;Version 0.9.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ ‡ç­¾ä¿¡æ¯</span></span><br><span class="line">git show v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æœ¬åœ°æ ‡ç­¾</span></span><br><span class="line">git tag -d v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹</span></span><br><span class="line">git push origin v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">git push origin --tags</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹æ ‡ç­¾</span></span><br><span class="line">git push origin --delete v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€å‡ºæ ‡ç­¾</span></span><br><span class="line">git checkout v1.0.0</span><br></pre></td></tr></table></figure>

<h2 id="å‚¨è—ï¼ˆStashï¼‰"><a href="#å‚¨è—ï¼ˆStashï¼‰" class="headerlink" title="å‚¨è—ï¼ˆStashï¼‰"></a>å‚¨è—ï¼ˆStashï¼‰</h2><h3 id="ä¸´æ—¶ä¿å­˜å·¥ä½œ"><a href="#ä¸´æ—¶ä¿å­˜å·¥ä½œ" class="headerlink" title="ä¸´æ—¶ä¿å­˜å·¥ä½œ"></a>ä¸´æ—¶ä¿å­˜å·¥ä½œ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å‚¨è—å½“å‰å·¥ä½œ</span></span><br><span class="line">git stash</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚¨è—å¹¶æ·»åŠ è¯´æ˜</span></span><br><span class="line">git stash save <span class="string">&quot;work in progress&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å‚¨è—åˆ—è¡¨</span></span><br><span class="line">git stash list</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨æœ€æ–°çš„å‚¨è—</span></span><br><span class="line">git stash pop</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨æŒ‡å®šå‚¨è—</span></span><br><span class="line">git stash apply stash@&#123;1&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å‚¨è—</span></span><br><span class="line">git stash drop stash@&#123;0&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç©ºæ‰€æœ‰å‚¨è—</span></span><br><span class="line">git stash clear</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å‚¨è—å†…å®¹</span></span><br><span class="line">git stash show -p</span><br></pre></td></tr></table></figure>

<h2 id="å®æˆ˜åœºæ™¯"><a href="#å®æˆ˜åœºæ™¯" class="headerlink" title="å®æˆ˜åœºæ™¯"></a>å®æˆ˜åœºæ™¯</h2><h3 id="åœºæ™¯1ï¼šå¼€å§‹æ–°åŠŸèƒ½å¼€å‘"><a href="#åœºæ™¯1ï¼šå¼€å§‹æ–°åŠŸèƒ½å¼€å‘" class="headerlink" title="åœºæ™¯1ï¼šå¼€å§‹æ–°åŠŸèƒ½å¼€å‘"></a>åœºæ™¯1ï¼šå¼€å§‹æ–°åŠŸèƒ½å¼€å‘</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯å¹¶æ›´æ–°</span></span><br><span class="line">git checkout main</span><br><span class="line">git pull origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯</span></span><br><span class="line">git checkout -b feature/new-feature</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¼€å‘å¹¶æäº¤</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;feat: add new feature&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æ¨é€åˆ°è¿œç¨‹</span></span><br><span class="line">git push -u origin feature/new-feature</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. åˆ›å»ºPull Request</span></span><br><span class="line"><span class="comment"># åœ¨GitHubç½‘é¡µä¸Šæ“ä½œ</span></span><br></pre></td></tr></table></figure>

<h3 id="åœºæ™¯2ï¼šè§£å†³åˆå¹¶å†²çª"><a href="#åœºæ™¯2ï¼šè§£å†³åˆå¹¶å†²çª" class="headerlink" title="åœºæ™¯2ï¼šè§£å†³åˆå¹¶å†²çª"></a>åœºæ™¯2ï¼šè§£å†³åˆå¹¶å†²çª</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. æ‹‰å–æœ€æ–°ä»£ç </span></span><br><span class="line">git checkout main</span><br><span class="line">git pull origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åˆå¹¶åŠŸèƒ½åˆ†æ”¯</span></span><br><span class="line">git merge feature/new-feature</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¦‚æœæœ‰å†²çªï¼Œæ ‡è®°å†²çªæ–‡ä»¶</span></span><br><span class="line"><span class="comment"># Auto-merging file.txt</span></span><br><span class="line"><span class="comment"># CONFLICT (content): Merge conflict in file.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æ‰‹åŠ¨è§£å†³å†²çª</span></span><br><span class="line"><span class="comment"># ç¼–è¾‘æ–‡ä»¶ï¼Œåˆ é™¤å†²çªæ ‡è®°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. æ·»åŠ è§£å†³åçš„æ–‡ä»¶</span></span><br><span class="line">git add file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. å®Œæˆåˆå¹¶</span></span><br><span class="line">git commit -m <span class="string">&quot;merge: resolve merge conflicts&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="åœºæ™¯3ï¼šä¿®æ”¹å†å²æäº¤"><a href="#åœºæ™¯3ï¼šä¿®æ”¹å†å²æäº¤" class="headerlink" title="åœºæ™¯3ï¼šä¿®æ”¹å†å²æäº¤"></a>åœºæ™¯3ï¼šä¿®æ”¹å†å²æäº¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># äº¤äº’å¼å˜åŸºä¿®æ”¹æœ€è¿‘çš„3æ¬¡æäº¤</span></span><br><span class="line">git rebase -i HEAD~3</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­ï¼š</span></span><br><span class="line"><span class="comment"># pick -&gt; reword = ä¿®æ”¹æäº¤ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># pick -&gt; edit = ä¿®æ”¹æäº¤å†…å®¹</span></span><br><span class="line"><span class="comment"># pick -&gt; drop = åˆ é™¤æäº¤</span></span><br><span class="line"><span class="comment"># pick -&gt; squash = åˆå¹¶åˆ°å‰ä¸€ä¸ªæäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜åæŒ‰æç¤ºæ“ä½œ</span></span><br></pre></td></tr></table></figure>

<h3 id="åœºæ™¯4ï¼šå›æ»šé”™è¯¯çš„æäº¤"><a href="#åœºæ™¯4ï¼šå›æ»šé”™è¯¯çš„æäº¤" class="headerlink" title="åœºæ™¯4ï¼šå›æ»šé”™è¯¯çš„æäº¤"></a>åœºæ™¯4ï¼šå›æ»šé”™è¯¯çš„æäº¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–¹æ³•1ï¼šrevertï¼ˆæ¨èï¼‰</span></span><br><span class="line">git revert bad_commit_hash</span><br><span class="line">git push</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2ï¼šresetï¼ˆä»…æœ¬åœ°æˆ–å›¢é˜Ÿåä½œï¼‰</span></span><br><span class="line">git reset --hard good_commit_hash</span><br><span class="line">git push --force-with-lease</span><br></pre></td></tr></table></figure>

<h3 id="åœºæ™¯5ï¼šåŒæ­¥ä¸Šæ¸¸ä»“åº“"><a href="#åœºæ™¯5ï¼šåŒæ­¥ä¸Šæ¸¸ä»“åº“" class="headerlink" title="åœºæ™¯5ï¼šåŒæ­¥ä¸Šæ¸¸ä»“åº“"></a>åœºæ™¯5ï¼šåŒæ­¥ä¸Šæ¸¸ä»“åº“</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. æ·»åŠ ä¸Šæ¸¸ä»“åº“</span></span><br><span class="line">git remote add upstream https://github.com/original/repo.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ‹‰å–ä¸Šæ¸¸æ›´æ”¹</span></span><br><span class="line">git fetch upstream</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. åˆå¹¶ä¸Šæ¸¸ä¸»åˆ†æ”¯</span></span><br><span class="line">git checkout main</span><br><span class="line">git merge upstream/main</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æ¨é€åˆ°ä½ çš„ä»“åº“</span></span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure>

<h2 id="GitHubç‰¹å®šæ“ä½œ"><a href="#GitHubç‰¹å®šæ“ä½œ" class="headerlink" title="GitHubç‰¹å®šæ“ä½œ"></a>GitHubç‰¹å®šæ“ä½œ</h2><h3 id="GitHub-CLI-gh"><a href="#GitHub-CLI-gh" class="headerlink" title="GitHub CLI (gh)"></a>GitHub CLI (gh)</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…GitHub CLI</span></span><br><span class="line">brew install gh  <span class="comment"># macOS</span></span><br><span class="line"><span class="comment"># æˆ–ä» https://cli.github.com/ ä¸‹è½½</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¤è¯</span></span><br><span class="line">gh auth login</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä»“åº“</span></span><br><span class="line">gh repo create my-repo --public</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…‹éš†ä»“åº“</span></span><br><span class="line">gh repo <span class="built_in">clone</span> username/repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºPull Request</span></span><br><span class="line">gh <span class="built_in">pr</span> create --title <span class="string">&quot;Add feature&quot;</span> --body <span class="string">&quot;Description&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹PRåˆ—è¡¨</span></span><br><span class="line">gh <span class="built_in">pr</span> list</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶PR</span></span><br><span class="line">gh <span class="built_in">pr</span> merge 123</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºIssue</span></span><br><span class="line">gh issue create --title <span class="string">&quot;Bug&quot;</span> --body <span class="string">&quot;Description&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Issues</span></span><br><span class="line">gh issue list</span><br></pre></td></tr></table></figure>

<h3 id="gitignore-æœ€ä½³å®è·µ"><a href="#gitignore-æœ€ä½³å®è·µ" class="headerlink" title=".gitignore æœ€ä½³å®è·µ"></a>.gitignore æœ€ä½³å®è·µ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># .gitignore ç¤ºä¾‹</span><br><span class="line"></span><br><span class="line"># ä¾èµ–ç›®å½•</span><br><span class="line">node_modules/</span><br><span class="line">vendor/</span><br><span class="line"></span><br><span class="line"># æ„å»ºè¾“å‡º</span><br><span class="line">dist/</span><br><span class="line">build/</span><br><span class="line">public/</span><br><span class="line"></span><br><span class="line"># ç¯å¢ƒå˜é‡</span><br><span class="line">.env</span><br><span class="line">.env.local</span><br><span class="line"></span><br><span class="line"># IDEé…ç½®</span><br><span class="line">.vscode/</span><br><span class="line">.idea/</span><br><span class="line">*.swp</span><br><span class="line">*.swo</span><br><span class="line"></span><br><span class="line"># æ“ä½œç³»ç»Ÿæ–‡ä»¶</span><br><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line"></span><br><span class="line"># æ—¥å¿—æ–‡ä»¶</span><br><span class="line">*.log</span><br><span class="line">npm-debug.log*</span><br><span class="line"></span><br><span class="line"># ä¸´æ—¶æ–‡ä»¶</span><br><span class="line">*.tmp</span><br><span class="line">*.temp</span><br></pre></td></tr></table></figure>

<h3 id="Gitåˆ«åé…ç½®"><a href="#Gitåˆ«åé…ç½®" class="headerlink" title="Gitåˆ«åé…ç½®"></a>Gitåˆ«åé…ç½®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®å¸¸ç”¨åˆ«å</span></span><br><span class="line">git config --global alias.co checkout</span><br><span class="line">git config --global alias.br branch</span><br><span class="line">git config --global alias.ci commit</span><br><span class="line">git config --global alias.st status</span><br><span class="line">git config --global alias.unstage <span class="string">&#x27;reset HEAD --&#x27;</span></span><br><span class="line">git config --global alias.last <span class="string">&#x27;log -1 HEAD&#x27;</span></span><br><span class="line">git config --global alias.lg <span class="string">&quot;log --graph --oneline --all&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨åˆ«å</span></span><br><span class="line">git co main        <span class="comment"># git checkout main</span></span><br><span class="line">git br             <span class="comment"># git branch</span></span><br><span class="line">git ci -m <span class="string">&quot;msg&quot;</span>    <span class="comment"># git commit -m &quot;msg&quot;</span></span><br><span class="line">git st             <span class="comment"># git status</span></span><br><span class="line">git lg             <span class="comment"># ç¾åŒ–çš„æ—¥å¿—</span></span><br></pre></td></tr></table></figure>

<h2 id="é«˜çº§æŠ€å·§"><a href="#é«˜çº§æŠ€å·§" class="headerlink" title="é«˜çº§æŠ€å·§"></a>é«˜çº§æŠ€å·§</h2><h3 id="Cherry-pickï¼ˆç²¾é€‰æäº¤ï¼‰"><a href="#Cherry-pickï¼ˆç²¾é€‰æäº¤ï¼‰" class="headerlink" title="Cherry-pickï¼ˆç²¾é€‰æäº¤ï¼‰"></a>Cherry-pickï¼ˆç²¾é€‰æäº¤ï¼‰</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°†æŒ‡å®šæäº¤åº”ç”¨åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line">git cherry-pick commit_hash</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨ä½†ä¸è‡ªåŠ¨æäº¤</span></span><br><span class="line">git cherry-pick -n commit_hash</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨å¤šä¸ªæäº¤</span></span><br><span class="line">git cherry-pick commit1 commit2</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨ä¸€ç³»åˆ—æäº¤</span></span><br><span class="line">git cherry-pick commit1..commit2</span><br></pre></td></tr></table></figure>

<h3 id="Bisectï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰"><a href="#Bisectï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰" class="headerlink" title="Bisectï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰"></a>Bisectï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¼€å§‹äºŒåˆ†æŸ¥æ‰¾ï¼ˆç”¨äºå®šä½å¼•å…¥bugçš„æäº¤ï¼‰</span></span><br><span class="line">git bisect start</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡è®°å½“å‰ä¸ºåçš„æäº¤</span></span><br><span class="line">git bisect bad</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡è®°å·²çŸ¥çš„å¥½çš„æäº¤</span></span><br><span class="line">git bisect good commit_hash</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gitä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸­é—´æäº¤</span></span><br><span class="line"><span class="comment"># æµ‹è¯•åæ ‡è®°goodæˆ–bad</span></span><br><span class="line">git bisect good  <span class="comment"># æˆ– git bisect bad</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®Œæˆåå›åˆ°ä¸»åˆ†æ”¯</span></span><br><span class="line">git bisect reset</span><br></pre></td></tr></table></figure>

<h3 id="Worktreeï¼ˆå¤šå·¥ä½œæ ‘ï¼‰"><a href="#Worktreeï¼ˆå¤šå·¥ä½œæ ‘ï¼‰" class="headerlink" title="Worktreeï¼ˆå¤šå·¥ä½œæ ‘ï¼‰"></a>Worktreeï¼ˆå¤šå·¥ä½œæ ‘ï¼‰</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºå…³è”çš„å·¥ä½œæ ‘</span></span><br><span class="line">git worktree add ../feature-branch feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰å·¥ä½œæ ‘</span></span><br><span class="line">git worktree list</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å·¥ä½œæ ‘</span></span><br><span class="line">git worktree remove ../feature-branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç†å·¥ä½œæ ‘</span></span><br><span class="line">git worktree prune</span><br></pre></td></tr></table></figure>

<h2 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¸…ç†æ— æ•ˆæ–‡ä»¶</span></span><br><span class="line">git gc --prune=now</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç†æœªè·Ÿè¸ªçš„æ–‡ä»¶</span></span><br><span class="line">git clean -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç†æœªè·Ÿè¸ªçš„æ–‡ä»¶å’Œç›®å½•</span></span><br><span class="line">git clean -fd</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„è§ˆè¦åˆ é™¤çš„æ–‡ä»¶</span></span><br><span class="line">git clean -n</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä»“åº“å¤§å°</span></span><br><span class="line">git count-objects -vH</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æµ…å…‹éš†ï¼ˆåªä¸‹è½½æœ€æ–°å†å²ï¼‰</span></span><br><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/user/repo.git</span><br></pre></td></tr></table></figure>

<h2 id="å®‰å…¨æœ€ä½³å®è·µ"><a href="#å®‰å…¨æœ€ä½³å®è·µ" class="headerlink" title="å®‰å…¨æœ€ä½³å®è·µ"></a>å®‰å…¨æœ€ä½³å®è·µ</h2><h3 id="ä¿æŠ¤æ•æ„Ÿä¿¡æ¯"><a href="#ä¿æŠ¤æ•æ„Ÿä¿¡æ¯" class="headerlink" title="ä¿æŠ¤æ•æ„Ÿä¿¡æ¯"></a>ä¿æŠ¤æ•æ„Ÿä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. ä»å†å²ä¸­ç§»é™¤æ•æ„Ÿæ–‡ä»¶</span></span><br><span class="line">git filter-branch --force --index-filter \</span><br><span class="line">  <span class="string">&quot;git rm --cached --ignore-unmatch config/secrets.json&quot;</span> \</span><br><span class="line">  --prune-empty --tag-name-filter <span class="built_in">cat</span> -- --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. ä½¿ç”¨BFG Repo-Cleanerï¼ˆæ›´å¿«ï¼‰</span></span><br><span class="line">brew install bfg</span><br><span class="line">bfg --delete-files secrets.json</span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line">git gc --prune=now --aggressive</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ¨é€æ¸…ç†åçš„å†å²</span></span><br><span class="line">git push origin --force --all</span><br><span class="line">git push origin --force --tags</span><br></pre></td></tr></table></figure>

<h3 id="æäº¤ä¿¡æ¯è§„èŒƒ"><a href="#æäº¤ä¿¡æ¯è§„èŒƒ" class="headerlink" title="æäº¤ä¿¡æ¯è§„èŒƒ"></a>æäº¤ä¿¡æ¯è§„èŒƒ</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨çº¦å®šå¼æäº¤æ ¼å¼</span></span><br><span class="line">&lt;<span class="built_in">type</span>&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;footer&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç±»å‹ï¼ˆtypeï¼‰:</span></span><br><span class="line">feat:     æ–°åŠŸèƒ½</span><br><span class="line">fix:      ä¿®å¤bug</span><br><span class="line">docs:     æ–‡æ¡£æ›´æ–°</span><br><span class="line">style:    ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰</span><br><span class="line">refactor: é‡æ„</span><br><span class="line">perf:     æ€§èƒ½ä¼˜åŒ–</span><br><span class="line"><span class="built_in">test</span>:     æµ‹è¯•ç›¸å…³</span><br><span class="line">chore:    æ„å»º/å·¥å…·é“¾ç›¸å…³</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹:</span></span><br><span class="line">feat(auth): add user login feature</span><br><span class="line">fix(api): resolve <span class="built_in">timeout</span> issue</span><br><span class="line">docs(readme): update installation guide</span><br></pre></td></tr></table></figure>

<h2 id="è°ƒè¯•æŠ€å·§"><a href="#è°ƒè¯•æŠ€å·§" class="headerlink" title="è°ƒè¯•æŠ€å·§"></a>è°ƒè¯•æŠ€å·§</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹Gitå¼•ç”¨</span></span><br><span class="line">git show-ref</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹HEADæŒ‡å‘</span></span><br><span class="line">git <span class="built_in">log</span> --oneline -n 1 HEAD</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†æ”¯å…³ç³»</span></span><br><span class="line">git <span class="built_in">log</span> --graph --decorate --oneline</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœªè¢«è·Ÿè¸ªçš„æ–‡ä»¶</span></span><br><span class="line">git ls-files --others --exclude-standard</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾ä¸¢å¤±çš„æäº¤</span></span><br><span class="line">git fsck --lost-found</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤ä¸¢å¤±çš„æäº¤</span></span><br><span class="line">git reflog</span><br><span class="line">git checkout commit_hash</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸è§é—®é¢˜è§£å†³"><a href="#å¸¸è§é—®é¢˜è§£å†³" class="headerlink" title="å¸¸è§é—®é¢˜è§£å†³"></a>å¸¸è§é—®é¢˜è§£å†³</h2><h3 id="é—®é¢˜1ï¼šæäº¤äº†é”™è¯¯çš„æ–‡ä»¶"><a href="#é—®é¢˜1ï¼šæäº¤äº†é”™è¯¯çš„æ–‡ä»¶" class="headerlink" title="é—®é¢˜1ï¼šæäº¤äº†é”™è¯¯çš„æ–‡ä»¶"></a>é—®é¢˜1ï¼šæäº¤äº†é”™è¯¯çš„æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ’¤é”€æœ€åä¸€æ¬¡æäº¤ä½†ä¿ç•™æ›´æ”¹</span></span><br><span class="line">git reset --soft HEAD~1</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹åé‡æ–°æäº¤</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;correct message&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="é—®é¢˜2ï¼šå¿˜è®°æ¨é€åˆ°è¿œç¨‹"><a href="#é—®é¢˜2ï¼šå¿˜è®°æ¨é€åˆ°è¿œç¨‹" class="headerlink" title="é—®é¢˜2ï¼šå¿˜è®°æ¨é€åˆ°è¿œç¨‹"></a>é—®é¢˜2ï¼šå¿˜è®°æ¨é€åˆ°è¿œç¨‹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥æ¨é€</span></span><br><span class="line">git push origin main</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¢«åˆ«äººæ¨é€äº†æ–°çš„æäº¤</span></span><br><span class="line">git pull --rebase origin main</span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure>

<h3 id="é—®é¢˜3ï¼šåˆå¹¶ååæ‚”äº†"><a href="#é—®é¢˜3ï¼šåˆå¹¶ååæ‚”äº†" class="headerlink" title="é—®é¢˜3ï¼šåˆå¹¶ååæ‚”äº†"></a>é—®é¢˜3ï¼šåˆå¹¶ååæ‚”äº†</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å›åˆ°åˆå¹¶å‰</span></span><br><span class="line">git merge --abort</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨reflog</span></span><br><span class="line">git reflog</span><br><span class="line">git reset --hard HEAD@&#123;N&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Gitå’ŒGitHubæ˜¯ç°ä»£è½¯ä»¶å¼€å‘ä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚æŒæ¡è¿™äº›å‘½ä»¤ä¸ä»…èƒ½æé«˜å¼€å‘æ•ˆç‡ï¼Œè¿˜èƒ½æ›´å¥½åœ°ç®¡ç†ä»£ç ç‰ˆæœ¬å’Œåä½œå¼€å‘ã€‚</p>
<p><strong>å­¦ä¹ è·¯å¾„å»ºè®®ï¼š</strong></p>
<ol>
<li>ç†Ÿç»ƒæŒæ¡åŸºç¡€å‘½ä»¤ï¼ˆadd, commit, push, pullï¼‰</li>
<li>ç†è§£åˆ†æ”¯ç®¡ç†å’Œåˆå¹¶ç­–ç•¥</li>
<li>å­¦ä¹ å¤„ç†å†²çªå’Œå›é€€æ“ä½œ</li>
<li>æŒæ¡é«˜çº§æŠ€å·§å’Œæœ€ä½³å®è·µ</li>
<li>ä½¿ç”¨GitHubåä½œåŠŸèƒ½ï¼ˆPR, Issue, Actionsï¼‰</li>
</ol>
<p><strong>å‚è€ƒèµ„æºï¼š</strong></p>
<ul>
<li><a href="https://git-scm.com/doc">Gitå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://docs.github.com/">GitHubå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://skills.github.com/">GitHub Skills</a></li>
<li><a href="https://githeroes.com/">Git Hero</a></li>
</ul>
<p>è®°ä½ï¼š<strong>ç†Ÿèƒ½ç”Ÿå·§</strong>ï¼Œå¤šä½¿ç”¨è¿™äº›å‘½ä»¤ï¼Œè‡ªç„¶ä¼šè¶Šæ¥è¶Šç†Ÿç»ƒï¼</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡æ–‡ç« å°†ä»‹ç»Git Flowå·¥ä½œæµå’Œå›¢é˜Ÿåä½œæœ€ä½³å®è·µï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>å¼€å‘å·¥å…·</tag>
        <tag>Git</tag>
        <tag>GitHub</tag>
        <tag>ç‰ˆæœ¬æ§åˆ¶</tag>
      </tags>
  </entry>
  <entry>
    <title>React Hookså®Œå…¨æŒ‡å—ï¼šæ·±å…¥ç†è§£ç°ä»£Reactå¼€å‘</title>
    <url>/2026/01/20/react-hooks-deep-dive/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>React Hooks è‡ª React 16.8 ç‰ˆæœ¬å¼•å…¥ä»¥æ¥ï¼Œå½»åº•æ”¹å˜äº†æˆ‘ä»¬ç¼–å†™ React ç»„ä»¶çš„æ–¹å¼ã€‚å®ƒè®©å‡½æ•°ç»„ä»¶æ‹¥æœ‰äº†çŠ¶æ€ç®¡ç†å’Œå‰¯ä½œç”¨å¤„ç†çš„èƒ½åŠ›ï¼ŒåŒæ—¶æä¾›äº†æ›´ä¼˜é›…çš„ä»£ç ç»„ç»‡æ–¹å¼ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ React Hooks çš„æ ¸å¿ƒæ¦‚å¿µã€ä½¿ç”¨æŠ€å·§å’Œæœ€ä½³å®è·µã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆéœ€è¦-Hooksï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦-Hooksï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ Hooksï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦ Hooksï¼Ÿ</h2><h3 id="Hooks-è§£å†³çš„é—®é¢˜"><a href="#Hooks-è§£å†³çš„é—®é¢˜" class="headerlink" title="Hooks è§£å†³çš„é—®é¢˜"></a>Hooks è§£å†³çš„é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âŒ æ—§æ–¹å¼ï¼šç±»ç»„ä»¶çš„ç—›ç‚¹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserProfile</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">user</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">loading</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">error</span>: <span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">fetchUser</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (prevProps.<span class="property">userId</span> !== <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">userId</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">fetchUser</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">fetchUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">loading</span>: <span class="literal">true</span>, <span class="attr">error</span>: <span class="literal">null</span> &#125;);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/users/<span class="subst">$&#123;<span class="variable language_">this</span>.props.userId&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">const</span> user = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; user, <span class="attr">loading</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; error, <span class="attr">loading</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// JSX æ¸²æŸ“é€»è¾‘</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ–°æ–¹å¼ï¼šä½¿ç”¨ Hooks</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserProfile</span>(<span class="params">&#123; userId &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [user, setUser] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> [error, setError] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetchUser</span>();</span><br><span class="line">  &#125;, [userId]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="title function_">setError</span>(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/users/<span class="subst">$&#123;userId&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">      <span class="title function_">setUser</span>(data);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="title function_">setError</span>(err);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// JSX æ¸²æŸ“é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Hooks çš„ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… ä»£ç æ›´ç®€æ´ï¼Œé€»è¾‘æ›´æ¸…æ™°</li>
<li>âœ… ç›¸å…³é€»è¾‘ç»„ç»‡åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨ä¸åŒç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­</li>
<li>âœ… å¤ç”¨çŠ¶æ€é€»è¾‘æ›´å®¹æ˜“</li>
<li>âœ… æ²¡æœ‰ <code>this</code> ç»‘å®šé—®é¢˜</li>
</ul>
<h2 id="æ ¸å¿ƒ-Hooks-è¯¦è§£"><a href="#æ ¸å¿ƒ-Hooks-è¯¦è§£" class="headerlink" title="æ ¸å¿ƒ Hooks è¯¦è§£"></a>æ ¸å¿ƒ Hooks è¯¦è§£</h2><h3 id="1-useState-çŠ¶æ€ç®¡ç†"><a href="#1-useState-çŠ¶æ€ç®¡ç†" class="headerlink" title="1. useState - çŠ¶æ€ç®¡ç†"></a>1. useState - çŠ¶æ€ç®¡ç†</h3><h4 id="åŸºç¡€ç”¨æ³•"><a href="#åŸºç¡€ç”¨æ³•" class="headerlink" title="åŸºç¡€ç”¨æ³•"></a>åŸºç¡€ç”¨æ³•</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// å£°æ˜ä¸€ä¸ªå« count çš„çŠ¶æ€å˜é‡ï¼Œåˆå§‹å€¼ä¸º 0</span></span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä½ ç‚¹å‡»äº† &#123;count&#125; æ¬¡<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        ç‚¹å‡»æˆ‘</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æƒ°æ€§åˆå§‹åŒ–"><a href="#æƒ°æ€§åˆå§‹åŒ–" class="headerlink" title="æƒ°æ€§åˆå§‹åŒ–"></a>æƒ°æ€§åˆå§‹åŒ–</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœåˆå§‹çŠ¶æ€éœ€è¦å¤æ‚è®¡ç®—ï¼Œä½¿ç”¨å‡½æ•°é¿å…é‡å¤è®¡ç®—</span></span><br><span class="line"><span class="keyword">const</span> [state, setState] = <span class="title function_">useState</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> initialState = <span class="title function_">someExpensiveComputation</span>(props);</span><br><span class="line">  <span class="keyword">return</span> initialState;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="å‡½æ•°å¼æ›´æ–°"><a href="#å‡½æ•°å¼æ›´æ–°" class="headerlink" title="å‡½æ•°å¼æ›´æ–°"></a>å‡½æ•°å¼æ›´æ–°</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å½“æ–°çŠ¶æ€ä¾èµ–äºæ—§çŠ¶æ€æ—¶ï¼Œä½¿ç”¨å‡½æ•°å¼æ›´æ–°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°</span></span><br><span class="line">    <span class="title function_">setCount</span>(<span class="function"><span class="params">prev</span> =&gt;</span> prev + <span class="number">1</span>);</span><br><span class="line">    <span class="title function_">setCount</span>(<span class="function"><span class="params">prev</span> =&gt;</span> prev + <span class="number">1</span>);</span><br><span class="line">    <span class="title function_">setCount</span>(<span class="function"><span class="params">prev</span> =&gt;</span> prev + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// ç»“æœï¼šcount + 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// âŒ é”™è¯¯ï¼šç›´æ¥ä½¿ç”¨å€¼</span></span><br><span class="line">    <span class="comment">// setCount(count + 1);</span></span><br><span class="line">    <span class="comment">// setCount(count + 1);</span></span><br><span class="line">    <span class="comment">// setCount(count + 1);</span></span><br><span class="line">    <span class="comment">// ç»“æœï¼šåªå¢åŠ  1ï¼Œå› ä¸º count æ²¡æœ‰æ›´æ–°</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å¯¹è±¡å’Œæ•°ç»„çŠ¶æ€"><a href="#å¯¹è±¡å’Œæ•°ç»„çŠ¶æ€" class="headerlink" title="å¯¹è±¡å’Œæ•°ç»„çŠ¶æ€"></a>å¯¹è±¡å’Œæ•°ç»„çŠ¶æ€</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">UserForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [user, setUser] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">email</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">0</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">updateField</span> = (<span class="params">field, value</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// âœ… æ­£ç¡®ï¼šåˆ›å»ºæ–°å¯¹è±¡</span></span><br><span class="line">    <span class="title function_">setUser</span>(<span class="function"><span class="params">prev</span> =&gt;</span> (&#123;</span><br><span class="line">      ...prev,</span><br><span class="line">      [field]: value</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">updateName</span> = (<span class="params">name</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setUser</span>(<span class="function"><span class="params">prev</span> =&gt;</span> (&#123; ...prev, name &#125;));</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;user.name&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> updateField(&#x27;name&#x27;, e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;user.email&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> updateField(&#x27;email&#x27;, e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-useEffect-å‰¯ä½œç”¨å¤„ç†"><a href="#2-useEffect-å‰¯ä½œç”¨å¤„ç†" class="headerlink" title="2. useEffect - å‰¯ä½œç”¨å¤„ç†"></a>2. useEffect - å‰¯ä½œç”¨å¤„ç†</h3><h4 id="åŸºç¡€ç”¨æ³•-1"><a href="#åŸºç¡€ç”¨æ³•-1" class="headerlink" title="åŸºç¡€ç”¨æ³•"></a>åŸºç¡€ç”¨æ³•</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserProfile</span>(<span class="params">&#123; userId &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [user, setUser] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç±»ä¼¼äº componentDidMount å’Œ componentDidUpdate</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å‰¯ä½œç”¨ï¼šè·å–ç”¨æˆ·æ•°æ®</span></span><br><span class="line">    <span class="title function_">fetchUser</span>(userId).<span class="title function_">then</span>(setUser);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯é€‰çš„æ¸…ç†å‡½æ•°ï¼šç±»ä¼¼äº componentWillUnmount</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç»„ä»¶å¸è½½æˆ–é‡æ–°æ¸²æŸ“å‰&#x27;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [userId]); <span class="comment">// ä¾èµ–æ•°ç»„ï¼šåªæœ‰ userId æ”¹å˜æ—¶æ‰é‡æ–°æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> user ? <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="useEffect-çš„æ‰§è¡Œæ—¶æœº"><a href="#useEffect-çš„æ‰§è¡Œæ—¶æœº" class="headerlink" title="useEffect çš„æ‰§è¡Œæ—¶æœº"></a>useEffect çš„æ‰§è¡Œæ—¶æœº</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">EffectDemo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. æ¯æ¬¡æ¸²æŸ“åéƒ½æ‰§è¡Œï¼ˆä¸æ¨èï¼‰</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œ&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. åªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œ&#x27;</span>);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. å½“ count æ”¹å˜æ—¶æ‰§è¡Œ</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;count æ”¹å˜:&#x27;</span>, count);</span><br><span class="line">  &#125;, [count]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. å¸¦æ¸…ç†å‡½æ•°</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å®šæ—¶å™¨æ‰§è¡Œ&#x27;</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearInterval</span>(timer); <span class="comment">// æ¸…ç†</span></span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å¸¸è§ä½¿ç”¨åœºæ™¯"><a href="#å¸¸è§ä½¿ç”¨åœºæ™¯" class="headerlink" title="å¸¸è§ä½¿ç”¨åœºæ™¯"></a>å¸¸è§ä½¿ç”¨åœºæ™¯</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åœºæ™¯1ï¼šæ•°æ®è·å–</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">DataFetcher</span>(<span class="params">&#123; userId &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> cancelled = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/users/<span class="subst">$&#123;userId&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">        <span class="keyword">if</span> (!cancelled) &#123;</span><br><span class="line">          <span class="title function_">setData</span>(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!cancelled) &#123;</span><br><span class="line">          <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fetchData</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      cancelled = <span class="literal">true</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [userId]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (loading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœºæ™¯2ï¼šè®¢é˜…äº‹ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">WindowSize</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [size, setSize] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="variable language_">window</span>.<span class="property">innerWidth</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="variable language_">window</span>.<span class="property">innerHeight</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleResize</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="title function_">setSize</span>(&#123;</span><br><span class="line">        <span class="attr">width</span>: <span class="variable language_">window</span>.<span class="property">innerWidth</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="variable language_">window</span>.<span class="property">innerHeight</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, handleResize);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, handleResize);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      çª—å£å¤§å°: &#123;size.width&#125; x &#123;size.height&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœºæ™¯3ï¼šæ‰‹åŠ¨ä¿®æ”¹ DOM</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">FocusInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-useContext-è·¨ç»„ä»¶çŠ¶æ€å…±äº«"><a href="#3-useContext-è·¨ç»„ä»¶çŠ¶æ€å…±äº«" class="headerlink" title="3. useContext - è·¨ç»„ä»¶çŠ¶æ€å…±äº«"></a>3. useContext - è·¨ç»„ä»¶çŠ¶æ€å…±äº«</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createContext, useContext, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. åˆ›å»º Context</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeContext</span> = <span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åˆ›å»º Provider ç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ThemeProvider</span>(<span class="params">&#123; children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [theme, setTheme] = <span class="title function_">useState</span>(<span class="string">&#x27;light&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">toggleTheme</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setTheme</span>(<span class="function"><span class="params">prev</span> =&gt;</span> prev === <span class="string">&#x27;light&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">theme</span>, <span class="attr">toggleTheme</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. åˆ›å»ºè‡ªå®šä¹‰ Hook</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useTheme</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> context = <span class="title function_">useContext</span>(<span class="title class_">ThemeContext</span>);</span><br><span class="line">  <span class="keyword">if</span> (!context) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;useTheme must be used within ThemeProvider&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> context;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. ä½¿ç”¨ Context</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ThemeProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Toolbar</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Content</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ThemeProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Toolbar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; theme, toggleTheme &#125; = <span class="title function_">useTheme</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;toggleTheme&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      å½“å‰ä¸»é¢˜: &#123;theme&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-useReducer-å¤æ‚çŠ¶æ€ç®¡ç†"><a href="#4-useReducer-å¤æ‚çŠ¶æ€ç®¡ç†" class="headerlink" title="4. useReducer - å¤æ‚çŠ¶æ€ç®¡ç†"></a>4. useReducer - å¤æ‚çŠ¶æ€ç®¡ç†</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reducer å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">counterReducer</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;increment&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;decrement&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;reset&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: action.<span class="property">payload</span> &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Unknown action: <span class="subst">$&#123;action.type&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [state, dispatch] = <span class="title function_">useReducer</span>(counterReducer, &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>è®¡æ•°: &#123;state.count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;increment&#x27; &#125;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        å¢åŠ </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;decrement&#x27; &#125;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        å‡å°‘</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;reset&#x27;, payload: 0 &#125;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        é‡ç½®</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤æ‚ç¤ºä¾‹ï¼šTodo åº”ç”¨</span></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  <span class="attr">todos</span>: [],</span><br><span class="line">  <span class="attr">filter</span>: <span class="string">&#x27;all&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">todoReducer</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;add&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">todos</span>: [</span><br><span class="line">          ...state.<span class="property">todos</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(),</span><br><span class="line">            <span class="attr">text</span>: action.<span class="property">payload</span>,</span><br><span class="line">            <span class="attr">completed</span>: <span class="literal">false</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;toggle&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">todos</span>: state.<span class="property">todos</span>.<span class="title function_">map</span>(<span class="function"><span class="params">todo</span> =&gt;</span></span><br><span class="line">          todo.<span class="property">id</span> === action.<span class="property">payload</span></span><br><span class="line">            ? &#123; ...todo, <span class="attr">completed</span>: !todo.<span class="property">completed</span> &#125;</span><br><span class="line">            : todo</span><br><span class="line">        )</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;delete&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">todos</span>: state.<span class="property">todos</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">todo</span> =&gt;</span> todo.<span class="property">id</span> !== action.<span class="property">payload</span>)</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;setFilter&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">filter</span>: action.<span class="property">payload</span></span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-useRef-è®¿é—®-DOM-å’Œä¿å­˜å¯å˜å€¼"><a href="#5-useRef-è®¿é—®-DOM-å’Œä¿å­˜å¯å˜å€¼" class="headerlink" title="5. useRef - è®¿é—® DOM å’Œä¿å­˜å¯å˜å€¼"></a>5. useRef - è®¿é—® DOM å’Œä¿å­˜å¯å˜å€¼</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useRef, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ³•1ï¼šè®¿é—® DOM å…ƒç´ </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TextInputWithFocusButton</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputEl = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onButtonClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// `current` æŒ‡å‘å·²æŒ‚è½½åˆ° DOM ä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´ </span></span><br><span class="line">    inputEl.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputEl&#125;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onButtonClick&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        èšç„¦è¾“å…¥æ¡†</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ³•2ï¼šä¿å­˜å¯å˜å€¼ï¼ˆä¸è§¦å‘é‡æ–°æ¸²æŸ“ï¼‰</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Timer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> intervalRef = <span class="title function_">useRef</span>();</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> id = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setCount</span>(<span class="function"><span class="params">c</span> =&gt;</span> c + <span class="number">1</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">    intervalRef.<span class="property">current</span> = id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearInterval</span>(intervalRef.<span class="property">current</span>);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">stopTimer</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(intervalRef.<span class="property">current</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>è®¡æ•°: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;stopTimer&#125;</span>&gt;</span>åœæ­¢<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ³•3ï¼šè·å–ä¸Šä¸€æ¬¡çš„å€¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">usePrevious</span>(<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> ref = <span class="title function_">useRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    ref.<span class="property">current</span> = value;</span><br><span class="line">  &#125;, [value]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ref.<span class="property">current</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> prevCount = <span class="title function_">usePrevious</span>(count);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>å½“å‰: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¸€æ¬¡: &#123;prevCount&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;å¢åŠ <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-useMemo-æ€§èƒ½ä¼˜åŒ–"><a href="#6-useMemo-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="6. useMemo - æ€§èƒ½ä¼˜åŒ–"></a>6. useMemo - æ€§èƒ½ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼“å­˜æ˜‚è´µçš„è®¡ç®—</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ExpensiveComponent</span>(<span class="params">&#123; items &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// âŒ æ¯æ¬¡æ¸²æŸ“éƒ½é‡æ–°è®¡ç®—</span></span><br><span class="line">  <span class="comment">// const sorted = items.sort((a, b) =&gt; a - b);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// âœ… åªåœ¨ items æ”¹å˜æ—¶é‡æ–°è®¡ç®—</span></span><br><span class="line">  <span class="keyword">const</span> sorted = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ’åºè®¡ç®—&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> items.<span class="title function_">slice</span>().<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br><span class="line">  &#125;, [items]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;sorted.join(&#x27;, &#x27;)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼“å­˜å¤æ‚å¯¹è±¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserProfile</span>(<span class="params">&#123; userId &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetchUser</span>(userId);</span><br><span class="line">  &#125;, [userId]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¿å…ä¸å¿…è¦çš„å­ç»„ä»¶æ¸²æŸ“</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ParentComponent</span>(<span class="params">&#123; items &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> sorted = <span class="title function_">useMemo</span>(</span><br><span class="line">    <span class="function">() =&gt;</span> items.<span class="title function_">slice</span>().<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="property">id</span> - b.<span class="property">id</span>),</span><br><span class="line">    [items]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">items</span>=<span class="string">&#123;sorted&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-useCallback-å‡½æ•°ç¼“å­˜"><a href="#7-useCallback-å‡½æ•°ç¼“å­˜" class="headerlink" title="7. useCallback - å‡½æ•°ç¼“å­˜"></a>7. useCallback - å‡½æ•°ç¼“å­˜</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸºç¡€ç”¨æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Form</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// âŒ æ¯æ¬¡æ¸²æŸ“éƒ½åˆ›å»ºæ–°å‡½æ•°</span></span><br><span class="line">  <span class="comment">// const handleChange = (e) =&gt; setValue(e.target.value);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// âœ… åªæœ‰ä¾èµ–æ”¹å˜æ—¶æ‰åˆ›å»ºæ–°å‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> handleChange = <span class="title function_">useCallback</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setValue</span>(e.<span class="property">target</span>.<span class="property">value</span>);</span><br><span class="line">  &#125;, []); <span class="comment">// ç©ºä¾èµ–æ•°ç»„ï¼Œå‡½æ•°æ°¸è¿œä¸ä¼šæ”¹å˜</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…åˆ useMemo ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ProductList</span>(<span class="params">&#123; products, addToCart &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ç¼“å­˜è®¡ç®—ç»“æœ</span></span><br><span class="line">  <span class="keyword">const</span> sortedProducts = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> products.<span class="title function_">slice</span>().<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="property">price</span> - b.<span class="property">price</span>);</span><br><span class="line">  &#125;, [products]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç¼“å­˜å›è°ƒå‡½æ•°</span></span><br><span class="line">  <span class="keyword">const</span> handleAddToCart = <span class="title function_">useCallback</span>(<span class="function">(<span class="params">product</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">addToCart</span>(product);</span><br><span class="line">  &#125;, [addToCart]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;sortedProducts.map(product =&gt; (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Product</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">key</span>=<span class="string">&#123;product.id&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">product</span>=<span class="string">&#123;product&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onAddToCart</span>=<span class="string">&#123;handleAddToCart&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      ))&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªå®šä¹‰-Hooks"><a href="#è‡ªå®šä¹‰-Hooks" class="headerlink" title="è‡ªå®šä¹‰ Hooks"></a>è‡ªå®šä¹‰ Hooks</h2><p>è‡ªå®šä¹‰ Hooks æ˜¯å¤ç”¨é€»è¾‘çš„å¼ºå¤§æ–¹å¼ã€‚</p>
<h3 id="åŸºç¡€è‡ªå®šä¹‰-Hook"><a href="#åŸºç¡€è‡ªå®šä¹‰-Hook" class="headerlink" title="åŸºç¡€è‡ªå®šä¹‰ Hook"></a>åŸºç¡€è‡ªå®šä¹‰ Hook</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. å°è£…æ•°æ®è·å–é€»è¾‘</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useFetch</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> [error, setError] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> cancelled = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line">      <span class="title function_">setError</span>(<span class="literal">null</span>);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">        <span class="keyword">if</span> (!cancelled) &#123;</span><br><span class="line">          <span class="title function_">setData</span>(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!cancelled) &#123;</span><br><span class="line">          <span class="title function_">setError</span>(err);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!cancelled) &#123;</span><br><span class="line">          <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fetchData</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      cancelled = <span class="literal">true</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [url]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; data, loading, error &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserProfile</span>(<span class="params">&#123; userId &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">data</span>: user, loading, error &#125; = <span class="title function_">useFetch</span>(</span><br><span class="line">    <span class="string">`/api/users/<span class="subst">$&#123;userId&#125;</span>`</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (loading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>é”™è¯¯: &#123;error.message&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å°è£…æœ¬åœ°å­˜å‚¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useLocalStorage</span>(<span class="params">key, initialValue</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [storedValue, setStoredValue] = <span class="title function_">useState</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> item = <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">      <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : initialValue;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">return</span> initialValue;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> setValue = <span class="title function_">useCallback</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> valueToStore =</span><br><span class="line">        value <span class="keyword">instanceof</span> <span class="title class_">Function</span> ? <span class="title function_">value</span>(storedValue) : value;</span><br><span class="line">      <span class="title function_">setStoredValue</span>(valueToStore);</span><br><span class="line">      <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(valueToStore));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [key, storedValue]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [storedValue, setValue];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [name, setName] = <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;Guest&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">value</span>=<span class="string">&#123;name&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setName(e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">    /&gt;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. å°è£… debounce</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useDebounce</span>(<span class="params">value, delay</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [debouncedValue, setDebouncedValue] = <span class="title function_">useState</span>(value);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> handler = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setDebouncedValue</span>(value);</span><br><span class="line">    &#125;, delay);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearTimeout</span>(handler);</span><br><span class="line">  &#125;, [value, delay]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> debouncedValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ï¼šæœç´¢æ¡†é˜²æŠ–</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SearchInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [searchTerm, setSearchTerm] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> debouncedSearchTerm = <span class="title function_">useDebounce</span>(searchTerm, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨é˜²æŠ–åçš„æœç´¢è¯è¿›è¡Œæœç´¢</span></span><br><span class="line">    <span class="keyword">if</span> (debouncedSearchTerm) &#123;</span><br><span class="line">      <span class="title function_">performSearch</span>(debouncedSearchTerm);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [debouncedSearchTerm]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">value</span>=<span class="string">&#123;searchTerm&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setSearchTerm(e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">      placeholder=&quot;æœç´¢...&quot;</span></span><br><span class="line"><span class="language-xml">    /&gt;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. å°è£…çª—å£å¤§å°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useWindowSize</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [size, setSize] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="variable language_">window</span>.<span class="property">innerWidth</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="variable language_">window</span>.<span class="property">innerHeight</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleResize</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="title function_">setSize</span>(&#123;</span><br><span class="line">        <span class="attr">width</span>: <span class="variable language_">window</span>.<span class="property">innerWidth</span>,</span><br><span class="line">        <span class="attr">height</span>: <span class="variable language_">window</span>.<span class="property">innerHeight</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, handleResize);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, handleResize);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. å°è£…è¡¨å•éªŒè¯</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useForm</span>(<span class="params">initialValues, validate</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [values, setValues] = <span class="title function_">useState</span>(initialValues);</span><br><span class="line">  <span class="keyword">const</span> [errors, setErrors] = <span class="title function_">useState</span>(&#123;&#125;);</span><br><span class="line">  <span class="keyword">const</span> [touched, setTouched] = <span class="title function_">useState</span>(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name, value &#125; = e.<span class="property">target</span>;</span><br><span class="line">    <span class="title function_">setValues</span>(<span class="function"><span class="params">prev</span> =&gt;</span> (&#123; ...prev, [name]: value &#125;));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (touched[name]) &#123;</span><br><span class="line">      <span class="title function_">setErrors</span>(<span class="title function_">validate</span>(&#123; ...values, [name]: value &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleBlur</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name &#125; = e.<span class="property">target</span>;</span><br><span class="line">    <span class="title function_">setTouched</span>(<span class="function"><span class="params">prev</span> =&gt;</span> (&#123; ...prev, [name]: <span class="literal">true</span> &#125;));</span><br><span class="line">    <span class="title function_">setErrors</span>(<span class="title function_">validate</span>(values));</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">reset</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setValues</span>(initialValues);</span><br><span class="line">    <span class="title function_">setErrors</span>(&#123;&#125;);</span><br><span class="line">    <span class="title function_">setTouched</span>(&#123;&#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    values,</span><br><span class="line">    errors,</span><br><span class="line">    touched,</span><br><span class="line">    handleChange,</span><br><span class="line">    handleBlur,</span><br><span class="line">    reset,</span><br><span class="line">    <span class="attr">isValid</span>: <span class="title class_">Object</span>.<span class="title function_">keys</span>(errors).<span class="property">length</span> === <span class="number">0</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LoginForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; values, errors, handleChange, handleBlur, isValid &#125; = <span class="title function_">useForm</span>(</span><br><span class="line">    &#123; <span class="attr">email</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span> &#125;,</span><br><span class="line">    <span class="function">(<span class="params">values</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> errors = &#123;&#125;;</span><br><span class="line">      <span class="keyword">if</span> (!values.<span class="property">email</span>) errors.<span class="property">email</span> = <span class="string">&#x27;é‚®ç®±å¿…å¡«&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span> (!values.<span class="property">password</span>) errors.<span class="property">password</span> = <span class="string">&#x27;å¯†ç å¿…å¡«&#x27;</span>;</span><br><span class="line">      <span class="keyword">return</span> errors;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleSubmit</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">if</span> (isValid) &#123;</span><br><span class="line">      <span class="comment">// æäº¤è¡¨å•</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;handleSubmit&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;email&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;values.email&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onBlur</span>=<span class="string">&#123;handleBlur&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;errors.email &amp;&amp; <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;errors.email&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;values.password&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onBlur</span>=<span class="string">&#123;handleBlur&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;errors.password &amp;&amp; <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;errors.password&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">disabled</span>=<span class="string">&#123;!isValid&#125;</span>&gt;</span>æäº¤<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Hooks-æœ€ä½³å®è·µ"><a href="#Hooks-æœ€ä½³å®è·µ" class="headerlink" title="Hooks æœ€ä½³å®è·µ"></a>Hooks æœ€ä½³å®è·µ</h2><h3 id="1-éµå¾ª-Hooks-è§„åˆ™"><a href="#1-éµå¾ª-Hooks-è§„åˆ™" class="headerlink" title="1. éµå¾ª Hooks è§„åˆ™"></a>1. éµå¾ª Hooks è§„åˆ™</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šåªåœ¨é¡¶å±‚è°ƒç”¨ Hooks</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">GoodComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">useFetch</span>(<span class="string">&#x27;/api/user&#x27;</span>);</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å‰¯ä½œç”¨</span></span><br><span class="line">  &#125;, []);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šåœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">BadComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>); <span class="comment">// âŒ é”™è¯¯</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šåœ¨å¾ªç¯ä¸­ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">BadComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> items = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">  items.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(item); <span class="comment">// âŒ é”™è¯¯</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… æ­£ç¡®ï¼šæå‰è¿”å›</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">GoodComponent</span>(<span class="params">&#123; flag &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Early return<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// OKï¼šæ‰€æœ‰ Hooks éƒ½åœ¨ return ä¹‹å‰è°ƒç”¨</span></span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-åˆç†ä½¿ç”¨ä¾èµ–æ•°ç»„"><a href="#2-åˆç†ä½¿ç”¨ä¾èµ–æ•°ç»„" class="headerlink" title="2. åˆç†ä½¿ç”¨ä¾èµ–æ•°ç»„"></a>2. åˆç†ä½¿ç”¨ä¾èµ–æ•°ç»„</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âœ… æŒ‡å®šæ‰€æœ‰ä¾èµ–</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> subscription = props.<span class="property">source</span>.<span class="title function_">subscribe</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    subscription.<span class="title function_">unsubscribe</span>();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, [props.<span class="property">source</span>]); <span class="comment">// âœ… æ­£ç¡®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ ç¼ºå°‘ä¾èµ–</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> subscription = props.<span class="property">source</span>.<span class="title function_">subscribe</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    subscription.<span class="title function_">unsubscribe</span>();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, []); <span class="comment">// âŒ è­¦å‘Šï¼šprops.source ç¼ºå¤±</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… ä½¿ç”¨ ESLint æ’ä»¶æ£€æŸ¥ä¾èµ–</span></span><br><span class="line"><span class="comment">// npm install eslint-plugin-react-hooks --save-dev</span></span><br></pre></td></tr></table></figure>

<h3 id="3-é¿å…è¿‡åº¦çš„ä¼˜åŒ–"><a href="#3-é¿å…è¿‡åº¦çš„ä¼˜åŒ–" class="headerlink" title="3. é¿å…è¿‡åº¦çš„ä¼˜åŒ–"></a>3. é¿å…è¿‡åº¦çš„ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âŒ è¿‡åº¦ä¼˜åŒ–ï¼šç®€å•è®¡ç®—ä¸éœ€è¦ useMemo</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SimpleComponent</span>(<span class="params">&#123; a, b &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> sum = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> a + b, [a, b]); <span class="comment">// âŒ ä¸å¿…è¦</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;sum&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… ç›´æ¥è®¡ç®—</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">SimpleComponent</span>(<span class="params">&#123; a, b &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;a + b&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… åˆç†ä½¿ç”¨ï¼šæ˜‚è´µçš„è®¡ç®—</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ExpensiveComponent</span>(<span class="params">&#123; data &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> data.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">value</span> &gt; <span class="number">100</span>)</span><br><span class="line">               .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">value</span> * <span class="number">2</span>)</span><br><span class="line">               .<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b, <span class="number">0</span>);</span><br><span class="line">  &#125;, [data]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;result&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-ç»„ç»‡è‡ªå®šä¹‰-Hooks"><a href="#4-ç»„ç»‡è‡ªå®šä¹‰-Hooks" class="headerlink" title="4. ç»„ç»‡è‡ªå®šä¹‰ Hooks"></a>4. ç»„ç»‡è‡ªå®šä¹‰ Hooks</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âœ… å•ä¸€èŒè´£ï¼šä¸€ä¸ª Hook åªåšä¸€ä»¶äº‹</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useFetch</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="comment">// åªè´Ÿè´£æ•°æ®è·å–</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useLocalStorage</span>(<span class="params">key, initialValue</span>) &#123;</span><br><span class="line">  <span class="comment">// åªè´Ÿè´£æœ¬åœ°å­˜å‚¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ èŒè´£æ··ä¹±</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useFetchAndStore</span>(<span class="params">url, key</span>) &#123;</span><br><span class="line">  <span class="comment">// æ—¢è´Ÿè´£è·å–æ•°æ®åˆè´Ÿè´£å­˜å‚¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… ç»„åˆä½¿ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserProfile</span>(<span class="params">&#123; userId &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; data &#125; = <span class="title function_">useFetch</span>(<span class="string">`/api/users/<span class="subst">$&#123;userId&#125;</span>`</span>);</span><br><span class="line">  <span class="title function_">useLocalStorage</span>(<span class="string">`user_<span class="subst">$&#123;userId&#125;</span>`</span>, data);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ"><a href="#å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ"></a>å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ</h2><h3 id="1-é—­åŒ…é™·é˜±"><a href="#1-é—­åŒ…é™·é˜±" class="headerlink" title="1. é—­åŒ…é™·é˜±"></a>1. é—­åŒ…é™·é˜±</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âŒ é—®é¢˜ï¼šé—­åŒ…æ•è·æ—§å€¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> id = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(count); <span class="comment">// æ€»æ˜¯æ‰“å° 0</span></span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearInterval</span>(id);</span><br><span class="line">  &#125;, []); <span class="comment">// ç©ºä¾èµ–æ•°ç»„</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> id = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setCount</span>(<span class="function"><span class="params">c</span> =&gt;</span> c + <span class="number">1</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearInterval</span>(id);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨ useRef</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> countRef = <span class="title function_">useRef</span>(count);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    countRef.<span class="property">current</span> = count;</span><br><span class="line">  &#125;, [count]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> id = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(countRef.<span class="property">current</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearInterval</span>(id);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;&#123;count&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-æ— é™å¾ªç¯"><a href="#2-æ— é™å¾ªç¯" class="headerlink" title="2. æ— é™å¾ªç¯"></a>2. æ— é™å¾ªç¯</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âŒ é—®é¢˜ï¼šæ— é™å¾ªç¯</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;/api/data&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(setData);</span><br><span class="line">  &#125;); <span class="comment">// âŒ ç¼ºå°‘ä¾èµ–æ•°ç»„ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ ä¾èµ–æ•°ç»„</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;/api/data&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(setData);</span><br><span class="line">  &#125;, []); <span class="comment">// âœ… åªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ é—®é¢˜ï¼šå¯¹è±¡ä½œä¸ºä¾èµ–å¯¼è‡´æ— é™å¾ªç¯</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params">&#123; user &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [token, setToken] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;/api/token&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(setToken);</span><br><span class="line">  &#125;, [user]); <span class="comment">// âŒ user æ˜¯å¯¹è±¡ï¼Œæ¯æ¬¡éƒ½æ˜¯æ–°å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;token&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆï¼šåªä¾èµ–å…·ä½“å±æ€§</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params">&#123; user &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [token, setToken] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;/api/token&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(setToken);</span><br><span class="line">  &#125;, [user.<span class="property">id</span>]); <span class="comment">// âœ… åªä¾èµ– ID</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;token&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-æ¡ä»¶æ¸²æŸ“ä¸­çš„-Hooks"><a href="#3-æ¡ä»¶æ¸²æŸ“ä¸­çš„-Hooks" class="headerlink" title="3. æ¡ä»¶æ¸²æŸ“ä¸­çš„ Hooks"></a>3. æ¡ä»¶æ¸²æŸ“ä¸­çš„ Hooks</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âŒ é”™è¯¯ï¼šæ¡ä»¶è°ƒç”¨ Hooks</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params">&#123; flag &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">    <span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(<span class="number">0</span>); <span class="comment">// âŒ é”™è¯¯</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆ1ï¼šæå‰è®¡ç®—</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params">&#123; flag &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;value&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆ2ï¼šæå–ç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ConditionalHook</span>(<span class="params">&#123; flag &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;value&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params">&#123; flag &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> flag ? <span class="language-xml"><span class="tag">&lt;<span class="name">ConditionalHook</span> /&gt;</span></span> : <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ€§èƒ½ä¼˜åŒ–æŠ€å·§"><a href="#æ€§èƒ½ä¼˜åŒ–æŠ€å·§" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–æŠ€å·§"></a>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2><h3 id="1-ä½¿ç”¨-React-memo-é¿å…ä¸å¿…è¦çš„æ¸²æŸ“"><a href="#1-ä½¿ç”¨-React-memo-é¿å…ä¸å¿…è¦çš„æ¸²æŸ“" class="headerlink" title="1. ä½¿ç”¨ React.memo é¿å…ä¸å¿…è¦çš„æ¸²æŸ“"></a>1. ä½¿ç”¨ React.memo é¿å…ä¸å¿…è¦çš„æ¸²æŸ“</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MyComponent</span> = <span class="title class_">React</span>.<span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params">&#123; name &#125;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ¸²æŸ“ MyComponent&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyComponent</span> = <span class="title class_">React</span>.<span class="title function_">memo</span>(</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params">&#123; user &#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">prevProps, nextProps</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è¿”å› true è¡¨ç¤ºä¸éœ€è¦é‡æ–°æ¸²æŸ“</span></span><br><span class="line">    <span class="keyword">return</span> prevProps.<span class="property">user</span>.<span class="property">id</span> === nextProps.<span class="property">user</span>.<span class="property">id</span>;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="2-è™šæ‹ŸåŒ–é•¿åˆ—è¡¨"><a href="#2-è™šæ‹ŸåŒ–é•¿åˆ—è¡¨" class="headerlink" title="2. è™šæ‹ŸåŒ–é•¿åˆ—è¡¨"></a>2. è™šæ‹ŸåŒ–é•¿åˆ—è¡¨</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ react-window</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FixedSizeList</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-window&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Row</span>(<span class="params">&#123; index, style &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      è¡Œ &#123;index&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">VirtualizedList</span>(<span class="params">&#123; items &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">FixedSizeList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">height</span>=<span class="string">&#123;600&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">itemCount</span>=<span class="string">&#123;items.length&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">itemSize</span>=<span class="string">&#123;50&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;Row&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">FixedSizeList</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½"><a href="#3-ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½" class="headerlink" title="3. ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½"></a>3. ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; lazy, <span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‡’åŠ è½½ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HeavyComponent</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./HeavyComponent&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>åŠ è½½ä¸­...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">HeavyComponent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/Home&#x27;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">About</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./routes/About&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">Spinner</span> /&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">About</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>React Hooks æ˜¯ç°ä»£ React å¼€å‘çš„æ ¸å¿ƒï¼ŒæŒæ¡å®ƒèƒ½è®©ä½ å†™å‡ºæ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç ã€‚</p>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p>
<ol>
<li>âœ… éµå¾ª Hooks è§„åˆ™ï¼ˆåªåœ¨é¡¶å±‚è°ƒç”¨ï¼‰</li>
<li>âœ… åˆç†ä½¿ç”¨ä¾èµ–æ•°ç»„</li>
<li>âœ… æå–è‡ªå®šä¹‰ Hooks å¤ç”¨é€»è¾‘</li>
<li>âœ… ä½¿ç”¨ useMemo å’Œ useCallback ä¼˜åŒ–æ€§èƒ½</li>
<li>âœ… é¿å…å¸¸è§çš„é—­åŒ…å’Œæ— é™å¾ªç¯é™·é˜±</li>
</ol>
<p><strong>å­¦ä¹ è·¯å¾„</strong>ï¼š</p>
<ol>
<li>ç†è§£åŸºç¡€ Hooksï¼ˆuseState, useEffectï¼‰</li>
<li>æŒæ¡é«˜çº§ Hooksï¼ˆuseContext, useReducerï¼‰</li>
<li>å­¦ä¹ è‡ªå®šä¹‰ Hooks</li>
<li>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li>å®æˆ˜é¡¹ç›®åº”ç”¨</li>
</ol>
<p><strong>æ¨èèµ„æº</strong>ï¼š</p>
<ul>
<li><a href="https://react.dev/">React å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://react.dev/reference/react">Hooks FAQ</a></li>
<li><a href="https://usehooks.com/">useHooks.com</a></li>
<li><a href="https://www.npmjs.com/package/eslint-plugin-react-hooks">Hooks è§„åˆ™ ESLint æ’ä»¶</a></li>
</ul>
<p>ç»§ç»­æ¢ç´¢ Hooks çš„å¼ºå¤§åŠŸèƒ½ï¼Œæ„å»ºæ›´ä¼˜ç§€çš„ React åº”ç”¨ï¼</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†æ·±å…¥è®²è§£ React æ€§èƒ½ä¼˜åŒ–å’Œå¹¶å‘æ¨¡å¼ï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>React</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å¼€å‘</tag>
        <tag>JavaScript</tag>
        <tag>React</tag>
        <tag>Hooks</tag>
      </tags>
  </entry>
  <entry>
    <title>æœºå™¨å­¦ä¹ å®æˆ˜ï¼šä»çº¿æ€§å›å½’åˆ°ç¥ç»ç½‘ç»œ</title>
    <url>/2026/01/20/machine-learning-basics/</url>
    <content><![CDATA[<h2 id="æœºå™¨å­¦ä¹ æ¦‚è¿°"><a href="#æœºå™¨å­¦ä¹ æ¦‚è¿°" class="headerlink" title="æœºå™¨å­¦ä¹ æ¦‚è¿°"></a>æœºå™¨å­¦ä¹ æ¦‚è¿°</h2><p>æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰æ˜¯äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼Œå®ƒä½¿è®¡ç®—æœºèƒ½å¤Ÿä»æ•°æ®ä¸­å­¦ä¹ ï¼Œè€Œä¸æ˜¯é€šè¿‡æ˜¾å¼ç¼–ç¨‹ã€‚</p>
<h3 id="æœºå™¨å­¦ä¹ çš„ä¸‰ç§ä¸»è¦ç±»å‹"><a href="#æœºå™¨å­¦ä¹ çš„ä¸‰ç§ä¸»è¦ç±»å‹" class="headerlink" title="æœºå™¨å­¦ä¹ çš„ä¸‰ç§ä¸»è¦ç±»å‹"></a>æœºå™¨å­¦ä¹ çš„ä¸‰ç§ä¸»è¦ç±»å‹</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚              æœºå™¨å­¦ä¹ åˆ†ç±»å›¾                       â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  ç›‘ç£å­¦ä¹           æ— ç›‘ç£å­¦ä¹         å¼ºåŒ–å­¦ä¹     â”‚</span><br><span class="line">â”‚  (æœ‰æ ‡ç­¾æ•°æ®)      (æ— æ ‡ç­¾æ•°æ®)      (å¥–åŠ±æœºåˆ¶)  â”‚</span><br><span class="line">â”‚     â†“                â†“                â†“         â”‚</span><br><span class="line">â”‚  åˆ†ç±»/å›å½’         èšç±»/é™ç»´       æ¸¸æˆAI       â”‚</span><br><span class="line">â”‚  å›¾åƒè¯†åˆ«         å¼‚å¸¸æ£€æµ‹         æœºå™¨äººæ§åˆ¶   â”‚</span><br><span class="line">â”‚  è¯­éŸ³è¯†åˆ«         å…³è”è§„åˆ™         æ¨èç³»ç»Ÿ     â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure>

<h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£…å¿…è¦çš„Pythonåº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install numpy pandas scikit-learn matplotlib jupyter</span><br></pre></td></tr></table></figure>

<h2 id="1-çº¿æ€§å›å½’-æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•"><a href="#1-çº¿æ€§å›å½’-æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•" class="headerlink" title="1. çº¿æ€§å›å½’ - æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•"></a>1. çº¿æ€§å›å½’ - æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•</h2><p>çº¿æ€§å›å½’ç”¨äºé¢„æµ‹è¿ç»­å€¼ã€‚è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„æˆ¿ä»·é¢„æµ‹ä¾‹å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error, r2_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆç¤ºä¾‹æ•°æ®</span></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line">n_samples = <span class="number">100</span></span><br><span class="line">X = np.random.randn(n_samples, <span class="number">1</span>) * <span class="number">10</span> + <span class="number">50</span>  <span class="comment"># æˆ¿å±‹é¢ç§¯ (50-150å¹³ç±³)</span></span><br><span class="line">y = <span class="number">2</span> * X.flatten() + <span class="number">10</span> + np.random.randn(n_samples) * <span class="number">20</span>  <span class="comment"># æˆ¿ä»·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class="line">    X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¹¶è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯„ä¼°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ç³»æ•°: <span class="subst">&#123;model.coef_[<span class="number">0</span>]:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æˆªè·: <span class="subst">&#123;model.intercept_:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;RÂ²åˆ†æ•°: <span class="subst">&#123;r2_score(y_test, y_pred):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;å‡æ–¹è¯¯å·®: <span class="subst">&#123;mean_squared_error(y_test, y_pred):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–</span></span><br><span class="line">plt.scatter(X_test, y_test, color=<span class="string">&#x27;blue&#x27;</span>, alpha=<span class="number">0.5</span>, label=<span class="string">&#x27;å®é™…å€¼&#x27;</span>)</span><br><span class="line">plt.plot(X_test, y_pred, color=<span class="string">&#x27;red&#x27;</span>, linewidth=<span class="number">2</span>, label=<span class="string">&#x27;é¢„æµ‹çº¿&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;æˆ¿å±‹é¢ç§¯ (ã¡)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;æˆ¿ä»· (ä¸‡å…ƒ)&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;çº¿æ€§å›å½’ï¼šæˆ¿å±‹é¢ç§¯ vs æˆ¿ä»·&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç³»æ•°: 2.01</span><br><span class="line">æˆªè·: 9.87</span><br><span class="line">RÂ²åˆ†æ•°: 0.91</span><br><span class="line">å‡æ–¹è¯¯å·®: 376.42</span><br></pre></td></tr></table></figure>

<h2 id="2-é€»è¾‘å›å½’-äºŒåˆ†ç±»é—®é¢˜"><a href="#2-é€»è¾‘å›å½’-äºŒåˆ†ç±»é—®é¢˜" class="headerlink" title="2. é€»è¾‘å›å½’ - äºŒåˆ†ç±»é—®é¢˜"></a>2. é€»è¾‘å›å½’ - äºŒåˆ†ç±»é—®é¢˜</h2><p>é€»è¾‘å›å½’ç”¨äºåˆ†ç±»ä»»åŠ¡ï¼Œä¾‹å¦‚åˆ¤æ–­é‚®ä»¶æ˜¯å¦ä¸ºåƒåœ¾é‚®ä»¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, confusion_matrix</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”ŸæˆäºŒåˆ†ç±»æ•°æ®</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_classification</span><br><span class="line">X, y = make_classification(</span><br><span class="line">    n_samples=<span class="number">1000</span>,</span><br><span class="line">    n_features=<span class="number">20</span>,</span><br><span class="line">    n_informative=<span class="number">15</span>,</span><br><span class="line">    n_redundant=<span class="number">5</span>,</span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class="line">    X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">lr_model = LogisticRegression(max_iter=<span class="number">1000</span>)</span><br><span class="line">lr_model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">y_pred = lr_model.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯„ä¼°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åˆ†ç±»æŠ¥å‘Š:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\næ··æ·†çŸ©é˜µ:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(confusion_matrix(y_test, y_pred))</span><br></pre></td></tr></table></figure>

<h2 id="3-å†³ç­–æ ‘-å¯è§£é‡Šæ€§å¼ºçš„åˆ†ç±»å™¨"><a href="#3-å†³ç­–æ ‘-å¯è§£é‡Šæ€§å¼ºçš„åˆ†ç±»å™¨" class="headerlink" title="3. å†³ç­–æ ‘ - å¯è§£é‡Šæ€§å¼ºçš„åˆ†ç±»å™¨"></a>3. å†³ç­–æ ‘ - å¯è§£é‡Šæ€§å¼ºçš„åˆ†ç±»å™¨</h2><p>å†³ç­–æ ‘æ˜“äºç†è§£å’Œè§£é‡Šï¼Œé€‚åˆå¯è§†åŒ–å±•ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier, plot_tree</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç»å…¸é¸¢å°¾èŠ±æ•°æ®é›†</span></span><br><span class="line">iris = load_iris()</span><br><span class="line">X, y = iris.data, iris.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒå†³ç­–æ ‘</span></span><br><span class="line">tree_model = DecisionTreeClassifier(max_depth=<span class="number">3</span>, random_state=<span class="number">42</span>)</span><br><span class="line">tree_model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–å†³ç­–æ ‘</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line">plot_tree(tree_model,</span><br><span class="line">          feature_names=iris.feature_names,</span><br><span class="line">          class_names=iris.target_names,</span><br><span class="line">          filled=<span class="literal">True</span>,</span><br><span class="line">          rounded=<span class="literal">True</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;å†³ç­–æ ‘ï¼šé¸¢å°¾èŠ±åˆ†ç±»&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="4-éšæœºæ£®æ—-é›†æˆå­¦ä¹ çš„å¨åŠ›"><a href="#4-éšæœºæ£®æ—-é›†æˆå­¦ä¹ çš„å¨åŠ›" class="headerlink" title="4. éšæœºæ£®æ— - é›†æˆå­¦ä¹ çš„å¨åŠ›"></a>4. éšæœºæ£®æ— - é›†æˆå­¦ä¹ çš„å¨åŠ›</h2><p>éšæœºæ£®æ—ç»“åˆå¤šä¸ªå†³ç­–æ ‘ï¼Œæä¾›æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"></span><br><span class="line">rf_model = RandomForestClassifier(</span><br><span class="line">    n_estimators=<span class="number">100</span>,</span><br><span class="line">    max_depth=<span class="number">5</span>,</span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line">rf_model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç‰¹å¾é‡è¦æ€§</span></span><br><span class="line">feature_importance = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;Feature&#x27;</span>: iris.feature_names,</span><br><span class="line">    <span class="string">&#x27;Importance&#x27;</span>: rf_model.feature_importances_</span><br><span class="line">&#125;).sort_values(<span class="string">&#x27;Importance&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç‰¹å¾é‡è¦æ€§:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(feature_importance)</span><br></pre></td></tr></table></figure>

<h2 id="5-K-Meansèšç±»-æ— ç›‘ç£å­¦ä¹ "><a href="#5-K-Meansèšç±»-æ— ç›‘ç£å­¦ä¹ " class="headerlink" title="5. K-Meansèšç±» - æ— ç›‘ç£å­¦ä¹ "></a>5. K-Meansèšç±» - æ— ç›‘ç£å­¦ä¹ </h2><p>K-Meansç”¨äºå°†æ•°æ®åˆ†æˆKä¸ªç»„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆèšç±»æ•°æ®</span></span><br><span class="line">X_blob, y_blob = make_blobs(</span><br><span class="line">    n_samples=<span class="number">300</span>,</span><br><span class="line">    centers=<span class="number">4</span>,</span><br><span class="line">    cluster_std=<span class="number">0.60</span>,</span><br><span class="line">    random_state=<span class="number">0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># K-Meansèšç±»</span></span><br><span class="line">kmeans = KMeans(n_clusters=<span class="number">4</span>, random_state=<span class="number">42</span>)</span><br><span class="line">y_kmeans = kmeans.fit_predict(X_blob)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–</span></span><br><span class="line">plt.scatter(X_blob[:, <span class="number">0</span>], X_blob[:, <span class="number">1</span>], c=y_kmeans, s=<span class="number">50</span>, cmap=<span class="string">&#x27;viridis&#x27;</span>)</span><br><span class="line">centers = kmeans.cluster_centers_</span><br><span class="line">plt.scatter(centers[:, <span class="number">0</span>], centers[:, <span class="number">1</span>],</span><br><span class="line">            c=<span class="string">&#x27;red&#x27;</span>, s=<span class="number">200</span>, alpha=<span class="number">0.5</span>, marker=<span class="string">&#x27;X&#x27;</span>, label=<span class="string">&#x27;èšç±»ä¸­å¿ƒ&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;K-Meansèšç±»ç»“æœ&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="6-ç¥ç»ç½‘ç»œå…¥é—¨-æ·±åº¦å­¦ä¹ åŸºç¡€"><a href="#6-ç¥ç»ç½‘ç»œå…¥é—¨-æ·±åº¦å­¦ä¹ åŸºç¡€" class="headerlink" title="6. ç¥ç»ç½‘ç»œå…¥é—¨ - æ·±åº¦å­¦ä¹ åŸºç¡€"></a>6. ç¥ç»ç½‘ç»œå…¥é—¨ - æ·±åº¦å­¦ä¹ åŸºç¡€</h2><p>ä½¿ç”¨å¤šå±‚ç¥ç»ç½‘ç»œå¤„ç†å¤æ‚é—®é¢˜ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neural_network <span class="keyword">import</span> MLPClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®æ ‡å‡†åŒ–ï¼ˆå¯¹ç¥ç»ç½‘ç»œå¾ˆé‡è¦ï¼‰</span></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_train_scaled = scaler.fit_transform(X_train)</span><br><span class="line">X_test_scaled = scaler.transform(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç¥ç»ç½‘ç»œ</span></span><br><span class="line">mlp = MLPClassifier(</span><br><span class="line">    hidden_layer_sizes=(<span class="number">100</span>, <span class="number">50</span>),</span><br><span class="line">    activation=<span class="string">&#x27;relu&#x27;</span>,</span><br><span class="line">    solver=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">    max_iter=<span class="number">500</span>,</span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒ</span></span><br><span class="line">mlp.fit(X_train_scaled, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯„ä¼°</span></span><br><span class="line">train_score = mlp.score(X_train_scaled, y_train)</span><br><span class="line">test_score = mlp.score(X_test_scaled, y_test)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è®­ç»ƒé›†å‡†ç¡®ç‡: <span class="subst">&#123;train_score:<span class="number">.2</span>%&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æµ‹è¯•é›†å‡†ç¡®ç‡: <span class="subst">&#123;test_score:<span class="number">.2</span>%&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶å­¦ä¹ æ›²çº¿</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">5</span>))</span><br><span class="line">plt.plot(mlp.loss_curve_, linewidth=<span class="number">2</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;ç¥ç»ç½‘ç»œè®­ç»ƒæŸå¤±æ›²çº¿&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;è¿­ä»£æ¬¡æ•°&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;æŸå¤±å€¼&#x27;</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="æ¨¡å‹è¯„ä¼°æŒ‡æ ‡"><a href="#æ¨¡å‹è¯„ä¼°æŒ‡æ ‡" class="headerlink" title="æ¨¡å‹è¯„ä¼°æŒ‡æ ‡"></a>æ¨¡å‹è¯„ä¼°æŒ‡æ ‡</h2><table>
<thead>
<tr>
<th>ä»»åŠ¡ç±»å‹</th>
<th>è¯„ä¼°æŒ‡æ ‡</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>å›å½’</td>
<td>MSE, RMSE, MAE, RÂ²</td>
<td>è¡¡é‡é¢„æµ‹å€¼ä¸å®é™…å€¼çš„å·®è·</td>
</tr>
<tr>
<td>åˆ†ç±»</td>
<td>å‡†ç¡®ç‡, ç²¾ç¡®ç‡, å¬å›ç‡, F1</td>
<td>è¡¡é‡åˆ†ç±»æ•ˆæœ</td>
</tr>
<tr>
<td>èšç±»</td>
<td>è½®å»“ç³»æ•°, Davies-Bouldin</td>
<td>è¡¡é‡èšç±»è´¨é‡</td>
</tr>
</tbody></table>
<h2 id="å®æˆ˜é¡¹ç›®å»ºè®®"><a href="#å®æˆ˜é¡¹ç›®å»ºè®®" class="headerlink" title="å®æˆ˜é¡¹ç›®å»ºè®®"></a>å®æˆ˜é¡¹ç›®å»ºè®®</h2><h3 id="åˆçº§é¡¹ç›®"><a href="#åˆçº§é¡¹ç›®" class="headerlink" title="åˆçº§é¡¹ç›®"></a>åˆçº§é¡¹ç›®</h3><ol>
<li><strong>æˆ¿ä»·é¢„æµ‹</strong> - ä½¿ç”¨æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†</li>
<li><strong>æ³°å¦å°¼å…‹å·ç”Ÿå­˜é¢„æµ‹</strong> - äºŒåˆ†ç±»é—®é¢˜</li>
<li><strong>æ‰‹å†™æ•°å­—è¯†åˆ«</strong> - MNISTæ•°æ®é›†</li>
</ol>
<h3 id="ä¸­çº§é¡¹ç›®"><a href="#ä¸­çº§é¡¹ç›®" class="headerlink" title="ä¸­çº§é¡¹ç›®"></a>ä¸­çº§é¡¹ç›®</h3><ol start="4">
<li><strong>å®¢æˆ·ç»†åˆ†</strong> - K-Meansèšç±»</li>
<li><strong>æƒ…æ„Ÿåˆ†æ</strong> - è‡ªç„¶è¯­è¨€å¤„ç†</li>
<li><strong>è‚¡ç¥¨ä»·æ ¼é¢„æµ‹</strong> - æ—¶é—´åºåˆ—åˆ†æ</li>
</ol>
<h3 id="é«˜çº§é¡¹ç›®"><a href="#é«˜çº§é¡¹ç›®" class="headerlink" title="é«˜çº§é¡¹ç›®"></a>é«˜çº§é¡¹ç›®</h3><ol start="7">
<li><strong>å›¾åƒåˆ†ç±»</strong> - CNNå·ç§¯ç¥ç»ç½‘ç»œ</li>
<li><strong>æ¨èç³»ç»Ÿ</strong> - ååŒè¿‡æ»¤</li>
<li><strong>æ–‡æœ¬ç”Ÿæˆ</strong> - RNN&#x2F;LSTM</li>
</ol>
<h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><h3 id="1-æ•°æ®é¢„å¤„ç†"><a href="#1-æ•°æ®é¢„å¤„ç†" class="headerlink" title="1. æ•°æ®é¢„å¤„ç†"></a>1. æ•°æ®é¢„å¤„ç†</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¤„ç†ç¼ºå¤±å€¼</span></span><br><span class="line">df.fillna(df.mean(), inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç‰¹å¾ç¼©æ”¾</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_scaled = scaler.fit_transform(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–ç åˆ†ç±»å˜é‡</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">le = LabelEncoder()</span><br><span class="line">y_encoded = le.fit_transform(y)</span><br></pre></td></tr></table></figure>

<h3 id="2-äº¤å‰éªŒè¯"><a href="#2-äº¤å‰éªŒè¯" class="headerlink" title="2. äº¤å‰éªŒè¯"></a>2. äº¤å‰éªŒè¯</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line">scores = cross_val_score(model, X, y, cv=<span class="number">5</span>, scoring=<span class="string">&#x27;accuracy&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;äº¤å‰éªŒè¯å‡†ç¡®ç‡: <span class="subst">&#123;scores.mean():<span class="number">.2</span>%&#125;</span> (+/- <span class="subst">&#123;scores.std() * <span class="number">2</span>:<span class="number">.2</span>%&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-è¶…å‚æ•°è°ƒä¼˜"><a href="#3-è¶…å‚æ•°è°ƒä¼˜" class="headerlink" title="3. è¶…å‚æ•°è°ƒä¼˜"></a>3. è¶…å‚æ•°è°ƒä¼˜</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"></span><br><span class="line">param_grid = &#123;</span><br><span class="line">    <span class="string">&#x27;n_estimators&#x27;</span>: [<span class="number">50</span>, <span class="number">100</span>, <span class="number">200</span>],</span><br><span class="line">    <span class="string">&#x27;max_depth&#x27;</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="literal">None</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">grid_search = GridSearchCV(</span><br><span class="line">    RandomForestClassifier(),</span><br><span class="line">    param_grid,</span><br><span class="line">    cv=<span class="number">5</span></span><br><span class="line">)</span><br><span class="line">grid_search.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æœ€ä½³å‚æ•°: <span class="subst">&#123;grid_search.best_params_&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœºå™¨å­¦ä¹ æ˜¯ä¸€ä¸ªå¹¿é˜”çš„é¢†åŸŸï¼Œä»ç®€å•çš„çº¿æ€§å›å½’åˆ°å¤æ‚çš„æ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ¯ç§ç®—æ³•éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ã€‚</p>
<p><strong>å­¦ä¹ è·¯å¾„å»ºè®®ï¼š</strong></p>
<ol>
<li>æŒæ¡åŸºç¡€ç®—æ³•ï¼ˆçº¿æ€§å›å½’ã€é€»è¾‘å›å½’ï¼‰</li>
<li>ç†è§£æ¨¡å‹è¯„ä¼°å’ŒéªŒè¯æ–¹æ³•</li>
<li>å­¦ä¹ é›†æˆå­¦ä¹ æ–¹æ³•ï¼ˆéšæœºæ£®æ—ã€GBDTï¼‰</li>
<li>è¿›å…¥æ·±åº¦å­¦ä¹ é¢†åŸŸ</li>
<li>åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨æ‰€å­¦çŸ¥è¯†</li>
</ol>
<p>è®°ä½ï¼š<strong>å®è·µæ˜¯æœ€å¥½çš„è€å¸ˆï¼</strong> é€‰æ‹©æ„Ÿå…´è¶£çš„æ•°æ®é›†ï¼ŒåŠ¨æ‰‹å®ç°ä½ çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹ é¡¹ç›®å§ï¼</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†æ·±å…¥è®²è§£æ·±åº¦å­¦ä¹ å’Œç¥ç»ç½‘ç»œï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>åç«¯</category>
        <category>AI</category>
      </categories>
      <tags>
        <tag>å®æˆ˜æ•™ç¨‹</tag>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>Python</tag>
        <tag>Scikit-learn</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScriptæ·±å…¥ç†è§£ï¼šé—­åŒ…ã€åŸå‹é“¾ä¸å¼‚æ­¥ç¼–ç¨‹</title>
    <url>/2026/01/20/javascript-advanced-concepts/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>JavaScript ä½œä¸ºä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œæœ‰ä¸€äº›ç‹¬ç‰¹è€Œå¼ºå¤§çš„ç‰¹æ€§ã€‚æ·±å…¥ç†è§£é—­åŒ…ã€åŸå‹é“¾å’Œå¼‚æ­¥ç¼–ç¨‹ï¼Œæ˜¯ä»ä¼šç”¨ JavaScript åˆ°ç²¾é€š JavaScript çš„å¿…ç»ä¹‹è·¯ã€‚æœ¬æ–‡å°†æ·±å…¥å‰–æè¿™äº›æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h2 id="ä¸€ã€é—­åŒ…ï¼ˆClosureï¼‰"><a href="#ä¸€ã€é—­åŒ…ï¼ˆClosureï¼‰" class="headerlink" title="ä¸€ã€é—­åŒ…ï¼ˆClosureï¼‰"></a>ä¸€ã€é—­åŒ…ï¼ˆClosureï¼‰</h2><h3 id="ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ</h3><p>é—­åŒ…æ˜¯æŒ‡å‡½æ•°èƒ½å¤Ÿè®°ä½å¹¶è®¿é—®å…¶è¯æ³•ä½œç”¨åŸŸï¼Œå³ä½¿å‡½æ•°åœ¨å…¶è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºç¡€é—­åŒ…ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createCounter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;  <span class="comment">// ç§æœ‰å˜é‡</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      count++;</span><br><span class="line">      <span class="keyword">return</span> count;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">decrement</span>(<span class="params"></span>) &#123;</span><br><span class="line">      count--;</span><br><span class="line">      <span class="keyword">return</span> count;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">getCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter = <span class="title function_">createCounter</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="title function_">increment</span>()); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="title function_">increment</span>()); <span class="comment">// 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="title function_">getCount</span>());  <span class="comment">// 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="property">count</span>);       <span class="comment">// undefined - æ— æ³•ç›´æ¥è®¿é—®</span></span><br></pre></td></tr></table></figure>

<h3 id="é—­åŒ…çš„åŸç†"><a href="#é—­åŒ…çš„åŸç†" class="headerlink" title="é—­åŒ…çš„åŸç†"></a>é—­åŒ…çš„åŸç†</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outerFunction</span>(<span class="params">outerVar</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">innerFunction</span>(<span class="params">innerVar</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;outerVar:&#x27;</span>, outerVar);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;innerVar:&#x27;</span>, innerVar);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myClosure = <span class="title function_">outerFunction</span>(<span class="string">&#x27;outside&#x27;</span>);</span><br><span class="line"><span class="title function_">myClosure</span>(<span class="string">&#x27;inside&#x27;</span>); <span class="comment">// è¾“å‡º: outerVar: outside, innerVar: inside</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é—­åŒ…çš„ä½œç”¨åŸŸé“¾</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">scopeChain</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">level1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> b = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">level2</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> c = <span class="number">3</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c); <span class="comment">// 1 2 3</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> level2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">level1</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> closure = <span class="title function_">scopeChain</span>();</span><br><span class="line"><span class="title function_">closure</span>(); <span class="comment">// ä»ç„¶å¯ä»¥è®¿é—® a, b, c</span></span><br></pre></td></tr></table></figure>

<h3 id="é—­åŒ…çš„å¸¸è§åº”ç”¨åœºæ™¯"><a href="#é—­åŒ…çš„å¸¸è§åº”ç”¨åœºæ™¯" class="headerlink" title="é—­åŒ…çš„å¸¸è§åº”ç”¨åœºæ™¯"></a>é—­åŒ…çš„å¸¸è§åº”ç”¨åœºæ™¯</h3><h4 id="1-æ•°æ®ç§æœ‰åŒ–"><a href="#1-æ•°æ®ç§æœ‰åŒ–" class="headerlink" title="1. æ•°æ®ç§æœ‰åŒ–"></a>1. æ•°æ®ç§æœ‰åŒ–</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createUser</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> _name = name;  <span class="comment">// ç§æœ‰å˜é‡</span></span><br><span class="line">  <span class="keyword">let</span> _age = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> _name;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">getAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> _age;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setAge</span>(<span class="params">age</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (age &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        _age = age;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;_name&#125;</span>, <span class="subst">$&#123;_age&#125;</span> years old`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = <span class="title function_">createUser</span>(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line">user.<span class="title function_">greet</span>();           <span class="comment">// Hello, I&#x27;m Alice, 0 years old</span></span><br><span class="line">user.<span class="title function_">setAge</span>(<span class="number">25</span>);</span><br><span class="line">user.<span class="title function_">greet</span>();           <span class="comment">// Hello, I&#x27;m Alice, 25 years old</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">_name</span>); <span class="comment">// undefined - æ— æ³•ç›´æ¥è®¿é—®</span></span><br></pre></td></tr></table></figure>

<h4 id="2-å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰"><a href="#2-å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰" class="headerlink" title="2. å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰"></a>2. å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">curry</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">curried</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (args.<span class="property">length</span> &gt;= fn.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...moreArgs</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> curried.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args.<span class="title function_">concat</span>(moreArgs));</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a, b, c</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> curriedAdd = <span class="title function_">curry</span>(add);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">curriedAdd</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>));    <span class="comment">// 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">curriedAdd</span>(<span class="number">1</span>, <span class="number">2</span>)(<span class="number">3</span>));    <span class="comment">// 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">curriedAdd</span>(<span class="number">1</span>)(<span class="number">2</span>, <span class="number">3</span>));    <span class="comment">// 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">curriedAdd</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));    <span class="comment">// 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®é™…åº”ç”¨ï¼šé…ç½®å¤ç”¨</span></span><br><span class="line"><span class="keyword">const</span> fetch = <span class="title function_">curry</span>(<span class="function">(<span class="params">baseUrl, endpoint, params</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">`<span class="subst">$&#123;baseUrl&#125;</span><span class="subst">$&#123;endpoint&#125;</span>`</span>, params);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> githubFetch = <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.github.com&#x27;</span>);</span><br><span class="line"><span class="title function_">githubFetch</span>(<span class="string">&#x27;/users&#x27;</span>, &#123; <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span> &#125;);</span><br><span class="line"><span class="title function_">githubFetch</span>(<span class="string">&#x27;/repos&#x27;</span>, &#123; <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span> &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="3-é˜²æŠ–å’ŒèŠ‚æµ"><a href="#3-é˜²æŠ–å’ŒèŠ‚æµ" class="headerlink" title="3. é˜²æŠ–å’ŒèŠ‚æµ"></a>3. é˜²æŠ–å’ŒèŠ‚æµ</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é˜²æŠ–</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">func, wait, immediate = <span class="literal">false</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">executedFunction</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">later</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      timeout = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">if</span> (!immediate) func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> callNow = immediate &amp;&amp; !timeout;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">    timeout = <span class="built_in">setTimeout</span>(later, wait);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (callNow) func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// èŠ‚æµ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">func, limit</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> inThrottle;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!inThrottle) &#123;</span><br><span class="line">      func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">      inThrottle = <span class="literal">true</span>;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> inThrottle = <span class="literal">false</span>, limit);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> debouncedSearch = <span class="title function_">debounce</span>(<span class="function">(<span class="params">query</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æœç´¢:&#x27;</span>, query);</span><br><span class="line">&#125;, <span class="number">300</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> throttledScroll = <span class="title function_">throttle</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ»šåŠ¨ä½ç½®:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">scrollY</span>);</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<h4 id="4-æ¨¡å—æ¨¡å¼"><a href="#4-æ¨¡å—æ¨¡å¼" class="headerlink" title="4. æ¨¡å—æ¨¡å¼"></a>4. æ¨¡å—æ¨¡å¼</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> myModule = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ç§æœ‰å˜é‡å’Œå‡½æ•°</span></span><br><span class="line">  <span class="keyword">let</span> privateVar = <span class="string">&#x27;private&#x27;</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">privateFunc</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç§æœ‰å‡½æ•°&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å…¬å…±API</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">publicMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">privateFunc</span>();</span><br><span class="line">      <span class="keyword">return</span> privateVar;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">publicVar</span>: <span class="string">&#x27;public&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myModule.<span class="title function_">publicMethod</span>()); <span class="comment">// ç§æœ‰å‡½æ•° \n private</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myModule.<span class="property">publicVar</span>);       <span class="comment">// public</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myModule.<span class="property">privateVar</span>);     <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<h3 id="é—­åŒ…çš„å†…å­˜é—®é¢˜"><a href="#é—­åŒ…çš„å†…å­˜é—®é¢˜" class="headerlink" title="é—­åŒ…çš„å†…å­˜é—®é¢˜"></a>é—­åŒ…çš„å†…å­˜é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âš ï¸ æ½œåœ¨çš„å†…å­˜æ³„æ¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createElements</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000000</span>).<span class="title function_">fill</span>(<span class="string">&#x27;data&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">getArr</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> elements = <span class="title function_">createElements</span>();</span><br><span class="line"><span class="comment">// arr æ•°ç»„ä¼šä¸€ç›´å­˜åœ¨äºå†…å­˜ä¸­ï¼Œç›´åˆ° elements è¢«é”€æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆï¼šåŠæ—¶é‡Šæ”¾å¼•ç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createElements</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1000000</span>).<span class="title function_">fill</span>(<span class="string">&#x27;data&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">getArr</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> arr.<span class="title function_">slice</span>();  <span class="comment">// è¿”å›å‰¯æœ¬</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">destroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// æ¸…ç†å¤§æ•°ç»„</span></span><br><span class="line">      arr.<span class="property">length</span> = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> elements = <span class="title function_">createElements</span>();</span><br><span class="line"><span class="keyword">const</span> data = elements.<span class="title function_">getArr</span>();</span><br><span class="line">elements.<span class="title function_">destroy</span>();  <span class="comment">// æ‰‹åŠ¨é‡Šæ”¾å†…å­˜</span></span><br><span class="line">elements = <span class="literal">null</span>;     <span class="comment">// è§£é™¤å¼•ç”¨</span></span><br></pre></td></tr></table></figure>

<h3 id="ç»å…¸é¢è¯•é¢˜"><a href="#ç»å…¸é¢è¯•é¢˜" class="headerlink" title="ç»å…¸é¢è¯•é¢˜"></a>ç»å…¸é¢è¯•é¢˜</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é¢è¯•é¢˜1ï¼šå¾ªç¯ä¸­çš„é—­åŒ…</span></span><br><span class="line"><span class="comment">// âŒ é”™è¯¯å†™æ³•</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(i), <span class="number">100</span>); <span class="comment">// è¾“å‡º: 3, 3, 3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨ let</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(i), <span class="number">100</span>); <span class="comment">// è¾“å‡º: 0, 1, 2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨é—­åŒ…</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params">j</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(j), <span class="number">100</span>); <span class="comment">// è¾“å‡º: 0, 1, 2</span></span><br><span class="line">  &#125;)(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… è§£å†³æ–¹æ¡ˆ3ï¼šä½¿ç”¨ bind</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="variable language_">console</span>.<span class="property">log</span>.<span class="title function_">bind</span>(<span class="literal">null</span>, i), <span class="number">100</span>); <span class="comment">// è¾“å‡º: 0, 1, 2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¢è¯•é¢˜2ï¼šå®ç°å•ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Singleton</span> = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> instance;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">createInstance</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;Singleton&#x27;</span>,</span><br><span class="line">      <span class="title function_">method</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Singleton method&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">getInstance</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!instance) &#123;</span><br><span class="line">        instance = <span class="title function_">createInstance</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance1 = <span class="title class_">Singleton</span>.<span class="title function_">getInstance</span>();</span><br><span class="line"><span class="keyword">const</span> instance2 = <span class="title class_">Singleton</span>.<span class="title function_">getInstance</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance1 === instance2); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€åŸå‹é“¾ï¼ˆPrototype-Chainï¼‰"><a href="#äºŒã€åŸå‹é“¾ï¼ˆPrototype-Chainï¼‰" class="headerlink" title="äºŒã€åŸå‹é“¾ï¼ˆPrototype Chainï¼‰"></a>äºŒã€åŸå‹é“¾ï¼ˆPrototype Chainï¼‰</h2><h3 id="ç†è§£åŸå‹"><a href="#ç†è§£åŸå‹" class="headerlink" title="ç†è§£åŸå‹"></a>ç†è§£åŸå‹</h3><p>JavaScript æ²¡æœ‰ä¼ ç»Ÿçš„ç±»ç»§æ‰¿ï¼Œè€Œæ˜¯ä½¿ç”¨åŸå‹é“¾å®ç°ç»§æ‰¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸå‹é“¾ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHello</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸå‹é“¾å…³ç³»</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">__proto__</span> === <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>);             <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>);  <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="literal">null</span>);              <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§æŸ¥æ‰¾è¿‡ç¨‹</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>);      <span class="comment">// &#x27;Alice&#x27; - ä»å®ä¾‹æ‰¾åˆ°</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">sayHello</span>);  <span class="comment">// Function - ä»åŸå‹æ‰¾åˆ°</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">toString</span>);  <span class="comment">// Function - ä» Object.prototype æ‰¾åˆ°</span></span><br></pre></td></tr></table></figure>

<h3 id="åŸå‹é“¾ç¤ºæ„å›¾"><a href="#åŸå‹é“¾ç¤ºæ„å›¾" class="headerlink" title="åŸå‹é“¾ç¤ºæ„å›¾"></a>åŸå‹é“¾ç¤ºæ„å›¾</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">person (å®ä¾‹)</span><br><span class="line">  â†“ __proto__</span><br><span class="line">Person.prototype</span><br><span class="line">  â†“ __proto__</span><br><span class="line">Object.prototype</span><br><span class="line">  â†“ __proto__</span><br><span class="line">null</span><br></pre></td></tr></table></figure>

<h3 id="åŸå‹ç»§æ‰¿"><a href="#åŸå‹ç»§æ‰¿" class="headerlink" title="åŸå‹ç»§æ‰¿"></a>åŸå‹ç»§æ‰¿</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. æ„é€ å‡½æ•°ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">eat</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> is eating`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params">name, breed</span>) &#123;</span><br><span class="line">  <span class="title class_">Animal</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name);  <span class="comment">// è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">breed</span> = breed;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®åŸå‹é“¾</span></span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Dog</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bark</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> is barking`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dog = <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&#x27;Buddy&#x27;</span>, <span class="string">&#x27;Golden Retriever&#x27;</span>);</span><br><span class="line">dog.<span class="title function_">eat</span>();   <span class="comment">// Buddy is eating</span></span><br><span class="line">dog.<span class="title function_">bark</span>();  <span class="comment">// Buddy is barking</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. ES6 class ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">eat</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> is eating`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, breed</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name);  <span class="comment">// è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">breed</span> = breed;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">bark</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> is barking`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dog = <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&#x27;Buddy&#x27;</span>, <span class="string">&#x27;Golden Retriever&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="åŸå‹æ–¹æ³•-vs-å®ä¾‹æ–¹æ³•"><a href="#åŸå‹æ–¹æ³•-vs-å®ä¾‹æ–¹æ³•" class="headerlink" title="åŸå‹æ–¹æ³• vs å®ä¾‹æ–¹æ³•"></a>åŸå‹æ–¹æ³• vs å®ä¾‹æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âŒ ä½æ•ˆï¼šæ¯æ¬¡åˆ›å»ºå®ä¾‹éƒ½åˆ›å»ºæ–°æ–¹æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">sayHello</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;  <span class="comment">// å®ä¾‹æ–¹æ³•</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> person2 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Bob&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person1.<span class="property">sayHello</span> === person2.<span class="property">sayHello</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… é«˜æ•ˆï¼šæ–¹æ³•åœ¨åŸå‹ä¸Šå…±äº«</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHello</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;  <span class="comment">// åŸå‹æ–¹æ³•</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> person2 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Bob&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person1.<span class="property">sayHello</span> === person2.<span class="property">sayHello</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="Object-create-å®ç°"><a href="#Object-create-å®ç°" class="headerlink" title="Object.create å®ç°"></a>Object.create å®ç°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç®€åŒ–ç‰ˆ Object.create</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">objectCreate</span>(<span class="params">proto</span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">F</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  F.<span class="property"><span class="keyword">prototype</span></span> = proto;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">F</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>,</span><br><span class="line">  <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> anotherPerson = <span class="title function_">objectCreate</span>(person);</span><br><span class="line">anotherPerson.<span class="property">name</span> = <span class="string">&#x27;Bob&#x27;</span>;</span><br><span class="line">anotherPerson.<span class="title function_">sayHello</span>(); <span class="comment">// Hello, I&#x27;m Bob</span></span><br></pre></td></tr></table></figure>

<h3 id="åŸå‹é“¾å®ç”¨æŠ€å·§"><a href="#åŸå‹é“¾å®ç”¨æŠ€å·§" class="headerlink" title="åŸå‹é“¾å®ç”¨æŠ€å·§"></a>åŸå‹é“¾å®ç”¨æŠ€å·§</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. æ–¹æ³•æ‰©å±•</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">first</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>[<span class="number">0</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">last</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>[<span class="variable language_">this</span>.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].<span class="title function_">first</span>(); <span class="comment">// 1</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].<span class="title function_">last</span>();  <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ£€æµ‹åŸå‹å…³ç³»</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance <span class="keyword">instanceof</span> <span class="title class_">Constructor</span>);  <span class="comment">// instanceof</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Constructor</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="title function_">isPrototypeOf</span>(instance));  <span class="comment">// isPrototypeOf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. è·å–å¯¹è±¡åŸå‹</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(instance));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(instance) === <span class="title class_">Constructor</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. è®¾ç½®å¯¹è±¡åŸå‹</span></span><br><span class="line"><span class="keyword">const</span> obj = <span class="title class_">Object</span>.<span class="title function_">create</span>(&#123; <span class="title function_">protoMethod</span>(<span class="params"></span>) &#123;&#125; &#125;);</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(obj, &#123; <span class="title function_">newMethod</span>(<span class="params"></span>) &#123;&#125; &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€å¼‚æ­¥ç¼–ç¨‹"><a href="#ä¸‰ã€å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="ä¸‰ã€å¼‚æ­¥ç¼–ç¨‹"></a>ä¸‰ã€å¼‚æ­¥ç¼–ç¨‹</h2><h3 id="å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰"><a href="#å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰" class="headerlink" title="å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰"></a>å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºç¡€å›è°ƒ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> data = &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;;</span><br><span class="line">    <span class="title function_">callback</span>(data);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetchData</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ”¶åˆ°æ•°æ®:&#x27;</span>, data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰</span></span><br><span class="line"><span class="title function_">getData</span>(<span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  <span class="title function_">getMoreData</span>(a, <span class="keyword">function</span>(<span class="params">b</span>) &#123;</span><br><span class="line">    <span class="title function_">getMoreData</span>(b, <span class="keyword">function</span>(<span class="params">c</span>) &#123;</span><br><span class="line">      <span class="title function_">getMoreData</span>(c, <span class="keyword">function</span>(<span class="params">d</span>) &#123;</span><br><span class="line">        <span class="comment">// åµŒå¥—å¤ªæ·±ï¼</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºç¡€ Promise</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> success = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">if</span> (success) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è¯·æ±‚å¤±è´¥&#x27;</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ then/catch</span></span><br><span class="line"><span class="title function_">fetchData</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ•°æ®:&#x27;</span>, data))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;é”™è¯¯:&#x27;</span>, error))</span><br><span class="line">  .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å®Œæˆ&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise é“¾å¼è°ƒç”¨</span></span><br><span class="line"><span class="title function_">fetchData</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç¬¬ä¸€æ­¥:&#x27;</span>, data);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetchMoreData</span>(data.<span class="property">id</span>);  <span class="comment">// è¿”å›æ–°çš„ Promise</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">moreData</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç¬¬äºŒæ­¥:&#x27;</span>, moreData);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetchEvenMoreData</span>(moreData.<span class="property">id</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">evenMoreData</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç¬¬ä¸‰æ­¥:&#x27;</span>, evenMoreData);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;ä»»ä½•æ­¥éª¤å‡ºé”™:&#x27;</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Promise-å®ç”¨æ–¹æ³•"><a href="#Promise-å®ç”¨æ–¹æ³•" class="headerlink" title="Promise å®ç”¨æ–¹æ³•"></a>Promise å®ç”¨æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Promise.all - æ‰€æœ‰æˆåŠŸæ‰ç®—æˆåŠŸ</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([</span><br><span class="line">  <span class="title function_">fetchUser</span>(<span class="number">1</span>),</span><br><span class="line">  <span class="title function_">fetchPosts</span>(<span class="number">1</span>),</span><br><span class="line">  <span class="title function_">fetchComments</span>(<span class="number">1</span>)</span><br><span class="line">])</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">[user, posts, comments]</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ‰€æœ‰æ•°æ®:&#x27;</span>, &#123; user, posts, comments &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;ä»»ä½•ä¸€ä¸ªå¤±è´¥:&#x27;</span>, error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.race - è°å¿«ç”¨è°</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>([</span><br><span class="line">  <span class="title function_">fetchFromServer1</span>(),</span><br><span class="line">  <span class="title function_">fetchFromServer2</span>()</span><br><span class="line">])</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æœ€å¿«è¿”å›çš„ç»“æœ:&#x27;</span>, data);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.allSettled - è¿”å›æ‰€æœ‰ç»“æœï¼ˆæ— è®ºæˆåŠŸå¤±è´¥ï¼‰</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([</span><br><span class="line">  <span class="title function_">fetchTask1</span>(),</span><br><span class="line">  <span class="title function_">fetchTask2</span>(),</span><br><span class="line">  <span class="title function_">fetchTask3</span>()</span><br><span class="line">])</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">    results.<span class="title function_">forEach</span>(<span class="function">(<span class="params">result, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (result.<span class="property">status</span> === <span class="string">&#x27;fulfilled&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ä»»åŠ¡<span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>æˆåŠŸ:`</span>, result.<span class="property">value</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ä»»åŠ¡<span class="subst">$&#123;index + <span class="number">1</span>&#125;</span>å¤±è´¥:`</span>, result.<span class="property">reason</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.any - ç¬¬ä¸€ä¸ªæˆåŠŸçš„ç»“æœ</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">any</span>([</span><br><span class="line">  <span class="title function_">fetchFromMirror1</span>(),</span><br><span class="line">  <span class="title function_">fetchFromMirror2</span>(),</span><br><span class="line">  <span class="title function_">fetchFromMirror3</span>()</span><br><span class="line">])</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç¬¬ä¸€ä¸ªæˆåŠŸçš„:&#x27;</span>, data);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;å…¨éƒ¨å¤±è´¥:&#x27;</span>, error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="async-await"><a href="#async-await" class="headerlink" title="async&#x2F;await"></a>async&#x2F;await</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// async/await è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç </span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchAllData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">fetchUser</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç”¨æˆ·:&#x27;</span>, user);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> posts = <span class="keyword">await</span> <span class="title function_">fetchPosts</span>(user.<span class="property">id</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ–‡ç« :&#x27;</span>, posts);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> comments = <span class="keyword">await</span> <span class="title function_">fetchComments</span>(posts[<span class="number">0</span>].<span class="property">id</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è¯„è®º:&#x27;</span>, comments);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; user, posts, comments &#125;;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;é”™è¯¯:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¶è¡Œæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchAllDataParallel</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [user, posts, comments] = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span><br><span class="line">      <span class="title function_">fetchUser</span>(<span class="number">1</span>),</span><br><span class="line">      <span class="title function_">fetchPosts</span>(<span class="number">1</span>),</span><br><span class="line">      <span class="title function_">fetchComments</span>(<span class="number">1</span>)</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; user, posts, comments &#125;;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;é”™è¯¯:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡ºåºæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">processItems</span>(<span class="params">items</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> results = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> items) &#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">processItem</span>(item);</span><br><span class="line">    results.<span class="title function_">push</span>(result);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¶è¡Œæ‰§è¡Œï¼ˆæ‰¹é‡ï¼‰</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">processItems</span>(<span class="params">items, batchSize = <span class="number">5</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> results = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.<span class="property">length</span>; i += batchSize) &#123;</span><br><span class="line">    <span class="keyword">const</span> batch = items.<span class="title function_">slice</span>(i, i + batchSize);</span><br><span class="line">    <span class="keyword">const</span> batchResults = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">      batch.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="title function_">processItem</span>(item))</span><br><span class="line">    );</span><br><span class="line">    results.<span class="title function_">push</span>(...batchResults);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äº‹ä»¶å¾ªç¯ï¼ˆEvent-Loopï¼‰"><a href="#äº‹ä»¶å¾ªç¯ï¼ˆEvent-Loopï¼‰" class="headerlink" title="äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰"></a>äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç†è§£äº‹ä»¶å¾ªç¯</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1. å¼€å§‹&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2. setTimeout (å®ä»»åŠ¡)&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3. Promise (å¾®ä»»åŠ¡)&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;4. ç»“æŸ&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºé¡ºåºï¼š</span></span><br><span class="line"><span class="comment">// 1. å¼€å§‹</span></span><br><span class="line"><span class="comment">// 4. ç»“æŸ</span></span><br><span class="line"><span class="comment">// 3. Promise (å¾®ä»»åŠ¡)</span></span><br><span class="line"><span class="comment">// 2. setTimeout (å®ä»»åŠ¡)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®Œæ•´ç¤ºä¾‹</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;start&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout1&#x27;</span>);</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;timeout2&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;end&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// start</span></span><br><span class="line"><span class="comment">// end</span></span><br><span class="line"><span class="comment">// promise2</span></span><br><span class="line"><span class="comment">// timeout1</span></span><br><span class="line"><span class="comment">// promise1</span></span><br><span class="line"><span class="comment">// timeout2</span></span><br></pre></td></tr></table></figure>

<h3 id="å®æˆ˜ï¼šä¸²è¡Œå’Œå¹¶è¡Œæ§åˆ¶"><a href="#å®æˆ˜ï¼šä¸²è¡Œå’Œå¹¶è¡Œæ§åˆ¶" class="headerlink" title="å®æˆ˜ï¼šä¸²è¡Œå’Œå¹¶è¡Œæ§åˆ¶"></a>å®æˆ˜ï¼šä¸²è¡Œå’Œå¹¶è¡Œæ§åˆ¶</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸²è¡Œæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">series</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> results = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> task <span class="keyword">of</span> tasks) &#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">task</span>();</span><br><span class="line">    results.<span class="title function_">push</span>(result);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¶è¡Œæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">parallel</span>(<span class="params">tasks</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(tasks.<span class="title function_">map</span>(<span class="function"><span class="params">task</span> =&gt;</span> <span class="title function_">task</span>()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™åˆ¶å¹¶å‘æ•°</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">parallelLimit</span>(<span class="params">tasks, limit = <span class="number">2</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> results = [];</span><br><span class="line">  <span class="keyword">const</span> executing = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> task <span class="keyword">of</span> tasks) &#123;</span><br><span class="line">    <span class="keyword">const</span> promise = <span class="title function_">task</span>().<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">      executing.<span class="title function_">splice</span>(executing.<span class="title function_">indexOf</span>(promise), <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    results.<span class="title function_">push</span>(promise);</span><br><span class="line">    executing.<span class="title function_">push</span>(promise);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (executing.<span class="property">length</span> &gt;= limit) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">race</span>(executing);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(results);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> tasks = [</span><br><span class="line">  <span class="function">() =&gt;</span> <span class="title function_">delay</span>(<span class="number">1000</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;Task 1&#x27;</span>),</span><br><span class="line">  <span class="function">() =&gt;</span> <span class="title function_">delay</span>(<span class="number">2000</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;Task 2&#x27;</span>),</span><br><span class="line">  <span class="function">() =&gt;</span> <span class="title function_">delay</span>(<span class="number">1500</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;Task 3&#x27;</span>),</span><br><span class="line">  <span class="function">() =&gt;</span> <span class="title function_">delay</span>(<span class="number">800</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;Task 4&#x27;</span>),</span><br><span class="line">  <span class="function">() =&gt;</span> <span class="title function_">delay</span>(<span class="number">1200</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;Task 5&#x27;</span>),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">parallelLimit</span>(tasks, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// æœ€å¤šåŒæ—¶æ‰§è¡Œ2ä¸ªä»»åŠ¡</span></span><br></pre></td></tr></table></figure>

<h3 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// try-catch æ•è·é”™è¯¯</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleRequest</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetchData</span>();</span><br><span class="line">    <span class="keyword">const</span> processed = <span class="keyword">await</span> <span class="title function_">processData</span>(data);</span><br><span class="line">    <span class="keyword">return</span> processed;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;è¯·æ±‚å¤±è´¥:&#x27;</span>, error);</span><br><span class="line">    <span class="comment">// å¯ä»¥é€‰æ‹©ï¼š</span></span><br><span class="line">    <span class="comment">// 1. è¿”å›é»˜è®¤å€¼</span></span><br><span class="line">    <span class="comment">// return null;</span></span><br><span class="line">    <span class="comment">// 2. é‡è¯•</span></span><br><span class="line">    <span class="comment">// return retryRequest();</span></span><br><span class="line">    <span class="comment">// 3. å‘ä¸ŠæŠ›å‡º</span></span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¨å±€é”™è¯¯å¤„ç†</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;unhandledrejection&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;æœªå¤„ç†çš„ Promise æ‹’ç»:&#x27;</span>, event.<span class="property">reason</span>);</span><br><span class="line">  event.<span class="title function_">preventDefault</span>(); <span class="comment">// é˜»æ­¢é»˜è®¤å¤„ç†</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é«˜çº§ï¼šé‡è¯•æœºåˆ¶</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">retry</span>(<span class="params">fn, options = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;</span><br><span class="line">    times = <span class="number">3</span>,</span><br><span class="line">    delay = <span class="number">1000</span>,</span><br><span class="line">    backoff = <span class="number">2</span></span><br><span class="line">  &#125; = options;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> lastError;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; times; i++) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">await</span> <span class="title function_">fn</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      lastError = error;</span><br><span class="line">      <span class="keyword">if</span> (i &lt; times - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> waitTime = delay * <span class="title class_">Math</span>.<span class="title function_">pow</span>(backoff, i);</span><br><span class="line">        <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, waitTime));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">throw</span> lastError;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">retry</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> <span class="title function_">fetchData</span>(),</span><br><span class="line">  &#123; <span class="attr">times</span>: <span class="number">3</span>, <span class="attr">delay</span>: <span class="number">1000</span>, <span class="attr">backoff</span>: <span class="number">2</span> &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="é—­åŒ…è¦ç‚¹"><a href="#é—­åŒ…è¦ç‚¹" class="headerlink" title="é—­åŒ…è¦ç‚¹"></a>é—­åŒ…è¦ç‚¹</h3><ul>
<li>âœ… å‡½æ•°èƒ½å¤Ÿè®¿é—®å…¶è¯æ³•ä½œç”¨åŸŸ</li>
<li>âœ… ç”¨äºæ•°æ®ç§æœ‰åŒ–ã€å‡½æ•°æŸ¯é‡ŒåŒ–ã€æ¨¡å—æ¨¡å¼</li>
<li>âš ï¸ æ³¨æ„å†…å­˜æ³„æ¼é—®é¢˜</li>
</ul>
<h3 id="åŸå‹é“¾è¦ç‚¹"><a href="#åŸå‹é“¾è¦ç‚¹" class="headerlink" title="åŸå‹é“¾è¦ç‚¹"></a>åŸå‹é“¾è¦ç‚¹</h3><ul>
<li>âœ… JavaScript ä½¿ç”¨åŸå‹é“¾å®ç°ç»§æ‰¿</li>
<li>âœ… <code>__proto__</code> æŒ‡å‘åŸå‹å¯¹è±¡</li>
<li>âœ… åŸå‹æ–¹æ³•æ¯”å®ä¾‹æ–¹æ³•æ›´é«˜æ•ˆ</li>
</ul>
<h3 id="å¼‚æ­¥ç¼–ç¨‹è¦ç‚¹"><a href="#å¼‚æ­¥ç¼–ç¨‹è¦ç‚¹" class="headerlink" title="å¼‚æ­¥ç¼–ç¨‹è¦ç‚¹"></a>å¼‚æ­¥ç¼–ç¨‹è¦ç‚¹</h3><ul>
<li>âœ… å›è°ƒ â†’ Promise â†’ async&#x2F;await</li>
<li>âœ… ç†è§£äº‹ä»¶å¾ªç¯å’Œå®ä»»åŠ¡&#x2F;å¾®ä»»åŠ¡</li>
<li>âœ… åˆç†ä½¿ç”¨å¹¶è¡Œå’Œä¸²è¡Œæ‰§è¡Œ</li>
</ul>
<p><strong>å­¦ä¹ å»ºè®®</strong>ï¼š</p>
<ol>
<li>å¤šå†™ä»£ç å®è·µè¿™äº›æ¦‚å¿µ</li>
<li>é˜…è¯»ä¼˜ç§€å¼€æºä»£ç </li>
<li>åšé¡¹ç›®å·©å›ºçŸ¥è¯†</li>
</ol>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†æ·±å…¥è®²è§£ Vue3 ç»„åˆå¼ API å’Œå“åº”å¼åŸç†ï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å¼€å‘</tag>
        <tag>JavaScript</tag>
        <tag>é—­åŒ…</tag>
        <tag>åŸå‹é“¾</tag>
        <tag>å¼‚æ­¥ç¼–ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue3å®Œå…¨æŒ‡å—ï¼šç»„åˆå¼APIä¸å“åº”å¼åŸç†æ·±åº¦è§£æ</title>
    <url>/2026/01/21/vue3-composition-api/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Vue3 å¸¦æ¥äº†å…¨æ–°çš„ Composition APIï¼ˆç»„åˆå¼ APIï¼‰ï¼Œç›¸æ¯” Options API æä¾›äº†æ›´å¥½çš„é€»è¾‘å¤ç”¨å’Œç±»å‹æ¨æ–­ã€‚åŒæ—¶ï¼ŒVue3 çš„å“åº”å¼ç³»ç»Ÿä¹Ÿä» Object å‡çº§åˆ°äº† Proxyï¼Œæ€§èƒ½å’ŒåŠŸèƒ½éƒ½æœ‰äº†æ˜¾è‘—æå‡ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥è§£æ Vue3 çš„æ ¸å¿ƒç‰¹æ€§ã€‚</p>
<h2 id="ä¸€ã€Composition-API-åŸºç¡€"><a href="#ä¸€ã€Composition-API-åŸºç¡€" class="headerlink" title="ä¸€ã€Composition API åŸºç¡€"></a>ä¸€ã€Composition API åŸºç¡€</h2><h3 id="setup-å‡½æ•°"><a href="#setup-å‡½æ•°" class="headerlink" title="setup å‡½æ•°"></a>setup å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, reactive, computed, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// å“åº”å¼çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> user = <span class="title function_">reactive</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—å±æ€§</span></span><br><span class="line">    <span class="keyword">const</span> doubleCount = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> count.<span class="property">value</span> * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      count.<span class="property">value</span>++;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br><span class="line">    <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç»„ä»¶å·²æŒ‚è½½&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›ç»™æ¨¡æ¿ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      count,</span><br><span class="line">      user,</span><br><span class="line">      doubleCount,</span><br><span class="line">      increment</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="è¯­æ³•ç³–"><a href="#è¯­æ³•ç³–" class="headerlink" title="&lt;script setup&gt; è¯­æ³•ç³–"></a><code>&lt;script setup&gt;</code> è¯­æ³•ç³–</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, computed, onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">// è‡ªåŠ¨æ³¨å†Œçš„å“åº”å¼çŠ¶æ€</span><br><span class="line">const count = ref(0);</span><br><span class="line">const user = reactive(&#123; name: &#x27;Alice&#x27;, age: 25 &#125;);</span><br><span class="line"></span><br><span class="line">// è‡ªåŠ¨æš´éœ²ç»™æ¨¡æ¿</span><br><span class="line">const doubleCount = computed(() =&gt; count.value * 2);</span><br><span class="line"></span><br><span class="line">function increment() &#123;</span><br><span class="line">  count.value++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  console.log(&#x27;ç»„ä»¶å·²æŒ‚è½½&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;Count: &#123;&#123; count &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;Double: &#123;&#123; doubleCount &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;button @click=&quot;increment&quot;&gt;å¢åŠ &lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€å“åº”å¼ç³»ç»Ÿ"><a href="#äºŒã€å“åº”å¼ç³»ç»Ÿ" class="headerlink" title="äºŒã€å“åº”å¼ç³»ç»Ÿ"></a>äºŒã€å“åº”å¼ç³»ç»Ÿ</h2><h3 id="ref-vs-reactive"><a href="#ref-vs-reactive" class="headerlink" title="ref vs reactive"></a>ref vs reactive</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, reactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ref - ç”¨äºåŸºæœ¬ç±»å‹å’Œå¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> user = <span class="title function_">ref</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—®å€¼éœ€è¦ .value</span></span><br><span class="line">count.<span class="property">value</span>++;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">value</span>.<span class="property">name</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// reactive - åªç”¨äºå¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">user</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥è®¿é—®å±æ€§</span></span><br><span class="line">state.<span class="property">count</span>++;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">user</span>.<span class="property">name</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// âš ï¸ reactive è§£æ„å¤±å»å“åº”æ€§</span></span><br><span class="line"><span class="keyword">const</span> &#123; count &#125; = state;</span><br><span class="line">count++; <span class="comment">// ä¸ä¼šè§¦å‘æ›´æ–°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… ä½¿ç”¨ toRefs ä¿æŒå“åº”æ€§</span></span><br><span class="line"><span class="keyword">import</span> &#123; toRefs &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; count &#125; = <span class="title function_">toRefs</span>(state);</span><br><span class="line">count.<span class="property">value</span>++; <span class="comment">// âœ… å“åº”å¼</span></span><br></pre></td></tr></table></figure>

<h3 id="å“åº”å¼è½¬æ¢å·¥å…·"><a href="#å“åº”å¼è½¬æ¢å·¥å…·" class="headerlink" title="å“åº”å¼è½¬æ¢å·¥å…·"></a>å“åº”å¼è½¬æ¢å·¥å…·</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, reactive, toRef, toRefs, readonly, isRef, isReactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// toRef - ä¸ºå“åº”å¼å¯¹è±¡çš„å±æ€§åˆ›å»º ref</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> countRef = <span class="title function_">toRef</span>(state, <span class="string">&#x27;count&#x27;</span>);</span><br><span class="line">countRef.<span class="property">value</span>++; <span class="comment">// âœ… ä¼šæ›´æ–° state.count</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// toRefs - å°†å“åº”å¼å¯¹è±¡è½¬æ¢ä¸ºæ™®é€šå¯¹è±¡ï¼Œæ¯ä¸ªå±æ€§éƒ½æ˜¯ ref</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Vue&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> &#123; count, name &#125; = <span class="title function_">toRefs</span>(state);</span><br><span class="line"></span><br><span class="line"><span class="comment">// readonly - åˆ›å»ºåªè¯»çš„å“åº”å¼å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> original = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> copy = <span class="title function_">readonly</span>(original);</span><br><span class="line"></span><br><span class="line">copy.<span class="property">count</span>++; <span class="comment">// âš ï¸ è­¦å‘Šï¼šä¸èƒ½ä¿®æ”¹åªè¯»å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­ç±»å‹</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isRef</span>(<span class="title function_">ref</span>(<span class="number">0</span>)));         <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isReactive</span>(<span class="title function_">reactive</span>(&#123;&#125;))); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="computed-è®¡ç®—å±æ€§"><a href="#computed-è®¡ç®—å±æ€§" class="headerlink" title="computed è®¡ç®—å±æ€§"></a>computed è®¡ç®—å±æ€§</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åªè¯»è®¡ç®—å±æ€§</span></span><br><span class="line"><span class="keyword">const</span> doubleCount = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> count.<span class="property">value</span> * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯å†™è®¡ç®—å±æ€§</span></span><br><span class="line"><span class="keyword">const</span> doubleCount = <span class="title function_">computed</span>(&#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> count.<span class="property">value</span> * <span class="number">2</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">set</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    count.<span class="property">value</span> = value / <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">doubleCount.<span class="property">value</span> = <span class="number">10</span>; <span class="comment">// ä¼šè®¾ç½® count.value = 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—å±æ€§ç¼“å­˜</span></span><br><span class="line"><span class="keyword">const</span> expensiveValue = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è®¡ç®—ä¸­...&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">heavyComputation</span>(count.<span class="property">value</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åªæœ‰ count æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®—</span></span><br></pre></td></tr></table></figure>

<h3 id="watch-å’Œ-watchEffect"><a href="#watch-å’Œ-watchEffect" class="headerlink" title="watch å’Œ watchEffect"></a>watch å’Œ watchEffect</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, watch, watchEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> user = <span class="title function_">reactive</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// watchEffect - è‡ªåŠ¨è¿½è¸ªä¾èµ–ï¼Œç«‹å³æ‰§è¡Œ</span></span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Count is: <span class="subst">$&#123;count.value&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// watch - æ˜ç¡®æŒ‡å®šæºï¼Œæ‡’æ‰§è¡Œ</span></span><br><span class="line"><span class="title function_">watch</span>(count, <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count changed from <span class="subst">$&#123;oldValue&#125;</span> to <span class="subst">$&#123;newValue&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬å¤šä¸ªæº</span></span><br><span class="line"><span class="title function_">watch</span>([count, <span class="function">() =&gt;</span> user.<span class="property">name</span>], <span class="function">(<span class="params">[newCount, newName]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count: <span class="subst">$&#123;newCount&#125;</span>, name: <span class="subst">$&#123;newName&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·±åº¦ç›‘å¬</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> user,</span><br><span class="line">  <span class="function">(<span class="params">newValue</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;user changed:&#x27;</span>, newValue);</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125; <span class="comment">// æ·±åº¦ç›‘å¬</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç«‹å³æ‰§è¡Œ</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  count,</span><br><span class="line">  <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;count:&#x27;</span>, value);</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// watchEffect åœæ­¢ç›‘å¬</span></span><br><span class="line"><span class="keyword">const</span> stop = <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(count.<span class="property">value</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ stop åœæ­¢ç›‘å¬</span></span><br><span class="line"><span class="title function_">stop</span>();</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€ç”Ÿå‘½å‘¨æœŸé’©å­"><a href="#ä¸‰ã€ç”Ÿå‘½å‘¨æœŸé’©å­" class="headerlink" title="ä¸‰ã€ç”Ÿå‘½å‘¨æœŸé’©å­"></a>ä¸‰ã€ç”Ÿå‘½å‘¨æœŸé’©å­</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  onBeforeMount,</span><br><span class="line">  onMounted,</span><br><span class="line">  onBeforeUpdate,</span><br><span class="line">  onUpdated,</span><br><span class="line">  onBeforeUnmount,</span><br><span class="line">  onUnmounted,</span><br><span class="line">  onErrorCaptured,</span><br><span class="line">  onRenderTracked,</span><br><span class="line">  onRenderTriggered</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">onBeforeMount</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‚è½½ä¹‹å‰&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å·²æŒ‚è½½&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onBeforeUpdate</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ›´æ–°ä¹‹å‰&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onUpdated</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å·²æ›´æ–°&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å¸è½½ä¹‹å‰&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å·²å¸è½½&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯æ•è·</span></span><br><span class="line">    <span class="title function_">onErrorCaptured</span>(<span class="function">(<span class="params">err, instance, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;é”™è¯¯:&#x27;</span>, err);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// é˜»æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒè¯•é’©å­</span></span><br><span class="line">    <span class="title function_">onRenderTracked</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è·Ÿè¸ª:&#x27;</span>, e);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onRenderTriggered</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è§¦å‘:&#x27;</span>, e);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Options API vs Composition API ç”Ÿå‘½å‘¨æœŸå¯¹ç…§</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Options API           | Composition API</span></span><br><span class="line"><span class="comment">---------------------|---------------------</span></span><br><span class="line"><span class="comment">beforeCreate         | setup()</span></span><br><span class="line"><span class="comment">created              | setup()</span></span><br><span class="line"><span class="comment">beforeMount          | onBeforeMount</span></span><br><span class="line"><span class="comment">mounted              | onMounted</span></span><br><span class="line"><span class="comment">beforeUpdate         | onBeforeUpdate</span></span><br><span class="line"><span class="comment">updated              | onUpdated</span></span><br><span class="line"><span class="comment">beforeUnmount        | onBeforeUnmount</span></span><br><span class="line"><span class="comment">unmounted            | onUnmounted</span></span><br><span class="line"><span class="comment">errorCaptured        | onErrorCaptured</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="å››ã€ç»„ä»¶é€šä¿¡"><a href="#å››ã€ç»„ä»¶é€šä¿¡" class="headerlink" title="å››ã€ç»„ä»¶é€šä¿¡"></a>å››ã€ç»„ä»¶é€šä¿¡</h2><h3 id="Props-å’Œ-Emits"><a href="#Props-å’Œ-Emits" class="headerlink" title="Props å’Œ Emits"></a>Props å’Œ Emits</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- çˆ¶ç»„ä»¶ Parent.vue --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Child from &#x27;./Child.vue&#x27;;</span><br><span class="line"></span><br><span class="line">const count = ref(0);</span><br><span class="line">const message = ref(&#x27;Hello from parent&#x27;);</span><br><span class="line"></span><br><span class="line">function receiveFromChild(data) &#123;</span><br><span class="line">  console.log(&#x27;æ¥è‡ªå­ç»„ä»¶:&#x27;, data);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Child</span><br><span class="line">    :count=&quot;count&quot;</span><br><span class="line">    :message=&quot;message&quot;</span><br><span class="line">    @update=&quot;receiveFromChild&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å­ç»„ä»¶ Child.vue --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">// å®šä¹‰ props</span><br><span class="line">const props = defineProps(&#123;</span><br><span class="line">  count: &#123;</span><br><span class="line">    type: Number,</span><br><span class="line">    required: true</span><br><span class="line">  &#125;,</span><br><span class="line">  message: &#123;</span><br><span class="line">    type: String,</span><br><span class="line">    default: &#x27;Default message&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// å®šä¹‰ emits</span><br><span class="line">const emit = defineEmits([&#x27;update&#x27;]);</span><br><span class="line"></span><br><span class="line">function sendToParent() &#123;</span><br><span class="line">  emit(&#x27;update&#x27;, &#123; data: &#x27;Hello from child&#x27; &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;Count: &#123;&#123; props.count &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;Message: &#123;&#123; props.message &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;button @click=&quot;sendToParent&quot;&gt;å‘é€ç»™çˆ¶ç»„ä»¶&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="provide-inject"><a href="#provide-inject" class="headerlink" title="provide&#x2F;inject"></a>provide&#x2F;inject</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¥–å…ˆç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> &#123; provide, ref, readonly &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> theme = <span class="title function_">ref</span>(<span class="string">&#x27;light&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="title function_">readonly</span>(theme)); <span class="comment">// æä¾›åªè¯»ä¸»é¢˜</span></span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;updateTheme&#x27;</span>, <span class="function">(<span class="params">newTheme</span>) =&gt;</span> &#123;</span><br><span class="line">  theme.<span class="property">value</span> = newTheme;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åä»£ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> theme = <span class="title function_">inject</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;light&#x27;</span>); <span class="comment">// é»˜è®¤å€¼ &#x27;light&#x27;</span></span><br><span class="line"><span class="keyword">const</span> updateTheme = <span class="title function_">inject</span>(<span class="string">&#x27;updateTheme&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ TypeScript</span></span><br><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> type &#123; <span class="title class_">InjectionKey</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æ³¨å…¥é”®</span></span><br><span class="line">interface <span class="title class_">Theme</span> &#123;</span><br><span class="line">  <span class="attr">value</span>: string;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">themeKey</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">Theme</span>&gt; = <span class="title class_">Symbol</span>(<span class="string">&#x27;theme&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æä¾›</span></span><br><span class="line"><span class="title function_">provide</span>(themeKey, theme);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å…¥</span></span><br><span class="line"><span class="keyword">const</span> theme = <span class="title function_">inject</span>(themeKey);</span><br></pre></td></tr></table></figure>

<h3 id="expose-å’Œ-ref"><a href="#expose-å’Œ-ref" class="headerlink" title="expose å’Œ ref"></a>expose å’Œ ref</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- å­ç»„ä»¶ Child.vue --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">const count = ref(0);</span><br><span class="line"></span><br><span class="line">function increment() &#123;</span><br><span class="line">  count.value++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æš´éœ²ç»™çˆ¶ç»„ä»¶</span><br><span class="line">defineExpose(&#123;</span><br><span class="line">  count,</span><br><span class="line">  increment</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- çˆ¶ç»„ä»¶ Parent.vue --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Child from &#x27;./Child.vue&#x27;;</span><br><span class="line"></span><br><span class="line">const childRef = ref(null);</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  console.log(childRef.value.count);  // è®¿é—®å­ç»„ä»¶æ•°æ®</span><br><span class="line">  childRef.value.increment();         // è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Child ref=&quot;childRef&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- çˆ¶ç»„ä»¶ --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Child from &#x27;./Child.vue&#x27;;</span><br><span class="line"></span><br><span class="line">const message = ref(&#x27;Hello&#x27;);</span><br><span class="line"></span><br><span class="line">// ç­‰åŒäºï¼š</span><br><span class="line">// &lt;Child :modelValue=&quot;message&quot; @update:modelValue=&quot;message = $event&quot; /&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Child v-model=&quot;message&quot; /&gt;</span><br><span class="line">  &lt;p&gt;Message: &#123;&#123; message &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å­ç»„ä»¶ --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">const props = defineProps([&#x27;modelValue&#x27;]);</span><br><span class="line">const emit = defineEmits([&#x27;update:modelValue&#x27;]);</span><br><span class="line"></span><br><span class="line">function update(e) &#123;</span><br><span class="line">  emit(&#x27;update:modelValue&#x27;, e.target.value);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input :value=&quot;props.modelValue&quot; @input=&quot;update&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å¤šä¸ª v-model --&gt;</span><br><span class="line">&lt;UserName</span><br><span class="line">  v-model:first-name=&quot;first&quot;</span><br><span class="line">  v-model:last-name=&quot;last&quot;</span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">const props = defineProps([&#x27;firstName&#x27;, &#x27;lastName&#x27;]);</span><br><span class="line">const emit = defineEmits([&#x27;update:firstName&#x27;, &#x27;update:lastName&#x27;]);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€Composition-API-é«˜çº§ç”¨æ³•"><a href="#äº”ã€Composition-API-é«˜çº§ç”¨æ³•" class="headerlink" title="äº”ã€Composition API é«˜çº§ç”¨æ³•"></a>äº”ã€Composition API é«˜çº§ç”¨æ³•</h2><h3 id="è‡ªå®šä¹‰ç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼‰"><a href="#è‡ªå®šä¹‰ç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼‰" class="headerlink" title="è‡ªå®šä¹‰ç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼‰"></a>è‡ªå®šä¹‰ç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼‰</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// useMouse.js - é¼ æ ‡ä½ç½®è¿½è¸ª</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref, onMounted, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useMouse</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> x = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> y = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">update</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    x.<span class="property">value</span> = event.<span class="property">pageX</span>;</span><br><span class="line">    y.<span class="property">value</span> = event.<span class="property">pageY</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, update);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, update);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; x, y &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; useMouse &#125; <span class="keyword">from</span> <span class="string">&#x27;./useMouse&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; x, y &#125; = <span class="title function_">useMouse</span>();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Mouse position: &#123;&#123; x &#125;&#125;, &#123;&#123; y &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// useLocalStorage.js - æœ¬åœ°å­˜å‚¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref, watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useLocalStorage</span>(<span class="params">key, defaultValue</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> storedValue = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">  <span class="keyword">const</span> value = <span class="title function_">ref</span>(storedValue ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(storedValue) : defaultValue);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">watch</span>(value, <span class="function">(<span class="params">newValue</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(newValue));</span><br><span class="line">  &#125;, &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;count&#x27;</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// useFetch.js - æ•°æ®è·å–</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useFetch</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> error = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    loading.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">    error.<span class="property">value</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">      data.<span class="property">value</span> = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      error.<span class="property">value</span> = err;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      loading.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetchData</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; data, error, loading, <span class="attr">refresh</span>: fetchData &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> &#123; data, error, loading, refresh &#125; = <span class="title function_">useFetch</span>(<span class="string">&#x27;/api/user&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="å“åº”å¼å·¥å…·å‡½æ•°"><a href="#å“åº”å¼å·¥å…·å‡½æ•°" class="headerlink" title="å“åº”å¼å·¥å…·å‡½æ•°"></a>å“åº”å¼å·¥å…·å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. é˜²æŠ–</span></span><br><span class="line"><span class="keyword">import</span> &#123; watch, watchEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useDebounce</span>(<span class="params">fn, delay = <span class="number">300</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timeoutId = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timeoutId);</span><br><span class="line">    timeoutId = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    &#125;, delay);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å“åº”å¼é˜²æŠ–</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">watchDebounce</span>(<span class="params">source, cb, delay = <span class="number">300</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timeoutId = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">watch</span>(</span><br><span class="line">    source,</span><br><span class="line">    <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeoutId);</span><br><span class="line">      timeoutId = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">cb</span>(...args);</span><br><span class="line">      &#125;, delay);</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. èŠ‚æµ</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useThrottle</span>(<span class="params">fn, delay = <span class="number">300</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> lastCall = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">if</span> (now - lastCall &gt;= delay) &#123;</span><br><span class="line">      lastCall = now;</span><br><span class="line">      fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. useArray - æ•°ç»„æ“ä½œ</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useArray</span>(<span class="params">initial = []</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> array = <span class="title function_">ref</span>(initial);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">push</span> = (<span class="params">item</span>) =&gt; array.<span class="property">value</span>.<span class="title function_">push</span>(item);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">pop</span> = (<span class="params"></span>) =&gt; array.<span class="property">value</span>.<span class="title function_">pop</span>();</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">shift</span> = (<span class="params"></span>) =&gt; array.<span class="property">value</span>.<span class="title function_">shift</span>();</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">unshift</span> = (<span class="params">item</span>) =&gt; array.<span class="property">value</span>.<span class="title function_">unshift</span>(item);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">remove</span> = (<span class="params">index</span>) =&gt; array.<span class="property">value</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    array,</span><br><span class="line">    push,</span><br><span class="line">    pop,</span><br><span class="line">    shift,</span><br><span class="line">    unshift,</span><br><span class="line">    remove</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. useCounter - è®¡æ•°å™¨</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useCounter</span>(<span class="params">initial = <span class="number">0</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> count = <span class="title function_">ref</span>(initial);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; count.<span class="property">value</span>++;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">decrement</span> = (<span class="params"></span>) =&gt; count.<span class="property">value</span>--;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">reset</span> = (<span class="params"></span>) =&gt; count.<span class="property">value</span> = initial;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setValue</span> = (<span class="params">value</span>) =&gt; count.<span class="property">value</span> = value;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    count,</span><br><span class="line">    increment,</span><br><span class="line">    decrement,</span><br><span class="line">    reset,</span><br><span class="line">    setValue</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€å“åº”å¼åŸç†æ·±åº¦è§£æ"><a href="#å…­ã€å“åº”å¼åŸç†æ·±åº¦è§£æ" class="headerlink" title="å…­ã€å“åº”å¼åŸç†æ·±åº¦è§£æ"></a>å…­ã€å“åº”å¼åŸç†æ·±åº¦è§£æ</h2><h3 id="Proxy-vs-Object-defineProperty"><a href="#Proxy-vs-Object-defineProperty" class="headerlink" title="Proxy vs Object.defineProperty"></a>Proxy vs Object.defineProperty</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue2 - Object.defineProperty</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">defineReactive</span>(<span class="params">obj, key, val</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> dep = []; <span class="comment">// ä¾èµ–æ”¶é›†</span></span><br><span class="line"></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, key, &#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">      dep.<span class="title function_">forEach</span>(<span class="function"><span class="params">fn</span> =&gt;</span> <span class="title function_">fn</span>()); <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">      <span class="keyword">return</span> val;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">set</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (newVal !== val) &#123;</span><br><span class="line">        val = newVal;</span><br><span class="line">        dep.<span class="title function_">forEach</span>(<span class="function"><span class="params">fn</span> =&gt;</span> <span class="title function_">fn</span>()); <span class="comment">// è§¦å‘æ›´æ–°</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âš ï¸ Vue2 çš„é™åˆ¶</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line"><span class="title function_">defineReactive</span>(obj, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&#x27;Bob&#x27;</span>; <span class="comment">// âœ… å¯ä»¥æ£€æµ‹åˆ°</span></span><br><span class="line">obj.<span class="property">age</span> = <span class="number">25</span>;     <span class="comment">// âŒ æ— æ³•æ£€æµ‹æ–°å¢å±æ€§</span></span><br><span class="line"><span class="keyword">delete</span> obj.<span class="property">name</span>;  <span class="comment">// âŒ æ— æ³•æ£€æµ‹åˆ é™¤</span></span><br><span class="line">obj.<span class="property">arr</span>.<span class="title function_">push</span>(<span class="number">1</span>);  <span class="comment">// âŒ æ— æ³•æ£€æµ‹æ•°ç»„ç´¢å¼•å˜åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Vue3 - Proxy</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reactive</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> handlers = &#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params">target, key, receiver</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, key, receiver);</span><br><span class="line">      <span class="comment">// ä¾èµ–æ”¶é›†</span></span><br><span class="line">      <span class="title function_">track</span>(target, key);</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">set</span>(<span class="params">target, key, value, receiver</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> oldValue = target[key];</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, key, value, receiver);</span><br><span class="line">      <span class="keyword">if</span> (oldValue !== value) &#123;</span><br><span class="line">        <span class="comment">// è§¦å‘æ›´æ–°</span></span><br><span class="line">        <span class="title function_">trigger</span>(target, key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(obj, handlers);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… Vue3 å¯ä»¥æ£€æµ‹æ‰€æœ‰æ“ä½œ</span></span><br><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;);</span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&#x27;Bob&#x27;</span>;  <span class="comment">// âœ… å¯ä»¥æ£€æµ‹</span></span><br><span class="line">obj.<span class="property">age</span> = <span class="number">25</span>;      <span class="comment">// âœ… å¯ä»¥æ£€æµ‹</span></span><br><span class="line"><span class="keyword">delete</span> obj.<span class="property">name</span>;   <span class="comment">// âœ… å¯ä»¥æ£€æµ‹</span></span><br></pre></td></tr></table></figure>

<h3 id="ç®€åŒ–çš„å“åº”å¼ç³»ç»Ÿå®ç°"><a href="#ç®€åŒ–çš„å“åº”å¼ç³»ç»Ÿå®ç°" class="headerlink" title="ç®€åŒ–çš„å“åº”å¼ç³»ç»Ÿå®ç°"></a>ç®€åŒ–çš„å“åº”å¼ç³»ç»Ÿå®ç°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¾èµ–æ”¶é›†</span></span><br><span class="line"><span class="keyword">let</span> activeEffect = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">const</span> targetMap = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">track</span>(<span class="params">target, key</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!activeEffect) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> depsMap = targetMap.<span class="title function_">get</span>(target);</span><br><span class="line">  <span class="keyword">if</span> (!depsMap) &#123;</span><br><span class="line">    depsMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">    targetMap.<span class="title function_">set</span>(target, depsMap);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> dep = depsMap.<span class="title function_">get</span>(key);</span><br><span class="line">  <span class="keyword">if</span> (!dep) &#123;</span><br><span class="line">    dep = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">    depsMap.<span class="title function_">set</span>(key, dep);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  dep.<span class="title function_">add</span>(activeEffect);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘æ›´æ–°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">trigger</span>(<span class="params">target, key</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> depsMap = targetMap.<span class="title function_">get</span>(target);</span><br><span class="line">  <span class="keyword">if</span> (!depsMap) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dep = depsMap.<span class="title function_">get</span>(key);</span><br><span class="line">  <span class="keyword">if</span> (dep) &#123;</span><br><span class="line">    dep.<span class="title function_">forEach</span>(<span class="function"><span class="params">effect</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">effect</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å“åº”å¼å¯¹è±¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reactive</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(obj, &#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params">target, key, receiver</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, key, receiver);</span><br><span class="line">      <span class="title function_">track</span>(target, key);</span><br><span class="line">      <span class="comment">// åµŒå¥—å¯¹è±¡é€’å½’ä»£ç†</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> result === <span class="string">&#x27;object&#x27;</span> &amp;&amp; result !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reactive</span>(result);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">set</span>(<span class="params">target, key, value, receiver</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> oldValue = target[key];</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, key, value, receiver);</span><br><span class="line">      <span class="keyword">if</span> (oldValue !== value) &#123;</span><br><span class="line">        <span class="title function_">trigger</span>(target, key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ref å®ç°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ref</span>(<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_value</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span> <span class="title function_">value</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_value</span> = newValue;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">_value</span>: value</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// effect å®ç°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">effect</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  activeEffect = fn;</span><br><span class="line">  <span class="title function_">fn</span>();</span><br><span class="line">  activeEffect = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">effect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Count is:&#x27;</span>, state.<span class="property">count</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">state.<span class="property">count</span>++; <span class="comment">// è‡ªåŠ¨è§¦å‘ effect</span></span><br></pre></td></tr></table></figure>

<h3 id="computed-å®ç°"><a href="#computed-å®ç°" class="headerlink" title="computed å®ç°"></a>computed å®ç°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">computed</span>(<span class="params">getter</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> _value;</span><br><span class="line">  <span class="keyword">let</span> _dirty = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> effectFn = <span class="title function_">effect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    _value = <span class="title function_">getter</span>();</span><br><span class="line">    _dirty = <span class="literal">false</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">      <span class="keyword">if</span> (_dirty) &#123;</span><br><span class="line">        <span class="title function_">effectFn</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> _value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> doubleCount = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> count.<span class="property">value</span> * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(doubleCount.<span class="property">value</span>); <span class="comment">// 0</span></span><br><span class="line">count.<span class="property">value</span>++;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(doubleCount.<span class="property">value</span>); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€æ€§èƒ½ä¼˜åŒ–"><a href="#ä¸ƒã€æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="ä¸ƒã€æ€§èƒ½ä¼˜åŒ–"></a>ä¸ƒã€æ€§èƒ½ä¼˜åŒ–</h2><h3 id="è™šæ‹ŸDOMå’ŒDiffç®—æ³•"><a href="#è™šæ‹ŸDOMå’ŒDiffç®—æ³•" class="headerlink" title="è™šæ‹ŸDOMå’ŒDiffç®—æ³•"></a>è™šæ‹ŸDOMå’ŒDiffç®—æ³•</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue3 ä½¿ç”¨æœ€é•¿é€’å¢å­åºåˆ—ç®—æ³•ä¼˜åŒ– diff</span></span><br><span class="line"><span class="comment">// æ—¶é—´å¤æ‚åº¦ä» O(nÂ³) é™ä½åˆ° O(n)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">patchKeyedChildren</span>(<span class="params">c1, c2, container</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> e1 = c1.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> e2 = c2.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. ä»å‰å¾€ååŒæ­¥</span></span><br><span class="line">  <span class="keyword">while</span> (i &lt;= e1 &amp;&amp; i &lt;= e2) &#123;</span><br><span class="line">    <span class="keyword">const</span> n1 = c1[i];</span><br><span class="line">    <span class="keyword">const</span> n2 = c2[i];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isSameVNodeType</span>(n1, n2)) &#123;</span><br><span class="line">      <span class="title function_">patch</span>(n1, n2);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    i++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. ä»åå¾€å‰åŒæ­¥</span></span><br><span class="line">  <span class="keyword">while</span> (i &lt;= e1 &amp;&amp; i &lt;= e2) &#123;</span><br><span class="line">    <span class="keyword">const</span> n1 = c1[e1];</span><br><span class="line">    <span class="keyword">const</span> n2 = c2[e2];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isSameVNodeType</span>(n1, n2)) &#123;</span><br><span class="line">      <span class="title function_">patch</span>(n1, n2);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    e1--;</span><br><span class="line">    e2--;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. å¤„ç†æ–°å¢èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">if</span> (i &gt; e1) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &lt;= e2) &#123;</span><br><span class="line">      <span class="keyword">const</span> nextPos = e2 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">const</span> anchor = nextPos &lt; c2.<span class="property">length</span> ? c2[nextPos] : <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">while</span> (i &lt;= e2) &#123;</span><br><span class="line">        <span class="title function_">patch</span>(<span class="literal">null</span>, c2[i], anchor);</span><br><span class="line">        i++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. å¤„ç†åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (i &gt; e2) &#123;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= e1) &#123;</span><br><span class="line">      <span class="title function_">unmount</span>(c1[i]);</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5. å¤„ç†æœªçŸ¥åºåˆ—ï¼ˆä½¿ç”¨æœ€é•¿é€’å¢å­åºåˆ—ï¼‰</span></span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> s1 = i;</span><br><span class="line">    <span class="keyword">const</span> s2 = i;</span><br><span class="line">    <span class="keyword">const</span> keyToNewIndexMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = s2; i &lt;= e2; i++) &#123;</span><br><span class="line">      keyToNewIndexMap.<span class="title function_">set</span>(c2[i].<span class="property">key</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> j;</span><br><span class="line">    <span class="keyword">let</span> patched = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> toBePatched = e2 - s2 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> newIndexToOldIndexMap = <span class="keyword">new</span> <span class="title class_">Array</span>(toBePatched).<span class="title function_">fill</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = s1; i &lt;= e1; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (patched &gt;= toBePatched) &#123;</span><br><span class="line">        <span class="title function_">unmount</span>(c1[i]);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> newIndex;</span><br><span class="line">      <span class="keyword">if</span> (c1[i].<span class="property">key</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">        newIndex = keyToNewIndexMap.<span class="title function_">get</span>(c1[i].<span class="property">key</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = s2; j &lt;= e2; j++) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_">isSameVNodeType</span>(c1[i], c2[j])) &#123;</span><br><span class="line">            newIndex = j;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (newIndex === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="title function_">unmount</span>(c1[i]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        newIndexToOldIndexMap[newIndex - s2] = i + <span class="number">1</span>;</span><br><span class="line">        <span class="title function_">patch</span>(c1[i], c2[newIndex]);</span><br><span class="line">        patched++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> increasingNewIndexSequence = <span class="title function_">getSequence</span>(newIndexToOldIndexMap);</span><br><span class="line">    j = increasingNewIndexSequence.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = toBePatched - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      <span class="keyword">const</span> nextIndex = s2 + i;</span><br><span class="line">      <span class="keyword">const</span> nextChild = c2[nextIndex];</span><br><span class="line">      <span class="keyword">const</span> anchor = nextIndex + <span class="number">1</span> &lt; c2.<span class="property">length</span> ? c2[nextIndex + <span class="number">1</span>] : <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (newIndexToOldIndexMap[i] === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="title function_">patch</span>(<span class="literal">null</span>, nextChild, anchor);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; <span class="number">0</span> || i !== increasingNewIndexSequence[j]) &#123;</span><br><span class="line">          <span class="title function_">move</span>(nextChild, anchor);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          j--;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»„ä»¶ä¼˜åŒ–æŠ€å·§"><a href="#ç»„ä»¶ä¼˜åŒ–æŠ€å·§" class="headerlink" title="ç»„ä»¶ä¼˜åŒ–æŠ€å·§"></a>ç»„ä»¶ä¼˜åŒ–æŠ€å·§</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- 1. ä½¿ç”¨ v-once åªæ¸²æŸ“ä¸€æ¬¡ --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-once&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123; title &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; staticContent &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; dynamicContent &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 2. ä½¿ç”¨ v-memo è·³è¿‡ä¸å¿…è¦çš„æ›´æ–° --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-for=&quot;item in list&quot; :key=&quot;item.id&quot; v-memo=&quot;[item.id, item.selected]&quot;&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; item.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;span v-if=&quot;item.selected&quot;&gt;Selected&lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 3. å¼‚æ­¥ç»„ä»¶ --&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; defineAsyncComponent &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">const AsyncComponent = defineAsyncComponent(() =&gt;</span><br><span class="line">  import(&#x27;./HeavyComponent.vue&#x27;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">// å¸¦é…ç½®çš„å¼‚æ­¥ç»„ä»¶</span><br><span class="line">const AsyncComponentWithOptions = defineAsyncComponent(&#123;</span><br><span class="line">  loader: () =&gt; import(&#x27;./HeavyComponent.vue&#x27;),</span><br><span class="line">  loadingComponent: LoadingSpinner,</span><br><span class="line">  errorComponent: ErrorComponent,</span><br><span class="line">  delay: 200,</span><br><span class="line">  timeout: 3000</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 4. keep-alive ç¼“å­˜ç»„ä»¶ --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;keep-alive :include=&quot;[&#x27;Home&#x27;, &#x27;About&#x27;]&quot; :max=&quot;10&quot;&gt;</span><br><span class="line">    &lt;component :is=&quot;currentComponent&quot; /&gt;</span><br><span class="line">  &lt;/keep-alive&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h2 id="å…«ã€TypeScript-æ”¯æŒ"><a href="#å…«ã€TypeScript-æ”¯æŒ" class="headerlink" title="å…«ã€TypeScript æ”¯æŒ"></a>å…«ã€TypeScript æ”¯æŒ</h2><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸º props å®šä¹‰ç±»å‹</span></span><br><span class="line">&lt;script setup lang=<span class="string">&quot;ts&quot;</span>&gt;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> props = defineProps&lt;&#123;</span><br><span class="line">  <span class="attr">user</span>: <span class="title class_">User</span>;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦é»˜è®¤å€¼</span></span><br><span class="line"><span class="keyword">const</span> props = <span class="title function_">withDefaults</span>(defineProps&lt;&#123;</span><br><span class="line">  <span class="attr">user</span>?: <span class="title class_">User</span>;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;&gt;(), &#123;</span><br><span class="line">  <span class="attr">user</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">age</span>: <span class="number">0</span> &#125;),</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸º emits å®šä¹‰ç±»å‹</span></span><br><span class="line"><span class="keyword">const</span> emit = defineEmits&lt;&#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&#x27;update&#x27;</span>, <span class="attr">value</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&#x27;delete&#x27;</span>, <span class="attr">id</span>: <span class="built_in">number</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ref æ·»åŠ ç±»å‹</span></span><br><span class="line"><span class="keyword">const</span> count = ref&lt;<span class="built_in">number</span>&gt;(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> user = ref&lt;<span class="title class_">User</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// reactive æ·»åŠ ç±»å‹</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">State</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">user</span>: <span class="title class_">User</span> | <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> state = reactive&lt;<span class="title class_">State</span>&gt;(&#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="literal">null</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// computed æ·»åŠ ç±»å‹</span></span><br><span class="line"><span class="keyword">const</span> doubleCount = computed&lt;<span class="built_in">number</span>&gt;(<span class="function">() =&gt;</span> count.<span class="property">value</span> * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»„åˆå¼å‡½æ•°æ·»åŠ ç±»å‹</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useMouse</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> x = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> y = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="title class_">Readonly</span>&lt;<span class="title class_">Ref</span>&lt;<span class="built_in">number</span>&gt;&gt;,</span><br><span class="line">    <span class="attr">y</span>: <span class="title class_">Readonly</span>&lt;<span class="title class_">Ref</span>&lt;<span class="built_in">number</span>&gt;&gt;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="Vue3-æ ¸å¿ƒä¼˜åŠ¿"><a href="#Vue3-æ ¸å¿ƒä¼˜åŠ¿" class="headerlink" title="Vue3 æ ¸å¿ƒä¼˜åŠ¿"></a>Vue3 æ ¸å¿ƒä¼˜åŠ¿</h3><ul>
<li>âœ… Composition API æä¾›æ›´å¥½çš„é€»è¾‘å¤ç”¨</li>
<li>âœ… Proxy å“åº”å¼ç³»ç»Ÿæ›´å¼ºå¤§</li>
<li>âœ… æ›´å¥½çš„ TypeScript æ”¯æŒ</li>
<li>âœ… æ€§èƒ½æå‡ï¼ˆæ›´å°çš„åŒ…ï¼Œæ›´å¿«çš„æ¸²æŸ“ï¼‰</li>
<li>âœ… Tree-shaking å‹å¥½</li>
</ul>
<h3 id="å­¦ä¹ è·¯å¾„"><a href="#å­¦ä¹ è·¯å¾„" class="headerlink" title="å­¦ä¹ è·¯å¾„"></a>å­¦ä¹ è·¯å¾„</h3><ol>
<li>æŒæ¡ setup å’ŒåŸºç¡€ API</li>
<li>ç†è§£å“åº”å¼åŸç†</li>
<li>å­¦ä¹ ç»„åˆå¼å‡½æ•°</li>
<li>å®æˆ˜é¡¹ç›®å·©å›º</li>
<li>æ€§èƒ½ä¼˜åŒ–</li>
</ol>
<h3 id="æ¨èèµ„æº"><a href="#æ¨èèµ„æº" class="headerlink" title="æ¨èèµ„æº"></a>æ¨èèµ„æº</h3><ul>
<li><a href="https://cn.vuejs.org/">Vue3 å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://github.com/vuejs/core">Vue3 æºç è§£æ</a></li>
</ul>
<p>Vue3 çš„ Composition API è®©ä»£ç æ›´æ˜“ç»´æŠ¤å’Œæµ‹è¯•ï¼Œæ˜¯ç°ä»£ Vue å¼€å‘çš„é¦–é€‰æ–¹å¼ï¼</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†æ·±å…¥å‰ç«¯å·¥ç¨‹åŒ–å’Œæ„å»ºä¼˜åŒ–ï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å¼€å‘</tag>
        <tag>Vue3</tag>
        <tag>Composition API</tag>
        <tag>å“åº”å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>TypeScriptå®Œå…¨æŒ‡å—ï¼šä»åŸºç¡€åˆ°é«˜çº§ç±»å‹ç³»ç»Ÿ</title>
    <url>/2026/01/21/typescript-advanced-guide/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>TypeScript ä¸º JavaScript æ·»åŠ äº†å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿï¼Œè®©ä»£ç æ›´å¥å£®ã€æ›´æ˜“ç»´æŠ¤ã€‚æœ¬æ–‡å°†æ·±å…¥è®²è§£ TypeScript çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä»åŸºç¡€ç±»å‹åˆ°é«˜çº§ç‰¹æ€§ã€‚</p>
<h2 id="ä¸€ã€åŸºç¡€ç±»å‹"><a href="#ä¸€ã€åŸºç¡€ç±»å‹" class="headerlink" title="ä¸€ã€åŸºç¡€ç±»å‹"></a>ä¸€ã€åŸºç¡€ç±»å‹</h2><h3 id="åŸºæœ¬ç±»å‹æ³¨è§£"><a href="#åŸºæœ¬ç±»å‹æ³¨è§£" class="headerlink" title="åŸºæœ¬ç±»å‹æ³¨è§£"></a>åŸºæœ¬ç±»å‹æ³¨è§£</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºç¡€ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">username</span>: <span class="built_in">string</span> = <span class="string">&#x27;Alice&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">age</span>: <span class="built_in">number</span> = <span class="number">25</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">isActive</span>: <span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">nothing</span>: <span class="literal">null</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">notDefined</span>: <span class="literal">undefined</span> = <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç»„</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">numbers</span>: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="attr">strings</span>: <span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt; = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ƒç»„ï¼ˆå›ºå®šé•¿åº¦å’Œç±»å‹ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">user</span>: [<span class="built_in">string</span>, <span class="built_in">number</span>] = [<span class="string">&#x27;Alice&#x27;</span>, <span class="number">25</span>];</span><br><span class="line">user[<span class="number">0</span>]; <span class="comment">// &#x27;Alice&#x27;</span></span><br><span class="line">user[<span class="number">1</span>]; <span class="comment">// 25</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æšä¸¾</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span> &#123;</span><br><span class="line">  <span class="title class_">Up</span> = <span class="number">1</span>,</span><br><span class="line">  <span class="title class_">Down</span>,</span><br><span class="line">  <span class="title class_">Left</span>,</span><br><span class="line">  <span class="title class_">Right</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">dir</span>: <span class="title class_">Direction</span> = <span class="title class_">Direction</span>.<span class="property">Up</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—ç¬¦ä¸²æšä¸¾</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">LogLevel</span> &#123;</span><br><span class="line">  <span class="variable constant_">INFO</span> = <span class="string">&#x27;INFO&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">WARN</span> = <span class="string">&#x27;WARN&#x27;</span>,</span><br><span class="line">  <span class="variable constant_">ERROR</span> = <span class="string">&#x27;ERROR&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// any - ä»»æ„ç±»å‹ï¼ˆå°½é‡é¿å…ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">anything</span>: <span class="built_in">any</span> = <span class="number">42</span>;</span><br><span class="line">anything = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">anything = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// unknown - ç±»å‹å®‰å…¨çš„ any</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">value</span>: <span class="built_in">unknown</span> = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value * <span class="number">2</span>); <span class="comment">// âœ… TypeScript çŸ¥é“å®ƒæ˜¯ number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// void - æ— è¿”å›å€¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params"><span class="attr">message</span>: <span class="built_in">string</span></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(message);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// never - æ°¸ä¸è¿”å›</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">error</span>(<span class="params"><span class="attr">message</span>: <span class="built_in">string</span></span>): <span class="built_in">never</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(message);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// object - éåŸå§‹ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">obj</span>: <span class="built_in">object</span> = &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">better</span>: &#123; <span class="attr">name</span>: <span class="built_in">string</span> &#125; = &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ç±»å‹æ¨æ–­"><a href="#ç±»å‹æ¨æ–­" class="headerlink" title="ç±»å‹æ¨æ–­"></a>ç±»å‹æ¨æ–­</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TypeScript ä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> count = <span class="number">0</span>; <span class="comment">// æ¨æ–­ä¸º number</span></span><br><span class="line">count = <span class="string">&#x27;hello&#x27;</span>; <span class="comment">// âŒ é”™è¯¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°è¿”å›ç±»å‹æ¨æ–­</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"><span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b; <span class="comment">// æ¨æ–­è¿”å›ç±»å‹ä¸º number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€ä½³é€šç”¨ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">0</span>, <span class="number">1</span>, <span class="literal">null</span>]; <span class="comment">// æ¨æ–­ä¸º (number | null)[]</span></span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€å¯¹è±¡ç±»å‹"><a href="#äºŒã€å¯¹è±¡ç±»å‹" class="headerlink" title="äºŒã€å¯¹è±¡ç±»å‹"></a>äºŒã€å¯¹è±¡ç±»å‹</h2><h3 id="æ¥å£ï¼ˆInterfaceï¼‰"><a href="#æ¥å£ï¼ˆInterfaceï¼‰" class="headerlink" title="æ¥å£ï¼ˆInterfaceï¼‰"></a>æ¥å£ï¼ˆInterfaceï¼‰</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºç¡€æ¥å£</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">email</span>?: <span class="built_in">string</span>; <span class="comment">// å¯é€‰å±æ€§</span></span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">id</span>: <span class="built_in">number</span>; <span class="comment">// åªè¯»å±æ€§</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">user</span>: <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">25</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// user.id = 2; // âŒ é”™è¯¯ï¼šåªè¯»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ç±»å‹æ¥å£</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">SearchFunc</span> &#123;</span><br><span class="line">  (<span class="attr">source</span>: <span class="built_in">string</span>, <span class="attr">subString</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">mySearch</span>: <span class="title class_">SearchFunc</span> = <span class="keyword">function</span>(<span class="params">src, sub</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> src.<span class="title function_">includes</span>(sub);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç´¢å¼•ç­¾å</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">StringArray</span> &#123;</span><br><span class="line">  [<span class="attr">index</span>: <span class="built_in">number</span>]: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">myArray</span>: <span class="title class_">StringArray</span> = [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">StringDictionary</span> &#123;</span><br><span class="line">  [<span class="attr">key</span>: <span class="built_in">string</span>]: <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">myDict</span>: <span class="title class_">StringDictionary</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">25</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="ç±»å‹åˆ«åï¼ˆType-Aliasï¼‰"><a href="#ç±»å‹åˆ«åï¼ˆType-Aliasï¼‰" class="headerlink" title="ç±»å‹åˆ«åï¼ˆType Aliasï¼‰"></a>ç±»å‹åˆ«åï¼ˆType Aliasï¼‰</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºç¡€ç±»å‹åˆ«å</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">ID</span> = <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserId</span> = <span class="variable constant_">ID</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ProductId</span> = <span class="variable constant_">ID</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è”åˆç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Status</span> = <span class="string">&#x27;pending&#x27;</span> | <span class="string">&#x27;success&#x27;</span> | <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleStatus</span>(<span class="params"><span class="attr">status</span>: <span class="title class_">Status</span></span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;pending&#x27;</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;success&#x27;</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;error&#x27;</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// äº¤å‰ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Employee</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">employeeId</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Manager</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">department</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">EmployeeManager</span> = <span class="title class_">Employee</span> &amp; <span class="title class_">Manager</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">person</span>: <span class="title class_">EmployeeManager</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>,</span><br><span class="line">  <span class="attr">employeeId</span>: <span class="number">123</span>,</span><br><span class="line">  <span class="attr">department</span>: <span class="string">&#x27;Engineering&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤æ‚ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">AsyncReturnType</span>&lt;T <span class="title function_">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>) =&gt; <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt;&gt;</span><br><span class="line">  = T <span class="title function_">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>) =&gt; <span class="title class_">Promise</span>&lt;infer R&gt; ? R : <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¡ä»¶ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">NonNullable</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="literal">null</span> | <span class="literal">undefined</span> ? <span class="built_in">never</span> : T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Result</span> = <span class="title class_">NonNullable</span>&lt;<span class="built_in">string</span> | <span class="literal">null</span>&gt;; <span class="comment">// string</span></span><br></pre></td></tr></table></figure>

<h3 id="ç±»ç±»å‹"><a href="#ç±»ç±»å‹" class="headerlink" title="ç±»ç±»å‹"></a>ç±»ç±»å‹</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç±»å®ç°æ¥å£</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ClockInterface</span> &#123;</span><br><span class="line">  <span class="attr">currentTime</span>: <span class="title class_">Date</span>;</span><br><span class="line">  <span class="title function_">setTime</span>(<span class="attr">d</span>: <span class="title class_">Date</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Clock</span> <span class="keyword">implements</span> <span class="title class_">ClockInterface</span> &#123;</span><br><span class="line">  <span class="attr">currentTime</span>: <span class="title class_">Date</span> = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setTime</span>(<span class="params"><span class="attr">d</span>: <span class="title class_">Date</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentTime</span> = d;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—®ä¿®é¥°ç¬¦</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="attr">name</span>: <span class="built_in">string</span>;      <span class="comment">// å…¬å¼€ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">  <span class="keyword">private</span> <span class="attr">age</span>: <span class="built_in">number</span>;      <span class="comment">// ç§æœ‰</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="attr">email</span>: <span class="built_in">string</span>;  <span class="comment">// å—ä¿æŠ¤</span></span><br><span class="line">  <span class="keyword">readonly</span> <span class="attr">id</span>: <span class="built_in">number</span>;      <span class="comment">// åªè¯»</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span>, <span class="attr">id</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getAge</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">age</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ç±»</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">  <span class="keyword">abstract</span> <span class="title function_">makeSound</span>(): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">move</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Moving...&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">  <span class="title function_">makeSound</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Woof!&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»ä½œä¸ºæ¥å£</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">y</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Point3</span>d <span class="keyword">extends</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="attr">z</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€æ³›å‹ï¼ˆGenericsï¼‰"><a href="#ä¸‰ã€æ³›å‹ï¼ˆGenericsï¼‰" class="headerlink" title="ä¸‰ã€æ³›å‹ï¼ˆGenericsï¼‰"></a>ä¸‰ã€æ³›å‹ï¼ˆGenericsï¼‰</h2><h3 id="åŸºç¡€æ³›å‹"><a href="#åŸºç¡€æ³›å‹" class="headerlink" title="åŸºç¡€æ³›å‹"></a>åŸºç¡€æ³›å‹</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ³›å‹å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> num = identity&lt;<span class="built_in">number</span>&gt;(<span class="number">42</span>);</span><br><span class="line"><span class="keyword">const</span> str = <span class="title function_">identity</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»å‹æ¨æ–­</span></span><br><span class="line"><span class="keyword">const</span> num = <span class="title function_">identity</span>(<span class="number">42</span>); <span class="comment">// æ¨æ–­ T ä¸º number</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="title function_">identity</span>(<span class="string">&#x27;hello&#x27;</span>); <span class="comment">// æ¨æ–­ T ä¸º string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³›å‹æ¥å£</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Box</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">value</span>: T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">box</span>: <span class="title class_">Box</span>&lt;<span class="built_in">number</span>&gt; = &#123; <span class="attr">value</span>: <span class="number">42</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³›å‹ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GenericNumber</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">zeroValue</span>: T;</span><br><span class="line">  <span class="attr">add</span>: <span class="function">(<span class="params"><span class="attr">x</span>: T, <span class="attr">y</span>: T</span>) =&gt;</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myGenericNumber = <span class="keyword">new</span> <span class="title class_">GenericNumber</span>&lt;<span class="built_in">number</span>&gt;();</span><br><span class="line">myGenericNumber.<span class="property">zeroValue</span> = <span class="number">0</span>;</span><br><span class="line">myGenericNumber.<span class="property">add</span> = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="æ³›å‹çº¦æŸ"><a href="#æ³›å‹çº¦æŸ" class="headerlink" title="æ³›å‹çº¦æŸ"></a>æ³›å‹çº¦æŸ</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// çº¦æŸ T å¿…é¡»æœ‰ length å±æ€§</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Lengthwise</span> &#123;</span><br><span class="line">  <span class="attr">length</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> logLength&lt;T <span class="keyword">extends</span> <span class="title class_">Lengthwise</span>&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(arg.<span class="property">length</span>);</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">logLength</span>(&#123; <span class="attr">length</span>: <span class="number">10</span>, <span class="attr">value</span>: <span class="string">&#x27;hello&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¦æŸ T å¿…é¡»æ˜¯ U çš„å­ç±»å‹</span></span><br><span class="line"><span class="keyword">function</span> getProperty&lt;T, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">obj</span>: T, <span class="attr">key</span>: K) &#123;</span><br><span class="line">  <span class="keyword">return</span> obj[key];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> name = <span class="title function_">getProperty</span>(user, <span class="string">&#x27;name&#x27;</span>); <span class="comment">// string</span></span><br><span class="line"><span class="keyword">const</span> age = <span class="title function_">getProperty</span>(user, <span class="string">&#x27;age&#x27;</span>); <span class="comment">// number</span></span><br><span class="line"><span class="comment">// const invalid = getProperty(user, &#x27;email&#x27;); // âŒ é”™è¯¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨çº¦æŸä¸­ä½¿ç”¨ç±»å‹å‚æ•°</span></span><br><span class="line"><span class="keyword">function</span> getOwnProperty&lt;T, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">obj</span>: T, <span class="attr">key</span>: K) &#123;</span><br><span class="line">  <span class="keyword">return</span> obj[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é«˜çº§æ³›å‹"><a href="#é«˜çº§æ³›å‹" class="headerlink" title="é«˜çº§æ³›å‹"></a>é«˜çº§æ³›å‹</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ³›å‹é»˜è®¤ç±»å‹</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">FormData</span>&lt;T = <span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="attr">data</span>: T;</span><br><span class="line">  <span class="attr">timestamp</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">textData</span>: <span class="title class_">FormData</span> = &#123; <span class="attr">data</span>: <span class="string">&#x27;hello&#x27;</span>, <span class="attr">timestamp</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>() &#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">numberData</span>: <span class="title class_">FormData</span>&lt;<span class="built_in">number</span>&gt; = &#123; <span class="attr">data</span>: <span class="number">42</span>, <span class="attr">timestamp</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>() &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¡ä»¶ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">NonNullable</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="literal">null</span> | <span class="literal">undefined</span> ? <span class="built_in">never</span> : T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TypeName</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span></span><br><span class="line">  ? <span class="string">&#x27;string&#x27;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="built_in">number</span></span><br><span class="line">  ? <span class="string">&#x27;number&#x27;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="built_in">boolean</span></span><br><span class="line">  ? <span class="string">&#x27;boolean&#x27;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="literal">undefined</span></span><br><span class="line">  ? <span class="string">&#x27;undefined&#x27;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="title class_">Function</span></span><br><span class="line">  ? <span class="string">&#x27;function&#x27;</span></span><br><span class="line">  : <span class="string">&#x27;object&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T0</span> = <span class="title class_">TypeName</span>&lt;<span class="built_in">string</span>&gt;; <span class="comment">// &#x27;string&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T1</span> = <span class="title class_">TypeName</span>&lt;<span class="built_in">string</span>[]&gt;; <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜ å°„ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Readonly</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]?: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Required</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]-?: T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReadonlyUser</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">User</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialUser</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">User</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¡ä»¶æ˜ å°„ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Getters</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T <span class="keyword">as</span> <span class="string">`get<span class="subst">$&#123;Capitalize&lt;P &amp; <span class="built_in">string</span>&gt;&#125;</span>`</span>]: <span class="function">() =&gt;</span> T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">LazyPerson</span> = <span class="title class_">Getters</span>&lt;<span class="title class_">Person</span>&gt;;</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   getName: () =&gt; string;</span></span><br><span class="line"><span class="comment">//   getAge: () =&gt; number;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="å››ã€å·¥å…·ç±»å‹"><a href="#å››ã€å·¥å…·ç±»å‹" class="headerlink" title="å››ã€å·¥å…·ç±»å‹"></a>å››ã€å·¥å…·ç±»å‹</h2><h3 id="å†…ç½®å·¥å…·ç±»å‹"><a href="#å†…ç½®å·¥å…·ç±»å‹" class="headerlink" title="å†…ç½®å·¥å…·ç±»å‹"></a>å†…ç½®å·¥å…·ç±»å‹</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Partial&lt;T&gt; - æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialUser</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">User</span>&gt;;</span><br><span class="line"><span class="comment">// &#123; id?: number; name?: string; email?: string; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Required&lt;T&gt; - æ‰€æœ‰å±æ€§å˜ä¸ºå¿…éœ€</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">RequiredUser</span> = <span class="title class_">Required</span>&lt;<span class="title class_">PartialUser</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Readonly&lt;T&gt; - æ‰€æœ‰å±æ€§å˜ä¸ºåªè¯»</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReadonlyUser</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">User</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Record&lt;K, T&gt; - æ„å»ºå¯¹è±¡ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PageInfo</span> = &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Page</span> = <span class="string">&#x27;home&#x27;</span> | <span class="string">&#x27;about&#x27;</span> | <span class="string">&#x27;contact&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">nav</span>: <span class="title class_">Record</span>&lt;<span class="title class_">Page</span>, <span class="title class_">PageInfo</span>&gt; = &#123;</span><br><span class="line">  <span class="attr">home</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;Home&#x27;</span> &#125;,</span><br><span class="line">  <span class="attr">about</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;About&#x27;</span> &#125;,</span><br><span class="line">  <span class="attr">contact</span>: &#123; <span class="attr">title</span>: <span class="string">&#x27;Contact&#x27;</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pick&lt;T, K&gt; - é€‰æ‹©éƒ¨åˆ†å±æ€§</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserPreview</span> = <span class="title class_">Pick</span>&lt;<span class="title class_">User</span>, <span class="string">&#x27;id&#x27;</span> | <span class="string">&#x27;name&#x27;</span>&gt;;</span><br><span class="line"><span class="comment">// &#123; id: number; name: string; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Omit&lt;T, K&gt; - æ’é™¤éƒ¨åˆ†å±æ€§</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserWithoutEmail</span> = <span class="title class_">Omit</span>&lt;<span class="title class_">User</span>, <span class="string">&#x27;email&#x27;</span>&gt;;</span><br><span class="line"><span class="comment">// &#123; id: number; name: string; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Exclude&lt;T, U&gt; - ä» T ä¸­æ’é™¤å¯èµ‹å€¼ç»™ U çš„ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T0</span> = <span class="title class_">Exclude</span>&lt;<span class="string">&#x27;a&#x27;</span> | <span class="string">&#x27;b&#x27;</span> | <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>&gt;; <span class="comment">// &#x27;b&#x27; | &#x27;c&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Extract&lt;T, U&gt; - æå– T ä¸­å¯èµ‹å€¼ç»™ U çš„ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T1</span> = <span class="title class_">Extract</span>&lt;<span class="string">&#x27;a&#x27;</span> | <span class="string">&#x27;b&#x27;</span> | <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span> | <span class="string">&#x27;f&#x27;</span>&gt;; <span class="comment">// &#x27;a&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// NonNullable&lt;T&gt; - æ’é™¤ null å’Œ undefined</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T2</span> = <span class="title class_">NonNullable</span>&lt;<span class="built_in">string</span> | <span class="literal">null</span> | <span class="literal">undefined</span>&gt;; <span class="comment">// string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ReturnType&lt;T&gt; - è·å–å‡½æ•°è¿”å›ç±»å‹</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">x</span>: <span class="number">10</span>, <span class="attr">y</span>: <span class="number">20</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> P = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> f&gt;; <span class="comment">// &#123; x: number; y: number; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// InstanceType&lt;T&gt; - è·å–ç±»å®ä¾‹ç±»å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">  x = <span class="number">0</span>;</span><br><span class="line">  y = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T3</span> = <span class="title class_">InstanceType</span>&lt;<span class="keyword">typeof</span> C&gt;; <span class="comment">// C</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Parameters&lt;T&gt; - è·å–å‡½æ•°å‚æ•°ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T4</span> = <span class="title class_">Parameters</span>&lt;<span class="keyword">typeof</span> f&gt;; <span class="comment">// []</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Uppercase/Lowercase/Capitalize/Uncapitalize</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T5</span> = <span class="title class_">Uppercase</span>&lt;<span class="string">&#x27;hello&#x27;</span>&gt;; <span class="comment">// &#x27;HELLO&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T6</span> = <span class="title class_">Lowercase</span>&lt;<span class="string">&#x27;HELLO&#x27;</span>&gt;; <span class="comment">// &#x27;hello&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T7</span> = <span class="title class_">Capitalize</span>&lt;<span class="string">&#x27;hello&#x27;</span>&gt;; <span class="comment">// &#x27;Hello&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T8</span> = <span class="title class_">Uncapitalize</span>&lt;<span class="string">&#x27;Hello&#x27;</span>&gt;; <span class="comment">// &#x27;hello&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰å·¥å…·ç±»å‹"><a href="#è‡ªå®šä¹‰å·¥å…·ç±»å‹" class="headerlink" title="è‡ªå®šä¹‰å·¥å…·ç±»å‹"></a>è‡ªå®šä¹‰å·¥å…·ç±»å‹</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ·±åº¦ Readonly</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepReadonly</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="keyword">readonly</span> [P <span class="keyword">in</span> keyof T]: T[P] <span class="keyword">extends</span> <span class="built_in">object</span></span><br><span class="line">    ? <span class="title class_">DeepReadonly</span>&lt;T[P]&gt;</span><br><span class="line">    : T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·±åº¦ Partial</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepPartial</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]?: T[P] <span class="keyword">extends</span> <span class="built_in">object</span></span><br><span class="line">    ? <span class="title class_">DeepPartial</span>&lt;T[P]&gt;</span><br><span class="line">    : T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·±åº¦ Required</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepRequired</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]-?: T[P] <span class="keyword">extends</span> <span class="built_in">object</span></span><br><span class="line">    ? <span class="title class_">DeepRequired</span>&lt;T[P]&gt;</span><br><span class="line">    : T[P];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ç©ºç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Nullable</span>&lt;T&gt; = &#123;</span><br><span class="line">  [P <span class="keyword">in</span> keyof T]: T[P] | <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ƒç»„è½¬è”åˆ</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TupleToUnion</span>&lt;T <span class="keyword">extends</span> <span class="built_in">any</span>[]&gt; = T[<span class="built_in">number</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Tuple</span> = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Union</span> = <span class="title class_">TupleToUnion</span>&lt;<span class="title class_">Tuple</span>&gt;; <span class="comment">// &#x27;a&#x27; | &#x27;b&#x27; | &#x27;c&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å‡½æ•°å</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">FunctionPropertyNames</span>&lt;T&gt; = &#123;</span><br><span class="line">  [K <span class="keyword">in</span> keyof T]: T[K] <span class="keyword">extends</span> <span class="title class_">Function</span> ? K : <span class="built_in">never</span>;</span><br><span class="line">&#125;[keyof T];</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="title function_">greet</span>(): <span class="built_in">string</span>;</span><br><span class="line">  <span class="title function_">farewell</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserMethods</span> = <span class="title class_">FunctionPropertyNames</span>&lt;<span class="title class_">User</span>&gt;; <span class="comment">// &#x27;greet&#x27; | &#x27;farewell&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¡ä»¶ç±»å‹ï¼šPromise è§£åŒ…</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Awaited</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Promise</span>&lt;infer U&gt; ? U : T;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PromiseType</span> = <span class="title class_">Awaited</span>&lt;<span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt;&gt;; <span class="comment">// string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯å¾„ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Path</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">object</span></span><br><span class="line">  ? &#123;</span><br><span class="line">      [K <span class="keyword">in</span> keyof T]: K <span class="keyword">extends</span> <span class="built_in">string</span></span><br><span class="line">        ? K | <span class="string">`<span class="subst">$&#123;K&#125;</span>.<span class="subst">$&#123;Path&lt;T[K]&gt;&#125;</span>`</span></span><br><span class="line">        : <span class="built_in">never</span>;</span><br><span class="line">    &#125;[keyof T]</span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">address</span>: &#123;</span><br><span class="line">    <span class="attr">city</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">street</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserPaths</span> = <span class="title class_">Path</span>&lt;<span class="title class_">User</span>&gt;;</span><br><span class="line"><span class="comment">// &#x27;name&#x27; | &#x27;address&#x27; | &#x27;address.city&#x27; | &#x27;address.street&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€ç±»å‹å®ˆå«ä¸ç±»å‹æ”¶çª„"><a href="#äº”ã€ç±»å‹å®ˆå«ä¸ç±»å‹æ”¶çª„" class="headerlink" title="äº”ã€ç±»å‹å®ˆå«ä¸ç±»å‹æ”¶çª„"></a>äº”ã€ç±»å‹å®ˆå«ä¸ç±»å‹æ”¶çª„</h2><h3 id="typeof-ç±»å‹å®ˆå«"><a href="#typeof-ç±»å‹å®ˆå«" class="headerlink" title="typeof ç±»å‹å®ˆå«"></a>typeof ç±»å‹å®ˆå«</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">padLeft</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span>, <span class="attr">padding</span>: <span class="built_in">string</span> | <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> padding === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>(padding + <span class="number">1</span>).<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>) + value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> padding === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> padding + value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`Expected string or number, got &#x27;<span class="subst">$&#123;padding&#125;</span>&#x27;.`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="instanceof-ç±»å‹å®ˆå«"><a href="#instanceof-ç±»å‹å®ˆå«" class="headerlink" title="instanceof ç±»å‹å®ˆå«"></a>instanceof ç±»å‹å®ˆå«</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="title function_">fly</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Flying...&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">  <span class="title function_">swim</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Swimming...&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">move</span>(<span class="params"><span class="attr">pet</span>: <span class="title class_">Bird</span> | <span class="title class_">Fish</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (pet <span class="keyword">instanceof</span> <span class="title class_">Bird</span>) &#123;</span><br><span class="line">    pet.<span class="title function_">fly</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pet <span class="keyword">instanceof</span> <span class="title class_">Fish</span>) &#123;</span><br><span class="line">    pet.<span class="title function_">swim</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰ç±»å‹å®ˆå«"><a href="#è‡ªå®šä¹‰ç±»å‹å®ˆå«" class="headerlink" title="è‡ªå®šä¹‰ç±»å‹å®ˆå«"></a>è‡ªå®šä¹‰ç±»å‹å®ˆå«</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// is å…³é”®å­—</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isString</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">unknown</span></span>): value is <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">&#x27;string&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isNumber</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">unknown</span></span>): value is <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">&#x27;number&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">process</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">unknown</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isString</span>(value)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="title function_">toUpperCase</span>()); <span class="comment">// TypeScript çŸ¥é“æ˜¯ string</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_">isNumber</span>(value)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value.<span class="title function_">toFixed</span>(<span class="number">2</span>)); <span class="comment">// TypeScript çŸ¥é“æ˜¯ number</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´å¤æ‚çš„ç±»å‹å®ˆå«</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Admin</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">permissions</span>: <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isAdmin</span>(<span class="params"><span class="attr">user</span>: <span class="title class_">User</span> | <span class="title class_">Admin</span></span>): user is <span class="title class_">Admin</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;permissions&#x27;</span> <span class="keyword">in</span> user;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleUser</span>(<span class="params"><span class="attr">user</span>: <span class="title class_">User</span> | <span class="title class_">Admin</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isAdmin</span>(user)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">permissions</span>); <span class="comment">// âœ… Admin</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">email</span>); <span class="comment">// âœ… User</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯è¾¨è¯†è”åˆ</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Square</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&#x27;square&#x27;</span>;</span><br><span class="line">  <span class="attr">size</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&#x27;rectangle&#x27;</span>;</span><br><span class="line">  <span class="attr">width</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">height</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Circle</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&#x27;circle&#x27;</span>;</span><br><span class="line">  <span class="attr">radius</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Shape</span> = <span class="title class_">Square</span> | <span class="title class_">Rectangle</span> | <span class="title class_">Circle</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">area</span>(<span class="params"><span class="attr">shape</span>: <span class="title class_">Shape</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (shape.<span class="property">kind</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;square&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> shape.<span class="property">size</span> * shape.<span class="property">size</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;rectangle&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> shape.<span class="property">width</span> * shape.<span class="property">height</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;circle&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="property">PI</span> * shape.<span class="property">radius</span> * shape.<span class="property">radius</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®Œå…¨è¦†ç›–æ£€æŸ¥</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">assertNever</span>(<span class="params"><span class="attr">x</span>: <span class="built_in">never</span></span>): <span class="built_in">never</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Unexpected object: &#x27;</span> + x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">area2</span>(<span class="params"><span class="attr">shape</span>: <span class="title class_">Shape</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (shape.<span class="property">kind</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;square&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> shape.<span class="property">size</span> * shape.<span class="property">size</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;rectangle&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> shape.<span class="property">width</span> * shape.<span class="property">height</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;circle&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="property">PI</span> * shape.<span class="property">radius</span> * shape.<span class="property">radius</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">assertNever</span>(shape); <span class="comment">// å¦‚æœæœ‰é—æ¼ä¼šæŠ¥é”™</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€è£…é¥°å™¨ï¼ˆDecoratorsï¼‰"><a href="#å…­ã€è£…é¥°å™¨ï¼ˆDecoratorsï¼‰" class="headerlink" title="å…­ã€è£…é¥°å™¨ï¼ˆDecoratorsï¼‰"></a>å…­ã€è£…é¥°å™¨ï¼ˆDecoratorsï¼‰</h2><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç±»è£…é¥°å™¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sealed</span>(<span class="params"><span class="attr">constructor</span>: <span class="title class_">Function</span></span>) &#123;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">seal</span>(constructor);</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">seal</span>(constructor.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@sealed</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•è£…é¥°å™¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params"><span class="attr">target</span>: <span class="built_in">any</span>, <span class="attr">propertyKey</span>: <span class="built_in">string</span>, <span class="attr">descriptor</span>: <span class="title class_">PropertyDescriptor</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> originalMethod = descriptor.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">  descriptor.<span class="property">value</span> = <span class="keyword">function</span>(<span class="params">...<span class="attr">args</span>: <span class="built_in">any</span>[]</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Calling <span class="subst">$&#123;propertyKey&#125;</span> with`</span>, args);</span><br><span class="line">    <span class="keyword">const</span> result = originalMethod.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;propertyKey&#125;</span> returned`</span>, result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">  <span class="meta">@log</span></span><br><span class="line">  <span class="title function_">add</span>(<span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è£…é¥°å™¨å·¥å‚</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">format</span>(<span class="params"><span class="attr">formatString</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"><span class="attr">target</span>: <span class="built_in">any</span>, <span class="attr">propertyKey</span>: <span class="built_in">string</span>, <span class="attr">descriptor</span>: <span class="title class_">PropertyDescriptor</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> originalMethod = descriptor.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">    descriptor.<span class="property">value</span> = <span class="keyword">function</span>(<span class="params">...<span class="attr">args</span>: <span class="built_in">any</span>[]</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> result = originalMethod.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">      <span class="keyword">return</span> formatString.<span class="title function_">replace</span>(<span class="string">&#x27;%s&#x27;</span>, result);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> descriptor;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Greeter</span> &#123;</span><br><span class="line">  <span class="meta">@format</span>(<span class="string">&#x27;Hello, %s!&#x27;</span>)</span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€æ¨¡å—ä¸å‘½åç©ºé—´"><a href="#ä¸ƒã€æ¨¡å—ä¸å‘½åç©ºé—´" class="headerlink" title="ä¸ƒã€æ¨¡å—ä¸å‘½åç©ºé—´"></a>ä¸ƒã€æ¨¡å—ä¸å‘½åç©ºé—´</h2><h3 id="ES6-æ¨¡å—"><a href="#ES6-æ¨¡å—" class="headerlink" title="ES6 æ¨¡å—"></a>ES6 æ¨¡å—</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// utils.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"><span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">  <span class="title function_">add</span>(<span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Calculator</span>, &#123; add, <span class="variable constant_">PI</span>, <span class="title class_">User</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> utils <span class="keyword">from</span> <span class="string">&#x27;./utils&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">MyNamespace</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createUser</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>): <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; name &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">user</span>: <span class="title class_">MyNamespace</span>.<span class="property">User</span> = <span class="title class_">MyNamespace</span>.<span class="title function_">createUser</span>(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åµŒå¥—å‘½åç©ºé—´</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">MyNamespace</span>.<span class="property">SubNamespace</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¨æ–‡ä»¶å‘½åç©ºé—´</span></span><br><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">MyNamespace</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// utils.ts</span></span><br><span class="line"><span class="comment">/// &lt;reference path=&quot;types.ts&quot; /&gt;</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">MyNamespace</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createUser</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span></span>): <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; name &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…«ã€å®æˆ˜ç¤ºä¾‹"><a href="#å…«ã€å®æˆ˜ç¤ºä¾‹" class="headerlink" title="å…«ã€å®æˆ˜ç¤ºä¾‹"></a>å…«ã€å®æˆ˜ç¤ºä¾‹</h2><h3 id="API-è¯·æ±‚ç±»å‹å®šä¹‰"><a href="#API-è¯·æ±‚ç±»å‹å®šä¹‰" class="headerlink" title="API è¯·æ±‚ç±»å‹å®šä¹‰"></a>API è¯·æ±‚ç±»å‹å®šä¹‰</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ApiResponse</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">data</span>: T;</span><br><span class="line">  <span class="attr">status</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">message</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Post</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">authorId</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// api.ts</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchUser</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">ApiResponse</span>&lt;<span class="title class_">User</span>&gt;&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/users/<span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> response.<span class="title function_">json</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchPosts</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">ApiResponse</span>&lt;<span class="title class_">Post</span>[]&gt;&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/posts&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> response.<span class="title function_">json</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">data</span>: user &#125; = <span class="keyword">await</span> <span class="title function_">fetchUser</span>(<span class="number">1</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">name</span>);</span><br></pre></td></tr></table></figure>

<h3 id="React-TypeScript"><a href="#React-TypeScript" class="headerlink" title="React + TypeScript"></a>React + TypeScript</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// types.ts</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">onIncrement</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Component.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Counter</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">Props</span>&gt; = <span class="function">(<span class="params">&#123; title, count, onIncrement &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [localCount, setLocalCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onIncrement&#125;</span>&gt;</span>Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Counter</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hooks ç±»å‹</span></span><br><span class="line"><span class="keyword">function</span> useFetch&lt;T&gt;(<span class="attr">url</span>: <span class="built_in">string</span>): &#123;</span><br><span class="line">  <span class="attr">data</span>: T | <span class="literal">null</span>;</span><br><span class="line">  <span class="attr">loading</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">error</span>: <span class="title class_">Error</span> | <span class="literal">null</span>;</span><br><span class="line">&#125; &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = useState&lt;T | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> [error, setError] = useState&lt;<span class="title class_">Error</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(url)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">      .<span class="title function_">then</span>(setData)</span><br><span class="line">      .<span class="title function_">catch</span>(setError)</span><br><span class="line">      .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> <span class="title function_">setLoading</span>(<span class="literal">false</span>));</span><br><span class="line">  &#125;, [url]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; data, loading, error &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="TypeScript-æ ¸å¿ƒä¼˜åŠ¿"><a href="#TypeScript-æ ¸å¿ƒä¼˜åŠ¿" class="headerlink" title="TypeScript æ ¸å¿ƒä¼˜åŠ¿"></a>TypeScript æ ¸å¿ƒä¼˜åŠ¿</h3><ul>
<li>âœ… é™æ€ç±»å‹æ£€æŸ¥</li>
<li>âœ… æ›´å¥½çš„ IDE æ”¯æŒ</li>
<li>âœ… ä»£ç è‡ªæ–‡æ¡£åŒ–</li>
<li>âœ… é‡æ„æ›´å®‰å…¨</li>
<li>âœ… å‡å°‘è¿è¡Œæ—¶é”™è¯¯</li>
</ul>
<h3 id="å­¦ä¹ è·¯å¾„"><a href="#å­¦ä¹ è·¯å¾„" class="headerlink" title="å­¦ä¹ è·¯å¾„"></a>å­¦ä¹ è·¯å¾„</h3><ol>
<li>åŸºç¡€ç±»å‹å’Œæ³¨è§£</li>
<li>æ¥å£å’Œç±»å‹åˆ«å</li>
<li>æ³›å‹ç¼–ç¨‹</li>
<li>é«˜çº§ç±»å‹æŠ€å·§</li>
<li>å®æˆ˜é¡¹ç›®åº”ç”¨</li>
</ol>
<h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><ol>
<li>ä¼˜å…ˆä½¿ç”¨ interface è€Œä¸æ˜¯ type</li>
<li>é¿å…ä½¿ç”¨ anyï¼Œä½¿ç”¨ unknown</li>
<li>ä½¿ç”¨ç±»å‹å®ˆå«æ”¶çª„ç±»å‹</li>
<li>åˆç†ä½¿ç”¨æ³›å‹æé«˜å¤ç”¨æ€§</li>
<li>ä¸¥æ ¼çš„ tsconfig é…ç½®</li>
</ol>
<p>TypeScript è®© JavaScript å¼€å‘æ›´å®‰å…¨ã€æ›´é«˜æ•ˆï¼</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†ä»‹ç»å¾®å‰ç«¯æ¶æ„ï¼Œæ•¬è¯·æœŸå¾…ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>TypeScript</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å¼€å‘</tag>
        <tag>TypeScript</tag>
        <tag>ç±»å‹ç³»ç»Ÿ</tag>
        <tag>æ³›å‹</tag>
      </tags>
  </entry>
  <entry>
    <title>æ„å»ºæ™ºèƒ½AIåº”ç”¨ï¼šä»LLMåˆ°AI Agentçš„å®Œæ•´æŒ‡å—</title>
    <url>/2026/01/21/%E6%9E%84%E5%BB%BA%E6%99%BA%E8%83%BDAI%E5%BA%94%E7%94%A8%EF%BC%9A%E4%BB%8ELLM%E5%88%B0AI-Agent%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://images.unsplash.com/photo-1677442136019-21780ecad995?w=1200&h=600&fit=crop" alt="AI Neural Network"></p>
<p>éšç€ GPT-4ã€Claudeã€Gemini ç­‰å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„çˆ†å‘å¼å‘å±•ï¼ŒAI åº”ç”¨å¼€å‘å·²ç»è¿›å…¥äº†ä¸€ä¸ªå…¨æ–°çš„æ—¶ä»£ã€‚ä»ç®€å•çš„èŠå¤©æœºå™¨äººåˆ°å¤æ‚çš„ AI Agentï¼Œä»å•ä¸€æ¨¡å‹è°ƒç”¨åˆ° RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç³»ç»Ÿï¼Œå¼€å‘è€…æ­£åœ¨æ„å»ºè¶Šæ¥è¶Šæ™ºèƒ½çš„åº”ç”¨ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥äº†è§£å¦‚ä½•æ„å»ºç°ä»£ AI åº”ç”¨ï¼Œæ¶µç›– LLM é›†æˆã€Prompt Engineeringã€AI Agent å¼€å‘å’Œ RAG ç³»ç»Ÿå®æˆ˜ã€‚</p>
<h2 id="ä¸€ã€LLM-åŸºç¡€ä¸-API-é›†æˆ"><a href="#ä¸€ã€LLM-åŸºç¡€ä¸-API-é›†æˆ" class="headerlink" title="ä¸€ã€LLM åŸºç¡€ä¸ API é›†æˆ"></a>ä¸€ã€LLM åŸºç¡€ä¸ API é›†æˆ</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Ÿ</h3><p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Modelï¼ŒLLMï¼‰æ˜¯åŸºäºæ·±åº¦å­¦ä¹ çš„è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹ï¼Œé€šè¿‡åœ¨æµ·é‡æ–‡æœ¬æ•°æ®ä¸Šè®­ç»ƒï¼Œå­¦ä¼šäº†ç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€ã€‚</p>
<p><strong>ä¸»æµ LLM å¯¹æ¯”ï¼š</strong></p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>æä¾›å•†</th>
<th>ç‰¹ç‚¹</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td>GPT-4</td>
<td>OpenAI</td>
<td>ç»¼åˆèƒ½åŠ›å¼ºï¼Œä¸Šä¸‹æ–‡é•¿</td>
<td>é€šç”¨ä»»åŠ¡ã€å¤æ‚æ¨ç†</td>
</tr>
<tr>
<td>Claude 3</td>
<td>Anthropic</td>
<td>å®‰å…¨æ€§å¼ºï¼Œé•¿æ–‡æœ¬</td>
<td>åˆ†æã€æ€»ç»“ã€ä»£ç </td>
</tr>
<tr>
<td>Gemini</td>
<td>Google</td>
<td>å¤šæ¨¡æ€èƒ½åŠ›å¼º</td>
<td>å›¾æ–‡ç†è§£ã€è§†é¢‘åˆ†æ</td>
</tr>
<tr>
<td>Llama 3</td>
<td>Meta</td>
<td>å¼€æºï¼Œå¯æœ¬åœ°éƒ¨ç½²</td>
<td>éšç§è¦æ±‚é«˜çš„åœºæ™¯</td>
</tr>
</tbody></table>
<h3 id="1-2-å¿«é€Ÿå¼€å§‹ï¼šOpenAI-API-é›†æˆ"><a href="#1-2-å¿«é€Ÿå¼€å§‹ï¼šOpenAI-API-é›†æˆ" class="headerlink" title="1.2 å¿«é€Ÿå¼€å§‹ï¼šOpenAI API é›†æˆ"></a>1.2 å¿«é€Ÿå¼€å§‹ï¼šOpenAI API é›†æˆ</h3><p>é¦–å…ˆå®‰è£…å¿…è¦çš„ä¾èµ–ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install openai dotenv</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºåŸºç¡€çš„ LLM è°ƒç”¨ç±»ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/llm/openai-client.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">OpenAI</span> <span class="keyword">from</span> <span class="string">&#x27;openai&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">LLMClient</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">client</span>: <span class="title class_">OpenAI</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">apiKey</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span> = <span class="keyword">new</span> <span class="title class_">OpenAI</span>(&#123;</span><br><span class="line">      <span class="attr">apiKey</span>: apiKey,</span><br><span class="line">      <span class="attr">dangerouslyAllowBrowser</span>: <span class="literal">false</span> <span class="comment">// ç”Ÿäº§ç¯å¢ƒå¿…é¡»é€šè¿‡åç«¯è°ƒç”¨</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">chat</span>(</span><br><span class="line">    <span class="attr">messages</span>: <span class="title class_">Array</span>&lt;&#123;<span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span> | <span class="string">&#x27;assistant&#x27;</span> | <span class="string">&#x27;system&#x27;</span>; <span class="attr">content</span>: <span class="built_in">string</span>&#125;&gt;,</span><br><span class="line">    <span class="attr">model</span>: <span class="built_in">string</span> = <span class="string">&#x27;gpt-4&#x27;</span></span><br><span class="line">  ): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">client</span>.<span class="property">chat</span>.<span class="property">completions</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        <span class="attr">model</span>: model,</span><br><span class="line">        <span class="attr">messages</span>: messages,</span><br><span class="line">        <span class="attr">temperature</span>: <span class="number">0.7</span>, <span class="comment">// æ§åˆ¶éšæœºæ€§ï¼Œ0-2ï¼Œè¶Šé«˜è¶Šéšæœº</span></span><br><span class="line">        <span class="attr">max_tokens</span>: <span class="number">2000</span>,  <span class="comment">// æœ€å¤§è¾“å‡º token æ•°</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> response.<span class="property">choices</span>[<span class="number">0</span>]?.<span class="property">message</span>?.<span class="property">content</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;LLM API Error:&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æµå¼è¾“å‡ºï¼Œé€‚åˆå®æ—¶å“åº”</span></span><br><span class="line">  <span class="keyword">async</span> *<span class="title function_">chatStream</span>(</span><br><span class="line">    <span class="attr">messages</span>: <span class="title class_">Array</span>&lt;&#123;<span class="attr">role</span>: <span class="built_in">string</span>; <span class="attr">content</span>: <span class="built_in">string</span>&#125;&gt;,</span><br><span class="line">    <span class="attr">model</span>: <span class="built_in">string</span> = <span class="string">&#x27;gpt-4&#x27;</span></span><br><span class="line">  ): <span class="title class_">AsyncGenerator</span>&lt;<span class="built_in">string</span>, <span class="built_in">void</span>, <span class="built_in">unknown</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> stream = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">client</span>.<span class="property">chat</span>.<span class="property">completions</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">      <span class="attr">model</span>: model,</span><br><span class="line">      <span class="attr">messages</span>: messages,</span><br><span class="line">      <span class="attr">stream</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="title function_">await</span> (<span class="keyword">const</span> chunk <span class="keyword">of</span> stream) &#123;</span><br><span class="line">      <span class="keyword">const</span> content = chunk.<span class="property">choices</span>[<span class="number">0</span>]?.<span class="property">delta</span>?.<span class="property">content</span>;</span><br><span class="line">      <span class="keyword">if</span> (content) &#123;</span><br><span class="line">        <span class="keyword">yield</span> content;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ï¼šåŸºç¡€å¯¹è¯</span></span><br><span class="line"><span class="keyword">const</span> llm = <span class="keyword">new</span> <span class="title class_">LLMClient</span>(process.<span class="property">env</span>.<span class="property">OPENAI_API_KEY</span>!);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> messages = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span>,</span><br><span class="line">    <span class="attr">content</span>: <span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æŠ€æœ¯é¡¾é—®ï¼Œæ“…é•¿å¸®åŠ©å¼€å‘è€…è§£å†³é—®é¢˜ã€‚&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    <span class="attr">content</span>: <span class="string">&#x27;è¯·è§£é‡Šä»€ä¹ˆæ˜¯ React Hooksï¼Ÿ&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> response = <span class="keyword">await</span> llm.<span class="title function_">chat</span>(messages);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span><br></pre></td></tr></table></figure>

<h3 id="1-3-å®‰å…¨çš„-API-è°ƒç”¨ï¼šåç«¯å°è£…"><a href="#1-3-å®‰å…¨çš„-API-è°ƒç”¨ï¼šåç«¯å°è£…" class="headerlink" title="1.3 å®‰å…¨çš„ API è°ƒç”¨ï¼šåç«¯å°è£…"></a>1.3 å®‰å…¨çš„ API è°ƒç”¨ï¼šåç«¯å°è£…</h3><p><strong>é‡è¦</strong>ï¼šæ°¸è¿œä¸è¦åœ¨å‰ç«¯ç›´æ¥è°ƒç”¨ LLM APIï¼Œè¿™ä¼šæš´éœ²ä½ çš„ API Keyï¼</p>
<p>åˆ›å»º Next.js API è·¯ç”±ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// pages/api/chat.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">NextApiRequest</span>, <span class="title class_">NextApiResponse</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;next&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LLMClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/lib/llm/openai-client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">req</span>: <span class="title class_">NextApiRequest</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">res</span>: <span class="title class_">NextApiResponse</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> !== <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">405</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Method not allowed&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; messages &#125; = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// éªŒè¯è¯·æ±‚</span></span><br><span class="line">  <span class="keyword">if</span> (!messages || !<span class="title class_">Array</span>.<span class="title function_">isArray</span>(messages)) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Invalid messages&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> llm = <span class="keyword">new</span> <span class="title class_">LLMClient</span>(process.<span class="property">env</span>.<span class="property">OPENAI_API_KEY</span>!);</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> llm.<span class="title function_">chat</span>(messages);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123; response &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Chat API Error:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Internal server error&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‰ç«¯è°ƒç”¨ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// components/ChatInterface.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">ChatInterface</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [messages, setMessages] = useState&lt;<span class="title class_">Array</span>&lt;&#123;</span><br><span class="line">    <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span> | <span class="string">&#x27;assistant&#x27;</span>;</span><br><span class="line">    <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;&gt;&gt;([]);</span><br><span class="line">  <span class="keyword">const</span> [input, setInput] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">sendMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!input.<span class="title function_">trim</span>()) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> userMessage = &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span> <span class="keyword">as</span> <span class="keyword">const</span>, <span class="attr">content</span>: input &#125;;</span><br><span class="line">    <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, userMessage]);</span><br><span class="line">    <span class="title function_">setInput</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/chat&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;,</span><br><span class="line">        <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">messages</span>: [...messages, userMessage] &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">      <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, &#123;</span><br><span class="line">        <span class="attr">role</span>: <span class="string">&#x27;assistant&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: data.<span class="property">response</span></span><br><span class="line">      &#125;]);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;chat-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;messages&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;messages.map((msg, idx) =&gt; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;idx&#125;</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">message</span> $&#123;<span class="attr">msg.role</span>&#125;`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;msg.content&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ))&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;loading &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;message assistant&quot;</span>&gt;</span>Thinking...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;input-area&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">value</span>=<span class="string">&#123;input&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setInput(e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">          onKeyPress=&#123;(e) =&gt; e.key === &#x27;Enter&#x27; &amp;&amp; sendMessage()&#125;</span></span><br><span class="line"><span class="language-xml">          placeholder=&quot;è¾“å…¥ä½ çš„é—®é¢˜...&quot;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;sendMessage&#125;</span> <span class="attr">disabled</span>=<span class="string">&#123;loading&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          å‘é€</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€Prompt-Engineering-æœ€ä½³å®è·µ"><a href="#äºŒã€Prompt-Engineering-æœ€ä½³å®è·µ" class="headerlink" title="äºŒã€Prompt Engineering æœ€ä½³å®è·µ"></a>äºŒã€Prompt Engineering æœ€ä½³å®è·µ</h2><h3 id="2-1-ä»€ä¹ˆæ˜¯-Prompt-Engineeringï¼Ÿ"><a href="#2-1-ä»€ä¹ˆæ˜¯-Prompt-Engineeringï¼Ÿ" class="headerlink" title="2.1 ä»€ä¹ˆæ˜¯ Prompt Engineeringï¼Ÿ"></a>2.1 ä»€ä¹ˆæ˜¯ Prompt Engineeringï¼Ÿ</h3><p>Prompt Engineeringï¼ˆæç¤ºå·¥ç¨‹ï¼‰æ˜¯è®¾è®¡å’Œä¼˜åŒ–è¾“å…¥ç»™ LLM çš„æç¤ºè¯ï¼Œä»¥è·å¾—æ›´å‡†ç¡®ã€æ›´ç›¸å…³è¾“å‡ºçš„æŠ€æœ¯ã€‚</p>
<h3 id="2-2-æ ¸å¿ƒåŸåˆ™"><a href="#2-2-æ ¸å¿ƒåŸåˆ™" class="headerlink" title="2.2 æ ¸å¿ƒåŸåˆ™"></a>2.2 æ ¸å¿ƒåŸåˆ™</h3><p><strong>1. æ¸…æ™°å…·ä½“</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// âŒ ä¸å¥½çš„ prompt</span></span><br><span class="line"><span class="keyword">const</span> badPrompt = <span class="string">&quot;å†™ä»£ç &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âœ… å¥½çš„ prompt</span></span><br><span class="line"><span class="keyword">const</span> goodPrompt = <span class="string">`</span></span><br><span class="line"><span class="string">è¯·ç”¨ TypeScript å†™ä¸€ä¸ª React å‡½æ•°ç»„ä»¶ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</span></span><br><span class="line"><span class="string">1. æ˜¾ç¤ºä¸€ä¸ªè®¡æ•°å™¨</span></span><br><span class="line"><span class="string">2. æœ‰å¢åŠ å’Œå‡å°‘æŒ‰é’®</span></span><br><span class="line"><span class="string">3. ä½¿ç”¨ useState hook</span></span><br><span class="line"><span class="string">4. æ·»åŠ é€‚å½“çš„ç±»å‹æ³¨è§£</span></span><br><span class="line"><span class="string">5. åŒ…å«åŸºæœ¬çš„æ ·å¼</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>

<p><strong>2. æä¾›ä¸Šä¸‹æ–‡</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> systemPrompt = <span class="string">`</span></span><br><span class="line"><span class="string">ä½ æ˜¯ä¸€ä½æœ‰ 10 å¹´ç»éªŒçš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œä¸“ç²¾äº React å’Œ TypeScriptã€‚</span></span><br><span class="line"><span class="string">ä½ çš„å›ç­”åº”è¯¥ï¼š</span></span><br><span class="line"><span class="string">- æŠ€æœ¯å‡†ç¡®ï¼Œéµå¾ªæœ€ä½³å®è·µ</span></span><br><span class="line"><span class="string">- ä»£ç ç®€æ´ï¼Œæ˜“äºç»´æŠ¤</span></span><br><span class="line"><span class="string">- åŒ…å«å¿…è¦çš„æ³¨é‡Š</span></span><br><span class="line"><span class="string">- è€ƒè™‘æ€§èƒ½å’Œå¯è®¿é—®æ€§</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>

<p><strong>3. ä½¿ç”¨ç¤ºä¾‹ï¼ˆFew-shot Learningï¼‰</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> prompt = <span class="string">`</span></span><br><span class="line"><span class="string">ä»»åŠ¡ï¼šå°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸º SQL æŸ¥è¯¢</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç¤ºä¾‹ 1ï¼š</span></span><br><span class="line"><span class="string">è¾“å…¥ï¼šæŸ¥æ‰¾æ‰€æœ‰å¹´é¾„å¤§äº 25 çš„ç”¨æˆ·</span></span><br><span class="line"><span class="string">è¾“å‡ºï¼šSELECT * FROM users WHERE age &gt; 25;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç¤ºä¾‹ 2ï¼š</span></span><br><span class="line"><span class="string">è¾“å…¥ï¼šè·å–é”€é‡å‰ 10 çš„äº§å“</span></span><br><span class="line"><span class="string">è¾“å‡ºï¼šSELECT * FROM products ORDER BY sales DESC LIMIT 10;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¾“å…¥ï¼šæŸ¥æ‰¾åå­—åŒ…å« &quot;John&quot; çš„ç”¨æˆ·</span></span><br><span class="line"><span class="string">è¾“å‡ºï¼š</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>

<p><strong>4. é“¾å¼æ€è€ƒï¼ˆChain of Thoughtï¼‰</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> prompt = <span class="string">`</span></span><br><span class="line"><span class="string">é—®é¢˜ï¼šå°æ˜æœ‰ 5 ä¸ªè‹¹æœï¼Œä»–ç»™äº†å°çº¢ 2 ä¸ªï¼Œç„¶ååˆä¹°äº† 3 ä¸ªï¼Œç°åœ¨ä»–æœ‰å¤šå°‘ä¸ªè‹¹æœï¼Ÿ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¯·ä¸€æ­¥æ­¥æ€è€ƒï¼š</span></span><br><span class="line"><span class="string">1. åˆå§‹æ•°é‡ï¼šå°æ˜æœ‰ 5 ä¸ªè‹¹æœ</span></span><br><span class="line"><span class="string">2. ç»™å°çº¢åï¼š5 - 2 = 3 ä¸ª</span></span><br><span class="line"><span class="string">3. ä¹°å…¥åï¼š3 + 3 = 6 ä¸ª</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç­”æ¡ˆï¼šå°æ˜ç°åœ¨æœ‰ 6 ä¸ªè‹¹æœã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç°åœ¨è¯·ç”¨åŒæ ·çš„æ–¹å¼è§£å†³ï¼š</span></span><br><span class="line"><span class="string">å°çº¢æœ‰ 10 ä¸ªæ©™å­ï¼Œå¥¹ç»™å°ä¸½ 3 ä¸ªï¼Œåˆåƒäº† 2 ä¸ªï¼Œç„¶åå¦ˆå¦ˆç»™äº†å¥¹ 5 ä¸ªï¼Œç°åœ¨å¥¹æœ‰å¤šå°‘ä¸ªæ©™å­ï¼Ÿ</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-ç»“æ„åŒ–-Prompt-æ¨¡æ¿"><a href="#2-3-ç»“æ„åŒ–-Prompt-æ¨¡æ¿" class="headerlink" title="2.3 ç»“æ„åŒ– Prompt æ¨¡æ¿"></a>2.3 ç»“æ„åŒ– Prompt æ¨¡æ¿</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/prompts/structured-prompt.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">PromptTemplate</span> &#123;</span><br><span class="line">  <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span> | <span class="string">&#x27;user&#x27;</span> | <span class="string">&#x27;assistant&#x27;</span>;</span><br><span class="line">  <span class="attr">template</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">variables</span>?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">PromptBuilder</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">messages</span>: <span class="title class_">Array</span>&lt;&#123;<span class="attr">role</span>: <span class="built_in">string</span>; <span class="attr">content</span>: <span class="built_in">string</span>&#125;&gt; = [];</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addSystem</span>(<span class="attr">content</span>: <span class="built_in">string</span>): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="title function_">push</span>(&#123; <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span>, content &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addUser</span>(<span class="attr">content</span>: <span class="built_in">string</span>, <span class="attr">variables</span>?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;): <span class="variable language_">this</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> formattedContent = content;</span><br><span class="line">    <span class="keyword">if</span> (variables) &#123;</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">entries</span>(variables).<span class="title function_">forEach</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> &#123;</span><br><span class="line">        formattedContent = formattedContent.<span class="title function_">replace</span>(</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`\\&#123;\\&#123;<span class="subst">$&#123;key&#125;</span>\\&#125;\\&#125;`</span>, <span class="string">&#x27;g&#x27;</span>),</span><br><span class="line">          <span class="title class_">String</span>(value)</span><br><span class="line">        );</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">messages</span>.<span class="title function_">push</span>(&#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: formattedContent &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(): <span class="title class_">Array</span>&lt;&#123;<span class="attr">role</span>: <span class="built_in">string</span>; <span class="attr">content</span>: <span class="built_in">string</span>&#125;&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> [...<span class="variable language_">this</span>.<span class="property">messages</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> prompt = <span class="keyword">new</span> <span class="title class_">PromptBuilder</span>()</span><br><span class="line">  .<span class="title function_">addSystem</span>(<span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä»£ç å®¡æŸ¥å‘˜&#x27;</span>)</span><br><span class="line">  .<span class="title function_">addUser</span>(<span class="string">`</span></span><br><span class="line"><span class="string">    è¯·å®¡æŸ¥ä»¥ä¸‹ &#123;&#123;language&#125;&#125; ä»£ç ï¼Œé‡ç‚¹å…³æ³¨ï¼š</span></span><br><span class="line"><span class="string">    1. ä»£ç è´¨é‡</span></span><br><span class="line"><span class="string">    2. æ½œåœ¨çš„ bug</span></span><br><span class="line"><span class="string">    3. æ€§èƒ½é—®é¢˜</span></span><br><span class="line"><span class="string">    4. æ”¹è¿›å»ºè®®</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ä»£ç ï¼š</span></span><br><span class="line"><span class="string">    `</span><span class="string">``</span>&#123;&#123;language&#125;&#125;</span><br><span class="line">    &#123;&#123;code&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>  &#96;, {<br>    language: â€˜TypeScriptâ€™,<br>    code: â€˜const data &#x3D; await fetch(url);â€™<br>  })<br>  .build();</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## ä¸‰ã€æ„å»º AI Agent</span><br><span class="line"></span><br><span class="line">### 3.1 ä»€ä¹ˆæ˜¯ AI Agentï¼Ÿ</span><br><span class="line"></span><br><span class="line">AI Agent æ˜¯èƒ½å¤Ÿè‡ªä¸»æ„ŸçŸ¥ç¯å¢ƒã€åšå‡ºå†³ç­–å¹¶æ‰§è¡Œè¡ŒåŠ¨çš„ AI ç³»ç»Ÿã€‚ä¸ä¼ ç»Ÿ LLM èŠå¤©æœºå™¨äººä¸åŒï¼ŒAgent å¯ä»¥ï¼š</span><br><span class="line"></span><br><span class="line">- ğŸ”§ ä½¿ç”¨å·¥å…·ï¼ˆToolsï¼‰</span><br><span class="line">- ğŸ”„ å¤šæ­¥æ¨ç†</span><br><span class="line">- ğŸ“Š è®¿é—®å¤–éƒ¨æ•°æ®</span><br><span class="line">- ğŸ¤ ä¸å…¶ä»– Agent åä½œ</span><br><span class="line"></span><br><span class="line">![AI Agent Architecture](https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=1200&amp;h=600&amp;fit=crop)</span><br><span class="line"></span><br><span class="line">### 3.2 Agent æ ¸å¿ƒç»„ä»¶</span><br><span class="line"></span><br><span class="line">```typescript</span><br><span class="line">// src/agent/types.ts</span><br><span class="line">export interface Tool &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  description: string;</span><br><span class="line">  parameters: Record&lt;string, any&gt;;</span><br><span class="line">  execute: (params: any) =&gt; Promise&lt;any&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export interface AgentConfig &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  role: string;</span><br><span class="line">  tools: Tool[];</span><br><span class="line">  llmClient: LLMClient;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export interface Task &#123;</span><br><span class="line">  id: string;</span><br><span class="line">  description: string;</span><br><span class="line">  status: &#x27;pending&#x27; | &#x27;in_progress&#x27; | &#x27;completed&#x27; | &#x27;failed&#x27;;</span><br><span class="line">  result?: any;</span><br><span class="line">  error?: string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-å®ç°åŸºç¡€-Agent"><a href="#3-3-å®ç°åŸºç¡€-Agent" class="headerlink" title="3.3 å®ç°åŸºç¡€ Agent"></a>3.3 å®ç°åŸºç¡€ Agent</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/agent/base-agent.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LLMClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../llm/openai-client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Agent</span> &#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="attr">llm</span>: <span class="title class_">LLMClient</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="attr">tools</span>: <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">Tool</span>&gt; = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">  <span class="keyword">protected</span> <span class="attr">memory</span>: <span class="title class_">Array</span>&lt;&#123;<span class="attr">role</span>: <span class="built_in">string</span>; <span class="attr">content</span>: <span class="built_in">string</span>&#125;&gt; = [];</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">llm</span>: <span class="title class_">LLMClient</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">llm</span> = llm;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">registerTool</span>(<span class="attr">tool</span>: <span class="title class_">Tool</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tools</span>.<span class="title function_">set</span>(tool.<span class="property">name</span>, tool);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">think</span>(<span class="attr">userInput</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// 1. åˆ†æç”¨æˆ·æ„å›¾</span></span><br><span class="line">    <span class="keyword">const</span> intent = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">analyzeIntent</span>(userInput);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. å†³å®šæ˜¯å¦éœ€è¦ä½¿ç”¨å·¥å…·</span></span><br><span class="line">    <span class="keyword">if</span> (intent.<span class="property">requiresTool</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> toolResult = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">executeTool</span>(intent.<span class="property">toolName</span>, intent.<span class="property">parameters</span>);</span><br><span class="line">      <span class="keyword">return</span> toolResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. ç›´æ¥å›ç­”</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">llm</span>.<span class="title function_">chat</span>([</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span>, <span class="attr">content</span>: <span class="variable language_">this</span>.<span class="title function_">getSystemPrompt</span>() &#125;,</span><br><span class="line">      ...<span class="variable language_">this</span>.<span class="property">memory</span>,</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: userInput &#125;</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿å­˜åˆ°è®°å¿†</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">memory</span>.<span class="title function_">push</span>(&#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: userInput &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">memory</span>.<span class="title function_">push</span>(&#123; <span class="attr">role</span>: <span class="string">&#x27;assistant&#x27;</span>, <span class="attr">content</span>: response &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">async</span> <span class="title function_">analyzeIntent</span>(<span class="attr">userInput</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;&#123;</span><br><span class="line">    <span class="attr">requiresTool</span>: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="attr">toolName</span>?: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">parameters</span>?: <span class="built_in">any</span>;</span><br><span class="line">  &#125;&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> toolsDescription = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">this</span>.<span class="property">tools</span>.<span class="title function_">values</span>())</span><br><span class="line">      .<span class="title function_">map</span>(<span class="function"><span class="params">tool</span> =&gt;</span> <span class="string">`- <span class="subst">$&#123;tool.name&#125;</span>: <span class="subst">$&#123;tool.description&#125;</span>`</span>)</span><br><span class="line">      .<span class="title function_">join</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> prompt = <span class="string">`</span></span><br><span class="line"><span class="string">      å¯ç”¨å·¥å…·ï¼š</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;toolsDescription&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      ç”¨æˆ·è¾“å…¥ï¼š<span class="subst">$&#123;userInput&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      åˆ¤æ–­æ˜¯å¦éœ€è¦ä½¿ç”¨å·¥å…·ã€‚å¦‚æœéœ€è¦ï¼Œè¿”å› JSON æ ¼å¼ï¼š</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        &quot;requiresTool&quot;: true,</span></span><br><span class="line"><span class="string">        &quot;toolName&quot;: &quot;å·¥å…·åç§°&quot;,</span></span><br><span class="line"><span class="string">        &quot;parameters&quot;: &#123;å‚æ•°&#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      å¦‚æœä¸éœ€è¦ï¼Œè¿”å›ï¼š</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        &quot;requiresTool&quot;: false</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">llm</span>.<span class="title function_">chat</span>([</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: prompt &#125;</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(response);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">async</span> <span class="title function_">executeTool</span>(<span class="attr">toolName</span>: <span class="built_in">string</span>, <span class="attr">parameters</span>: <span class="built_in">any</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> tool = <span class="variable language_">this</span>.<span class="property">tools</span>.<span class="title function_">get</span>(toolName);</span><br><span class="line">    <span class="keyword">if</span> (!tool) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`å·¥å…· <span class="subst">$&#123;toolName&#125;</span> ä¸å­˜åœ¨`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">await</span> tool.<span class="title function_">execute</span>(parameters);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`å·¥å…·æ‰§è¡Œç»“æœï¼š<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(result, <span class="literal">null</span>, <span class="number">2</span>)&#125;</span>`</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`å·¥å…·æ‰§è¡Œå¤±è´¥ï¼š<span class="subst">$&#123;error&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="title function_">getSystemPrompt</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ã€‚&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-å®ç”¨å·¥å…·ç¤ºä¾‹"><a href="#3-4-å®ç”¨å·¥å…·ç¤ºä¾‹" class="headerlink" title="3.4 å®ç”¨å·¥å…·ç¤ºä¾‹"></a>3.4 å®ç”¨å·¥å…·ç¤ºä¾‹</h3><p><strong>1. ç½‘é¡µæœç´¢å·¥å…·</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/agent/tools/search.ts</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">searchTool</span>: <span class="title class_">Tool</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;web_search&#x27;</span>,</span><br><span class="line">  <span class="attr">description</span>: <span class="string">&#x27;åœ¨äº’è”ç½‘ä¸Šæœç´¢ä¿¡æ¯&#x27;</span>,</span><br><span class="line">  <span class="attr">parameters</span>: &#123;</span><br><span class="line">    <span class="attr">query</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;string&#x27;</span>, <span class="attr">description</span>: <span class="string">&#x27;æœç´¢å…³é”®è¯&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">numResults</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;number&#x27;</span>, <span class="attr">description</span>: <span class="string">&#x27;ç»“æœæ•°é‡&#x27;</span>, <span class="attr">default</span>: <span class="number">5</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">execute</span>: <span class="title function_">async</span> (params) =&gt; &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Google Custom Search API æˆ–å…¶ä»–æœç´¢ API</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://serpapi.com/search&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">params</span>: &#123;</span><br><span class="line">        <span class="attr">q</span>: params.<span class="property">query</span>,</span><br><span class="line">        <span class="attr">api_key</span>: process.<span class="property">env</span>.<span class="property">SERPAPI_KEY</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">results</span>: response.<span class="property">data</span>.<span class="property">organic_results</span>?.<span class="title function_">slice</span>(<span class="number">0</span>, params.<span class="property">numResults</span> || <span class="number">5</span>)</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>2. ä»£ç æ‰§è¡Œå·¥å…·</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/agent/tools/code-executor.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; exec &#125; <span class="keyword">from</span> <span class="string">&#x27;child_process&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&#x27;util&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> execAsync = <span class="title function_">promisify</span>(exec);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">codeExecutorTool</span>: <span class="title class_">Tool</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;execute_code&#x27;</span>,</span><br><span class="line">  <span class="attr">description</span>: <span class="string">&#x27;æ‰§è¡Œ JavaScript/TypeScript ä»£ç å¹¶è¿”å›ç»“æœ&#x27;</span>,</span><br><span class="line">  <span class="attr">parameters</span>: &#123;</span><br><span class="line">    <span class="attr">code</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;string&#x27;</span>, <span class="attr">description</span>: <span class="string">&#x27;è¦æ‰§è¡Œçš„ä»£ç &#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">language</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;string&#x27;</span>, <span class="attr">description</span>: <span class="string">&#x27;ä»£ç è¯­è¨€&#x27;</span>, <span class="attr">default</span>: <span class="string">&#x27;javascript&#x27;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">execute</span>: <span class="title function_">async</span> (params) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// æ³¨æ„ï¼šç”Ÿäº§ç¯å¢ƒéœ€è¦æ²™ç®±ç¯å¢ƒï¼Œè¿™é‡Œä»…ä½œæ¼”ç¤º</span></span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">execAsync</span>(<span class="string">`node -e &quot;<span class="subst">$&#123;params.code&#125;</span>&quot;`</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">success</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">output</span>: result.<span class="property">stdout</span>,</span><br><span class="line">        <span class="attr">error</span>: result.<span class="property">stderr</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">success</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">error</span>: error</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>3. æ–‡ä»¶æ“ä½œå·¥å…·</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/agent/tools/file-operations.ts</span></span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs/promises&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">fileReadTool</span>: <span class="title class_">Tool</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;read_file&#x27;</span>,</span><br><span class="line">  <span class="attr">description</span>: <span class="string">&#x27;è¯»å–æ–‡ä»¶å†…å®¹&#x27;</span>,</span><br><span class="line">  <span class="attr">parameters</span>: &#123;</span><br><span class="line">    <span class="attr">filePath</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;string&#x27;</span>, <span class="attr">description</span>: <span class="string">&#x27;æ–‡ä»¶è·¯å¾„&#x27;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">execute</span>: <span class="title function_">async</span> (params) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> content = <span class="keyword">await</span> fs.<span class="title function_">readFile</span>(params.<span class="property">filePath</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span>, content &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">error</span>: (error <span class="keyword">as</span> <span class="title class_">Error</span>).<span class="property">message</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">fileWriteTool</span>: <span class="title class_">Tool</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;write_file&#x27;</span>,</span><br><span class="line">  <span class="attr">description</span>: <span class="string">&#x27;å†™å…¥æ–‡ä»¶å†…å®¹&#x27;</span>,</span><br><span class="line">  <span class="attr">parameters</span>: &#123;</span><br><span class="line">    <span class="attr">filePath</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;string&#x27;</span>, <span class="attr">description</span>: <span class="string">&#x27;æ–‡ä»¶è·¯å¾„&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">content</span>: &#123; <span class="attr">type</span>: <span class="string">&#x27;string&#x27;</span>, <span class="attr">description</span>: <span class="string">&#x27;æ–‡ä»¶å†…å®¹&#x27;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">execute</span>: <span class="title function_">async</span> (params) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> fs.<span class="title function_">writeFile</span>(params.<span class="property">filePath</span>, params.<span class="property">content</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">error</span>: (error <span class="keyword">as</span> <span class="title class_">Error</span>).<span class="property">message</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="3-5-åˆ›å»ºä¸“ç”¨-Agent"><a href="#3-5-åˆ›å»ºä¸“ç”¨-Agent" class="headerlink" title="3.5 åˆ›å»ºä¸“ç”¨ Agent"></a>3.5 åˆ›å»ºä¸“ç”¨ Agent</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/agents/code-review-agent.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Agent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./base-agent&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; codeExecutorTool &#125; <span class="keyword">from</span> <span class="string">&#x27;../agent/tools/code-executor&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CodeReviewAgent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Agent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">llm</span>: <span class="title class_">LLMClient</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(llm);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">registerTool</span>(codeExecutorTool);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="title function_">getSystemPrompt</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      ä½ æ˜¯ä¸€ä½èµ„æ·±çš„ä»£ç å®¡æŸ¥å‘˜ï¼Œä¸“ç²¾äºå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      å®¡æŸ¥ä»£ç æ—¶ï¼Œä½ å…³æ³¨ï¼š</span></span><br><span class="line"><span class="string">      1. ä»£ç è´¨é‡å’Œå¯è¯»æ€§</span></span><br><span class="line"><span class="string">      2. æ½œåœ¨çš„ bug å’Œè¾¹ç•Œæƒ…å†µ</span></span><br><span class="line"><span class="string">      3. æ€§èƒ½ä¼˜åŒ–æœºä¼š</span></span><br><span class="line"><span class="string">      4. å®‰å…¨æ¼æ´</span></span><br><span class="line"><span class="string">      5. æœ€ä½³å®è·µéµå¾ªæƒ…å†µ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      ä½ çš„å›å¤åº”è¯¥ï¼š</span></span><br><span class="line"><span class="string">      - å»ºè®¾æ€§ä¸”å…·ä½“</span></span><br><span class="line"><span class="string">      - æä¾›æ”¹è¿›å»ºè®®å’Œä»£ç ç¤ºä¾‹</span></span><br><span class="line"><span class="string">      - è§£é‡Šä¸ºä»€ä¹ˆè¿™æ ·æ”¹è¿›</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">reviewCode</span>(<span class="attr">code</span>: <span class="built_in">string</span>, <span class="attr">language</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;&#123;</span><br><span class="line">    <span class="attr">summary</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">issues</span>: <span class="title class_">Array</span>&lt;&#123;</span><br><span class="line">      <span class="attr">severity</span>: <span class="string">&#x27;high&#x27;</span> | <span class="string">&#x27;medium&#x27;</span> | <span class="string">&#x27;low&#x27;</span>;</span><br><span class="line">      <span class="attr">line</span>?: <span class="built_in">number</span>;</span><br><span class="line">      <span class="attr">description</span>: <span class="built_in">string</span>;</span><br><span class="line">      <span class="attr">suggestion</span>?: <span class="built_in">string</span>;</span><br><span class="line">    &#125;&gt;;</span><br><span class="line">    <span class="attr">overallScore</span>: <span class="built_in">number</span>;</span><br><span class="line">  &#125;&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> prompt = <span class="string">`</span></span><br><span class="line"><span class="string">      è¯·å®¡æŸ¥ä»¥ä¸‹ <span class="subst">$&#123;language&#125;</span> ä»£ç ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      \`\`\`<span class="subst">$&#123;language&#125;</span></span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;code&#125;</span></span></span><br><span class="line"><span class="string">      \`\`\`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      æä¾›è¯¦ç»†çš„å®¡æŸ¥æŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š</span></span><br><span class="line"><span class="string">      1. æ€»ä½“è¯„ä»·ï¼ˆ1-10åˆ†ï¼‰</span></span><br><span class="line"><span class="string">      2. å‘ç°çš„é—®é¢˜ï¼ˆæŒ‰ä¸¥é‡ç¨‹åº¦æ’åºï¼‰</span></span><br><span class="line"><span class="string">      3. æ¯ä¸ªé—®é¢˜çš„å…·ä½“ä½ç½®å’Œæ”¹è¿›å»ºè®®</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">llm</span>.<span class="title function_">chat</span>([</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span>, <span class="attr">content</span>: <span class="variable language_">this</span>.<span class="title function_">getSystemPrompt</span>() &#125;,</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: prompt &#125;</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§£æç»“æ„åŒ–å“åº”ï¼ˆå®é™…åº”ç”¨ä¸­åº”è¯¥è®© LLM è¿”å› JSONï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">summary</span>: response,</span><br><span class="line">      <span class="attr">issues</span>: [],</span><br><span class="line">      <span class="attr">overallScore</span>: <span class="number">8</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€RAG-ç³»ç»Ÿå®æˆ˜"><a href="#å››ã€RAG-ç³»ç»Ÿå®æˆ˜" class="headerlink" title="å››ã€RAG ç³»ç»Ÿå®æˆ˜"></a>å››ã€RAG ç³»ç»Ÿå®æˆ˜</h2><h3 id="4-1-ä»€ä¹ˆæ˜¯-RAGï¼Ÿ"><a href="#4-1-ä»€ä¹ˆæ˜¯-RAGï¼Ÿ" class="headerlink" title="4.1 ä»€ä¹ˆæ˜¯ RAGï¼Ÿ"></a>4.1 ä»€ä¹ˆæ˜¯ RAGï¼Ÿ</h3><p>RAGï¼ˆRetrieval-Augmented Generationï¼Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰é€šè¿‡ç»“åˆä¿¡æ¯æ£€ç´¢å’Œ LLM ç”Ÿæˆï¼Œè®© AI èƒ½å¤Ÿè®¿é—®å’Œåˆ©ç”¨å¤–éƒ¨çŸ¥è¯†åº“ï¼Œå¤§å¤§æå‡äº†å›ç­”çš„å‡†ç¡®æ€§å’Œå¯ä¿¡åº¦ã€‚</p>
<p><img src="https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=1200&h=600&fit=crop" alt="RAG Architecture"></p>
<p><strong>RAG çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… å‡å°‘å¹»è§‰ï¼ˆHallucinationï¼‰</li>
<li>âœ… çŸ¥è¯†å®æ—¶æ›´æ–°</li>
<li>âœ… å¯æº¯æºå¼•ç”¨</li>
<li>âœ… é¢†åŸŸä¸“ä¸šçŸ¥è¯†</li>
</ul>
<h3 id="4-2-RAG-ç³»ç»Ÿæ¶æ„"><a href="#4-2-RAG-ç³»ç»Ÿæ¶æ„" class="headerlink" title="4.2 RAG ç³»ç»Ÿæ¶æ„"></a>4.2 RAG ç³»ç»Ÿæ¶æ„</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·æŸ¥è¯¢</span><br><span class="line">    â†“</span><br><span class="line">å‘é‡åŒ– Embedding</span><br><span class="line">    â†“</span><br><span class="line">å‘é‡æ£€ç´¢ â† â†’ çŸ¥è¯†åº“ï¼ˆå‘é‡æ•°æ®åº“ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">ä¸Šä¸‹æ–‡æ„å»º</span><br><span class="line">    â†“</span><br><span class="line">LLM ç”Ÿæˆ</span><br><span class="line">    â†“</span><br><span class="line">ç­”æ¡ˆ + å¼•ç”¨</span><br></pre></td></tr></table></figure>

<h3 id="4-3-å®ç°å‘é‡å­˜å‚¨"><a href="#4-3-å®ç°å‘é‡å­˜å‚¨" class="headerlink" title="4.3 å®ç°å‘é‡å­˜å‚¨"></a>4.3 å®ç°å‘é‡å­˜å‚¨</h3><p>é¦–å…ˆå®‰è£…ä¾èµ–ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install @langchain/openai @langchain/pinecone pinecone-client</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå‘é‡å­˜å‚¨æœåŠ¡ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/rag/vector-store.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PineconeClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@pinecone-database/pinecone&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">OpenAIEmbeddings</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@langchain/openai&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">VectorStore</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">pinecone</span>: <span class="title class_">PineconeClient</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">embeddings</span>: <span class="title class_">OpenAIEmbeddings</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">index</span>: <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pinecone</span> = <span class="keyword">new</span> <span class="title class_">PineconeClient</span>(&#123;</span><br><span class="line">      <span class="attr">apiKey</span>: process.<span class="property">env</span>.<span class="property">PINECONE_API_KEY</span>!,</span><br><span class="line">      <span class="attr">environment</span>: process.<span class="property">env</span>.<span class="property">PINECONE_ENVIRONMENT</span>!</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">embeddings</span> = <span class="keyword">new</span> <span class="title class_">OpenAIEmbeddings</span>(&#123;</span><br><span class="line">      <span class="attr">openAIApiKey</span>: process.<span class="property">env</span>.<span class="property">OPENAI_API_KEY</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">initialize</span>(<span class="params"><span class="attr">indexName</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">pinecone</span>.<span class="title function_">init</span>(&#123;</span><br><span class="line">      <span class="attr">apiKey</span>: process.<span class="property">env</span>.<span class="property">PINECONE_API_KEY</span>!,</span><br><span class="line">      <span class="attr">environment</span>: process.<span class="property">env</span>.<span class="property">PINECONE_ENVIRONMENT</span>!</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">index</span> = <span class="variable language_">this</span>.<span class="property">pinecone</span>.<span class="title class_">Index</span>(indexName);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">addDocuments</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="attr">documents</span>: <span class="title class_">Array</span>&lt;&#123;</span></span><br><span class="line"><span class="params">      id: <span class="built_in">string</span>;</span></span><br><span class="line"><span class="params">      text: <span class="built_in">string</span>;</span></span><br><span class="line"><span class="params">      metadata?: Record&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span></span><br><span class="line"><span class="params">    &#125;&gt;</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> vectors = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">      documents.<span class="title function_">map</span>(<span class="title function_">async</span> (doc) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> embedding = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">embeddings</span>.<span class="title function_">embedQuery</span>(doc.<span class="property">text</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">id</span>: doc.<span class="property">id</span>,</span><br><span class="line">          <span class="attr">values</span>: embedding,</span><br><span class="line">          <span class="attr">metadata</span>: &#123;</span><br><span class="line">            ...doc.<span class="property">metadata</span>,</span><br><span class="line">            <span class="attr">text</span>: doc.<span class="property">text</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">index</span>.<span class="title function_">upsert</span>(&#123;</span><br><span class="line">      <span class="attr">vectors</span>: vectors,</span><br><span class="line">      <span class="attr">namespace</span>: <span class="string">&#x27;default&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">similaritySearch</span>(</span><br><span class="line">    <span class="attr">query</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">topK</span>: <span class="built_in">number</span> = <span class="number">5</span>,</span><br><span class="line">    <span class="attr">filter</span>?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;</span><br><span class="line">  ): <span class="title class_">Promise</span>&lt;<span class="title class_">Array</span>&lt;&#123;<span class="attr">id</span>: <span class="built_in">string</span>; <span class="attr">score</span>: <span class="built_in">number</span>; <span class="attr">metadata</span>: <span class="built_in">any</span>&#125;&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> queryEmbedding = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">embeddings</span>.<span class="title function_">embedQuery</span>(query);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">index</span>.<span class="title function_">query</span>(&#123;</span><br><span class="line">      <span class="attr">queryRequest</span>: &#123;</span><br><span class="line">        <span class="attr">vector</span>: queryEmbedding,</span><br><span class="line">        <span class="attr">topK</span>: topK,</span><br><span class="line">        <span class="attr">includeMetadata</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">filter</span>: filter</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result.<span class="property">matches</span>?.<span class="title function_">map</span>(<span class="function">(<span class="params"><span class="attr">match</span>: <span class="built_in">any</span></span>) =&gt;</span> (&#123;</span><br><span class="line">      <span class="attr">id</span>: match.<span class="property">id</span>,</span><br><span class="line">      <span class="attr">score</span>: match.<span class="property">score</span>,</span><br><span class="line">      <span class="attr">metadata</span>: match.<span class="property">metadata</span></span><br><span class="line">    &#125;)) || [];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-æ–‡æ¡£å¤„ç†ä¸åˆ‡åˆ†"><a href="#4-4-æ–‡æ¡£å¤„ç†ä¸åˆ‡åˆ†" class="headerlink" title="4.4 æ–‡æ¡£å¤„ç†ä¸åˆ‡åˆ†"></a>4.4 æ–‡æ¡£å¤„ç†ä¸åˆ‡åˆ†</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/rag/document-loader.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">DocumentLoader</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŒ‰å­—ç¬¦æ•°åˆ‡åˆ†æ–‡æ¡£</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">splitByCharacter</span>(</span><br><span class="line">    <span class="attr">text</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">chunkSize</span>: <span class="built_in">number</span> = <span class="number">1000</span>,</span><br><span class="line">    <span class="attr">overlap</span>: <span class="built_in">number</span> = <span class="number">200</span></span><br><span class="line">  ): <span class="built_in">string</span>[] &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">chunks</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">    <span class="keyword">let</span> start = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (start &lt; text.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> end = start + chunkSize;</span><br><span class="line">      <span class="keyword">const</span> chunk = text.<span class="title function_">slice</span>(start, end);</span><br><span class="line">      chunks.<span class="title function_">push</span>(chunk);</span><br><span class="line">      start = end - overlap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> chunks;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŒ‰æ®µè½åˆ‡åˆ†ï¼ˆä¿æŒè¯­ä¹‰å®Œæ•´æ€§ï¼‰</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">splitByParagraph</span>(<span class="attr">text</span>: <span class="built_in">string</span>): <span class="built_in">string</span>[] &#123;</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line">      .<span class="title function_">split</span>(<span class="regexp">/\n\n+/</span>)</span><br><span class="line">      .<span class="title function_">map</span>(<span class="function"><span class="params">p</span> =&gt;</span> p.<span class="title function_">trim</span>())</span><br><span class="line">      .<span class="title function_">filter</span>(<span class="function"><span class="params">p</span> =&gt;</span> p.<span class="property">length</span> &gt; <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŒ‰æ ‡é¢˜å±‚æ¬¡åˆ‡åˆ†ï¼ˆMarkdown ä¸“ç”¨ï¼‰</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">splitMarkdownByHeading</span>(<span class="attr">text</span>: <span class="built_in">string</span>): <span class="title class_">Array</span>&lt;&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">level</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">  &#125;&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">sections</span>: <span class="title class_">Array</span>&lt;&#123;<span class="attr">title</span>: <span class="built_in">string</span>; <span class="attr">level</span>: <span class="built_in">number</span>; <span class="attr">content</span>: <span class="built_in">string</span>&#125;&gt; = [];</span><br><span class="line">    <span class="keyword">const</span> lines = text.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> currentSection = &#123; <span class="attr">title</span>: <span class="string">&#x27;Introduction&#x27;</span>, <span class="attr">level</span>: <span class="number">0</span>, <span class="attr">content</span>: <span class="string">&#x27;&#x27;</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> line <span class="keyword">of</span> lines) &#123;</span><br><span class="line">      <span class="keyword">const</span> headingMatch = line.<span class="title function_">match</span>(<span class="regexp">/^(#&#123;1,6&#125;)\s+(.+)$/</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (headingMatch) &#123;</span><br><span class="line">        <span class="comment">// ä¿å­˜å½“å‰ç« èŠ‚</span></span><br><span class="line">        <span class="keyword">if</span> (currentSection.<span class="property">content</span>) &#123;</span><br><span class="line">          sections.<span class="title function_">push</span>(&#123;...currentSection&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€å§‹æ–°ç« èŠ‚</span></span><br><span class="line">        currentSection = &#123;</span><br><span class="line">          <span class="attr">title</span>: headingMatch[<span class="number">2</span>],</span><br><span class="line">          <span class="attr">level</span>: headingMatch[<span class="number">1</span>].<span class="property">length</span>,</span><br><span class="line">          <span class="attr">content</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        currentSection.<span class="property">content</span> += line + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (currentSection.<span class="property">content</span>) &#123;</span><br><span class="line">      sections.<span class="title function_">push</span>(currentSection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sections;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ™ºèƒ½åˆ‡åˆ†ï¼šç»“åˆå¤šç§ç­–ç•¥</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">smartSplit</span>(</span><br><span class="line">    <span class="attr">text</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">options</span>: &#123;</span><br><span class="line">      <span class="attr">maxSize</span>?: <span class="built_in">number</span>;</span><br><span class="line">      <span class="attr">overlap</span>?: <span class="built_in">number</span>;</span><br><span class="line">      <span class="attr">preserveStructure</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">    &#125; = &#123;&#125;</span><br><span class="line">  ): <span class="title class_">Promise</span>&lt;<span class="title class_">Array</span>&lt;&#123;<span class="attr">id</span>: <span class="built_in">string</span>; <span class="attr">text</span>: <span class="built_in">string</span>; <span class="attr">metadata</span>: <span class="built_in">any</span>&#125;&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">chunks</span>: <span class="title class_">Array</span>&lt;&#123;<span class="attr">id</span>: <span class="built_in">string</span>; <span class="attr">text</span>: <span class="built_in">string</span>; <span class="attr">metadata</span>: <span class="built_in">any</span>&#125;&gt; = [];</span><br><span class="line">    <span class="keyword">const</span> &#123; maxSize = <span class="number">1000</span>, overlap = <span class="number">200</span>, preserveStructure = <span class="literal">true</span> &#125; = options;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (preserveStructure) &#123;</span><br><span class="line">      <span class="comment">// ä¼˜å…ˆæŒ‰æ®µè½åˆ‡åˆ†</span></span><br><span class="line">      <span class="keyword">const</span> paragraphs = <span class="variable language_">this</span>.<span class="title function_">splitByParagraph</span>(text);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; paragraphs.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> paragraph = paragraphs[i];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæ®µè½å¤ªé•¿ï¼Œè¿›ä¸€æ­¥åˆ‡åˆ†</span></span><br><span class="line">        <span class="keyword">if</span> (paragraph.<span class="property">length</span> &gt; maxSize) &#123;</span><br><span class="line">          <span class="keyword">const</span> subChunks = <span class="variable language_">this</span>.<span class="title function_">splitByCharacter</span>(paragraph, maxSize, overlap);</span><br><span class="line">          subChunks.<span class="title function_">forEach</span>(<span class="function">(<span class="params">chunk, j</span>) =&gt;</span> &#123;</span><br><span class="line">            chunks.<span class="title function_">push</span>(&#123;</span><br><span class="line">              <span class="attr">id</span>: <span class="string">`chunk_<span class="subst">$&#123;i&#125;</span>_<span class="subst">$&#123;j&#125;</span>`</span>,</span><br><span class="line">              <span class="attr">text</span>: chunk,</span><br><span class="line">              <span class="attr">metadata</span>: &#123;</span><br><span class="line">                <span class="attr">source</span>: <span class="string">&#x27;paragraph&#x27;</span>,</span><br><span class="line">                <span class="attr">paragraphIndex</span>: i,</span><br><span class="line">                <span class="attr">chunkIndex</span>: j</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          chunks.<span class="title function_">push</span>(&#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="string">`paragraph_<span class="subst">$&#123;i&#125;</span>`</span>,</span><br><span class="line">            <span class="attr">text</span>: paragraph,</span><br><span class="line">            <span class="attr">metadata</span>: &#123;</span><br><span class="line">              <span class="attr">source</span>: <span class="string">&#x27;paragraph&#x27;</span>,</span><br><span class="line">              <span class="attr">index</span>: i</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// ç›´æ¥æŒ‰å­—ç¬¦åˆ‡åˆ†</span></span><br><span class="line">      <span class="keyword">const</span> textChunks = <span class="variable language_">this</span>.<span class="title function_">splitByCharacter</span>(text, maxSize, overlap);</span><br><span class="line">      textChunks.<span class="title function_">forEach</span>(<span class="function">(<span class="params">chunk, i</span>) =&gt;</span> &#123;</span><br><span class="line">        chunks.<span class="title function_">push</span>(&#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="string">`chunk_<span class="subst">$&#123;i&#125;</span>`</span>,</span><br><span class="line">          <span class="attr">text</span>: chunk,</span><br><span class="line">          <span class="attr">metadata</span>: &#123; <span class="attr">index</span>: i &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> chunks;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-5-å®Œæ•´çš„-RAG-ç®¡é“"><a href="#4-5-å®Œæ•´çš„-RAG-ç®¡é“" class="headerlink" title="4.5 å®Œæ•´çš„ RAG ç®¡é“"></a>4.5 å®Œæ•´çš„ RAG ç®¡é“</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/rag/rag-pipeline.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">VectorStore</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./vector-store&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">DocumentLoader</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./document-loader&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LLMClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../llm/openai-client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">RAGPipeline</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">vectorStore</span>: <span class="title class_">VectorStore</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">llm</span>: <span class="title class_">LLMClient</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">vectorStore</span>: <span class="title class_">VectorStore</span>, <span class="attr">llm</span>: <span class="title class_">LLMClient</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vectorStore</span> = vectorStore;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">llm</span> = llm;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç´¢å¼•æ–‡æ¡£</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">indexDocuments</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="attr">documents</span>: <span class="title class_">Array</span>&lt;&#123;</span></span><br><span class="line"><span class="params">      id: <span class="built_in">string</span>;</span></span><br><span class="line"><span class="params">      text: <span class="built_in">string</span>;</span></span><br><span class="line"><span class="params">      metadata?: Record&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span></span><br><span class="line"><span class="params">    &#125;&gt;</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> chunks = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">      documents.<span class="title function_">map</span>(<span class="title function_">async</span> (doc) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> splitChunks = <span class="keyword">await</span> <span class="title class_">DocumentLoader</span>.<span class="title function_">smartSplit</span>(doc.<span class="property">text</span>, &#123;</span><br><span class="line">          <span class="attr">maxSize</span>: <span class="number">500</span>,</span><br><span class="line">          <span class="attr">overlap</span>: <span class="number">50</span>,</span><br><span class="line">          <span class="attr">preserveStructure</span>: <span class="literal">true</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> splitChunks.<span class="title function_">map</span>(<span class="function">(<span class="params">chunk, idx</span>) =&gt;</span> (&#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="string">`<span class="subst">$&#123;doc.id&#125;</span>_<span class="subst">$&#123;idx&#125;</span>`</span>,</span><br><span class="line">          <span class="attr">text</span>: chunk.<span class="property">text</span>,</span><br><span class="line">          <span class="attr">metadata</span>: &#123;</span><br><span class="line">            ...doc.<span class="property">metadata</span>,</span><br><span class="line">            ...chunk.<span class="property">metadata</span>,</span><br><span class="line">            <span class="attr">docId</span>: doc.<span class="property">id</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;));</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> allChunks = chunks.<span class="title function_">flat</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">vectorStore</span>.<span class="title function_">addDocuments</span>(allChunks);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Indexed <span class="subst">$&#123;allChunks.length&#125;</span> chunks from <span class="subst">$&#123;documents.length&#125;</span> documents`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æŸ¥è¯¢å¹¶ç”Ÿæˆç­”æ¡ˆ</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">query</span>(</span><br><span class="line">    <span class="attr">question</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">options</span>: &#123;</span><br><span class="line">      <span class="attr">topK</span>?: <span class="built_in">number</span>;</span><br><span class="line">      <span class="attr">filter</span>?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span><br><span class="line">      <span class="attr">includeSources</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">    &#125; = &#123;&#125;</span><br><span class="line">  ): <span class="title class_">Promise</span>&lt;&#123;</span><br><span class="line">    <span class="attr">answer</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">sources</span>?: <span class="title class_">Array</span>&lt;&#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">      <span class="attr">text</span>: <span class="built_in">string</span>;</span><br><span class="line">      <span class="attr">score</span>: <span class="built_in">number</span>;</span><br><span class="line">      <span class="attr">metadata</span>: <span class="built_in">any</span>;</span><br><span class="line">    &#125;&gt;;</span><br><span class="line">  &#125;&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; topK = <span class="number">5</span>, filter, includeSources = <span class="literal">true</span> &#125; = options;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£</span></span><br><span class="line">    <span class="keyword">const</span> relevantDocs = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">vectorStore</span>.<span class="title function_">similaritySearch</span>(</span><br><span class="line">      question,</span><br><span class="line">      topK,</span><br><span class="line">      filter</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ„å»ºä¸Šä¸‹æ–‡</span></span><br><span class="line">    <span class="keyword">const</span> context = relevantDocs</span><br><span class="line">      .<span class="title function_">map</span>(<span class="function">(<span class="params">doc, idx</span>) =&gt;</span> <span class="string">`[æ¥æº <span class="subst">$&#123;idx + <span class="number">1</span>&#125;</span>] <span class="subst">$&#123;doc.metadata.text&#125;</span>`</span>)</span><br><span class="line">      .<span class="title function_">join</span>(<span class="string">&#x27;\n\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. ç”Ÿæˆæç¤º</span></span><br><span class="line">    <span class="keyword">const</span> prompt = <span class="string">`</span></span><br><span class="line"><span class="string">      åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ã€‚å¦‚æœä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œè¯·æ˜ç¡®è¯´æ˜ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      ä¸Šä¸‹æ–‡ï¼š</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;context&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      é—®é¢˜ï¼š<span class="subst">$&#123;question&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      ç­”æ¡ˆï¼š</span></span><br><span class="line"><span class="string">    `</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. ç”Ÿæˆç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">const</span> answer = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">llm</span>.<span class="title function_">chat</span>([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŠ©æ‰‹ï¼Œè´Ÿè´£åŸºäºæä¾›çš„ä¸Šä¸‹æ–‡å‡†ç¡®å›ç­”é—®é¢˜ã€‚&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: prompt &#125;</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. è¿”å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">any</span> = &#123; answer &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (includeSources) &#123;</span><br><span class="line">      result.<span class="property">sources</span> = relevantDocs.<span class="title function_">map</span>(<span class="function"><span class="params">doc</span> =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">id</span>: doc.<span class="property">id</span>,</span><br><span class="line">        <span class="attr">text</span>: doc.<span class="property">metadata</span>.<span class="property">text</span>?.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">200</span>) + <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">        <span class="attr">score</span>: doc.<span class="property">score</span>,</span><br><span class="line">        <span class="attr">metadata</span>: doc.<span class="property">metadata</span></span><br><span class="line">      &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-6-ä½¿ç”¨-RAG-æ„å»ºçŸ¥è¯†é—®ç­”ç³»ç»Ÿ"><a href="#4-6-ä½¿ç”¨-RAG-æ„å»ºçŸ¥è¯†é—®ç­”ç³»ç»Ÿ" class="headerlink" title="4.6 ä½¿ç”¨ RAG æ„å»ºçŸ¥è¯†é—®ç­”ç³»ç»Ÿ"></a>4.6 ä½¿ç”¨ RAG æ„å»ºçŸ¥è¯†é—®ç­”ç³»ç»Ÿ</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/rag/knowledge-base.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RAGPipeline</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./rag-pipeline&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">VectorStore</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./vector-store&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LLMClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../llm/openai-client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">KnowledgeBase</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">rag</span>: <span class="title class_">RAGPipeline</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> vectorStore = <span class="keyword">new</span> <span class="title class_">VectorStore</span>();</span><br><span class="line">    <span class="keyword">const</span> llm = <span class="keyword">new</span> <span class="title class_">LLMClient</span>(process.<span class="property">env</span>.<span class="property">OPENAI_API_KEY</span>!);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rag</span> = <span class="keyword">new</span> <span class="title class_">RAGPipeline</span>(vectorStore, llm);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">initialize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">rag</span>[<span class="string">&#x27;vectorStore&#x27;</span>].<span class="title function_">initialize</span>(<span class="string">&#x27;techflow-kb&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ä» Markdown æ–‡ä»¶åŠ è½½æ–‡æ¡£</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">loadFromMarkdown</span>(<span class="params"><span class="attr">files</span>: <span class="built_in">string</span>[]</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> fs = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;fs/promises&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> file <span class="keyword">of</span> files) &#123;</span><br><span class="line">      <span class="keyword">const</span> content = <span class="keyword">await</span> fs.<span class="title function_">readFile</span>(file, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line">      <span class="keyword">const</span> fileName = file.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">pop</span>()!;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">rag</span>.<span class="title function_">indexDocuments</span>([&#123;</span><br><span class="line">        <span class="attr">id</span>: fileName.<span class="title function_">replace</span>(<span class="string">&#x27;.md&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">        <span class="attr">text</span>: content,</span><br><span class="line">        <span class="attr">metadata</span>: &#123;</span><br><span class="line">          <span class="attr">source</span>: file,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;markdown&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ä»ç½‘é¡µåŠ è½½æ–‡æ¡£</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">loadFromWeb</span>(<span class="params"><span class="attr">urls</span>: <span class="built_in">string</span>[]</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> axios = (<span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;axios&#x27;</span>)).<span class="property">default</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="variable constant_">JSDOM</span> &#125; = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;jsdom&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> url <span class="keyword">of</span> urls) &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(url);</span><br><span class="line">      <span class="keyword">const</span> dom = <span class="keyword">new</span> <span class="title function_">JSDOM</span>(response.<span class="property">data</span>);</span><br><span class="line">      <span class="keyword">const</span> text = dom.<span class="property">window</span>.<span class="property">document</span>.<span class="property">body</span>.<span class="property">textContent</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">rag</span>.<span class="title function_">indexDocuments</span>([&#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="keyword">new</span> <span class="title function_">URL</span>(url).<span class="property">hostname</span>,</span><br><span class="line">        <span class="attr">text</span>: text,</span><br><span class="line">        <span class="attr">metadata</span>: &#123;</span><br><span class="line">          <span class="attr">source</span>: url,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;webpage&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * é—®ç­”æ¥å£</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">ask</span>(<span class="params"><span class="attr">question</span>: <span class="built_in">string</span>, <span class="attr">topK</span>: <span class="built_in">number</span> = <span class="number">5</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">rag</span>.<span class="title function_">query</span>(question, &#123; topK, <span class="attr">includeSources</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> kb = <span class="keyword">new</span> <span class="title class_">KnowledgeBase</span>();</span><br><span class="line">  <span class="keyword">await</span> kb.<span class="title function_">initialize</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŠ è½½æ–‡æ¡£</span></span><br><span class="line">  <span class="keyword">await</span> kb.<span class="title function_">loadFromMarkdown</span>([</span><br><span class="line">    <span class="string">&#x27;./docs/react-guide.md&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;./docs/vue3-guide.md&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;./docs/typescript-best-practices.md&#x27;</span></span><br><span class="line">  ]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é—®ç­”</span></span><br><span class="line">  <span class="keyword">const</span> answer = <span class="keyword">await</span> kb.<span class="title function_">ask</span>(<span class="string">&#x27;React Hooks æœ‰å“ªäº›æœ€ä½³å®è·µï¼Ÿ&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Answer:&#x27;</span>, answer.<span class="property">answer</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Sources:&#x27;</span>, answer.<span class="property">sources</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€å®æˆ˜é¡¹ç›®ï¼šæ™ºèƒ½ä»£ç åŠ©æ‰‹"><a href="#äº”ã€å®æˆ˜é¡¹ç›®ï¼šæ™ºèƒ½ä»£ç åŠ©æ‰‹" class="headerlink" title="äº”ã€å®æˆ˜é¡¹ç›®ï¼šæ™ºèƒ½ä»£ç åŠ©æ‰‹"></a>äº”ã€å®æˆ˜é¡¹ç›®ï¼šæ™ºèƒ½ä»£ç åŠ©æ‰‹</h2><h3 id="5-1-é¡¹ç›®æ¦‚è¿°"><a href="#5-1-é¡¹ç›®æ¦‚è¿°" class="headerlink" title="5.1 é¡¹ç›®æ¦‚è¿°"></a>5.1 é¡¹ç›®æ¦‚è¿°</h3><p>æ„å»ºä¸€ä¸ª AI é©±åŠ¨çš„ä»£ç åŠ©æ‰‹ï¼Œå…·å¤‡ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>ğŸ’¬ ä»£ç é—®ç­”</li>
<li>ğŸ” ä»£ç æœç´¢</li>
<li>ğŸ“ ä»£ç ç”Ÿæˆ</li>
<li>ğŸ”§ ä»£ç é‡æ„å»ºè®®</li>
<li>ğŸ“š æ–‡æ¡£ç”Ÿæˆ</li>
</ul>
<p><img src="https://images.unsplash.com/photo-1516116216624-53e697fedbea?w=1200&h=600&fit=crop" alt="Code Assistant Demo"></p>
<h3 id="5-2-é¡¹ç›®ç»“æ„"><a href="#5-2-é¡¹ç›®ç»“æ„" class="headerlink" title="5.2 é¡¹ç›®ç»“æ„"></a>5.2 é¡¹ç›®ç»“æ„</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code-assistant/</span><br><span class="line">â”œâ”€â”€ frontend/                 # Next.js å‰ç«¯</span><br><span class="line">â”‚   â”œâ”€â”€ app/</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ api/</span><br><span class="line">â”‚   â”‚   â”‚   â”œâ”€â”€ chat/        # èŠå¤© API</span><br><span class="line">â”‚   â”‚   â”‚   â”œâ”€â”€ search/      # æœç´¢ API</span><br><span class="line">â”‚   â”‚   â”‚   â””â”€â”€ generate/    # ä»£ç ç”Ÿæˆ API</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ page.tsx         # ä¸»é¡µé¢</span><br><span class="line">â”‚   â”‚   â””â”€â”€ layout.tsx</span><br><span class="line">â”‚   â”œâ”€â”€ components/</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ ChatBox.tsx</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ CodeEditor.tsx</span><br><span class="line">â”‚   â”‚   â””â”€â”€ FileExplorer.tsx</span><br><span class="line">â”‚   â””â”€â”€ lib/</span><br><span class="line">â”‚       â”œâ”€â”€ llm.ts</span><br><span class="line">â”‚       â””â”€â”€ rag.ts</span><br><span class="line">â”œâ”€â”€ backend/                  # Python åç«¯ï¼ˆå¯é€‰ï¼‰</span><br><span class="line">â”‚   â””â”€â”€ services/</span><br><span class="line">â”‚       â”œâ”€â”€ code_analysis.py</span><br><span class="line">â”‚       â””â”€â”€ test_generation.py</span><br><span class="line">â””â”€â”€ shared/</span><br><span class="line">    â””â”€â”€ types.ts</span><br></pre></td></tr></table></figure>

<h3 id="5-3-æ ¸å¿ƒå®ç°"><a href="#5-3-æ ¸å¿ƒå®ç°" class="headerlink" title="5.3 æ ¸å¿ƒå®ç°"></a>5.3 æ ¸å¿ƒå®ç°</h3><p><strong>Chat APIï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// app/api/chat/route.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NextRequest</span>, <span class="title class_">NextResponse</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;next/server&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LLMClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/lib/llm&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">KnowledgeBase</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/lib/rag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> llm = <span class="keyword">new</span> <span class="title class_">LLMClient</span>(process.<span class="property">env</span>.<span class="property">OPENAI_API_KEY</span>!);</span><br><span class="line"><span class="keyword">const</span> kb = <span class="keyword">new</span> <span class="title class_">KnowledgeBase</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">POST</span>(<span class="params"><span class="attr">request</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; message, context &#125; = <span class="keyword">await</span> request.<span class="title function_">json</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ RAG å¢å¼ºçš„å›ç­”</span></span><br><span class="line">    <span class="keyword">if</span> (context?.<span class="property">useKnowledgeBase</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> answer = <span class="keyword">await</span> kb.<span class="title function_">ask</span>(message, <span class="number">3</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123;</span><br><span class="line">        <span class="attr">response</span>: answer.<span class="property">answer</span>,</span><br><span class="line">        <span class="attr">sources</span>: answer.<span class="property">sources</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ™®é€šå¯¹è¯</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> llm.<span class="title function_">chat</span>([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&#x27;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä»£ç åŠ©æ‰‹ï¼Œæ“…é•¿å¸®åŠ©å¼€å‘è€…è§£å†³é—®é¢˜ã€‚&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: message &#125;</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; response &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Chat API Error:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(</span><br><span class="line">      &#123; <span class="attr">error</span>: <span class="string">&#x27;Internal server error&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">status</span>: <span class="number">500</span> &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä»£ç ç”Ÿæˆ APIï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// app/api/generate/route.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NextRequest</span>, <span class="title class_">NextResponse</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;next/server&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LLMClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/lib/llm&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> llm = <span class="keyword">new</span> <span class="title class_">LLMClient</span>(process.<span class="property">env</span>.<span class="property">OPENAI_API_KEY</span>!);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">POST</span>(<span class="params"><span class="attr">request</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; prompt, language, context &#125; = <span class="keyword">await</span> request.<span class="title function_">json</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> systemPrompt = <span class="string">`</span></span><br><span class="line"><span class="string">    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä»£ç ç”ŸæˆåŠ©æ‰‹ã€‚æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚ç”Ÿæˆä»£ç ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    è¦æ±‚ï¼š</span></span><br><span class="line"><span class="string">    1. ä»£ç å¿…é¡»è¯­æ³•æ­£ç¡®</span></span><br><span class="line"><span class="string">    2. åŒ…å«å¿…è¦çš„æ³¨é‡Š</span></span><br><span class="line"><span class="string">    3. éµå¾ªæœ€ä½³å®è·µ</span></span><br><span class="line"><span class="string">    4. è€ƒè™‘è¾¹ç•Œæƒ…å†µ</span></span><br><span class="line"><span class="string">    5. å¦‚æœæä¾›äº†ä¸Šä¸‹æ–‡ä»£ç ï¼Œä¿æŒé£æ ¼ä¸€è‡´</span></span><br><span class="line"><span class="string">  `</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> userPrompt = <span class="string">`</span></span><br><span class="line"><span class="string">    è¯­è¨€ï¼š<span class="subst">$&#123;language&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ç”¨æˆ·éœ€æ±‚ï¼š<span class="subst">$&#123;prompt&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    <span class="subst">$&#123;context ? <span class="string">`ä¸Šä¸‹æ–‡ä»£ç ï¼š\n<span class="subst">$&#123;context&#125;</span>`</span> : <span class="string">&#x27;&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    è¯·ç”Ÿæˆä»£ç ï¼š</span></span><br><span class="line"><span class="string">  `</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> llm.<span class="title function_">chat</span>([</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;system&#x27;</span>, <span class="attr">content</span>: systemPrompt &#125;,</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: userPrompt &#125;</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(&#123; <span class="attr">code</span>: response &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Generate API Error:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">json</span>(</span><br><span class="line">      &#123; <span class="attr">error</span>: <span class="string">&#x27;Code generation failed&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">status</span>: <span class="number">500</span> &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å‰ç«¯ç»„ä»¶ï¼š</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// components/ChatBox.tsx</span></span><br><span class="line"><span class="string">&#x27;use client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; useState, useRef, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">  <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span> | <span class="string">&#x27;assistant&#x27;</span>;</span><br><span class="line">  <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">sources</span>?: <span class="title class_">Array</span>&lt;&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">text</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">score</span>: <span class="built_in">number</span>;</span><br><span class="line">  &#125;&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">ChatBox</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [messages, setMessages] = useState&lt;<span class="title class_">Message</span>[]&gt;([]);</span><br><span class="line">  <span class="keyword">const</span> [input, setInput] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> [useKB, setUseKB] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> messagesEndRef = useRef&lt;<span class="title class_">HTMLDivElement</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">scrollToBottom</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    messagesEndRef.<span class="property">current</span>?.<span class="title function_">scrollIntoView</span>(&#123; <span class="attr">behavior</span>: <span class="string">&#x27;smooth&#x27;</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">scrollToBottom</span>();</span><br><span class="line">  &#125;, [messages]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">sendMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!input.<span class="title function_">trim</span>()) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">userMessage</span>: <span class="title class_">Message</span> = &#123; <span class="attr">role</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">content</span>: input &#125;;</span><br><span class="line">    <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, userMessage]);</span><br><span class="line">    <span class="title function_">setInput</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/chat&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;,</span><br><span class="line">        <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">          <span class="attr">message</span>: input,</span><br><span class="line">          <span class="attr">context</span>: &#123; <span class="attr">useKnowledgeBase</span>: useKB &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line"></span><br><span class="line">      <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, &#123;</span><br><span class="line">        <span class="attr">role</span>: <span class="string">&#x27;assistant&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: data.<span class="property">response</span>,</span><br><span class="line">        <span class="attr">sources</span>: data.<span class="property">sources</span></span><br><span class="line">      &#125;]);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error);</span><br><span class="line">      <span class="title function_">setMessages</span>(<span class="function"><span class="params">prev</span> =&gt;</span> [...prev, &#123;</span><br><span class="line">        <span class="attr">role</span>: <span class="string">&#x27;assistant&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&#x27;æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯ã€‚è¯·ç¨åé‡è¯•ã€‚&#x27;</span></span><br><span class="line">      &#125;]);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex flex-col h-full&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* Header */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;border-b p-4 flex justify-between items-center&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;text-xl font-bold&quot;</span>&gt;</span>æ™ºèƒ½ä»£ç åŠ©æ‰‹<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">className</span>=<span class="string">&quot;flex items-center gap-2&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checked</span>=<span class="string">&#123;useKB&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setUseKB(e.target.checked)&#125;</span></span><br><span class="line"><span class="language-xml">            className=&quot;w-4 h-4&quot;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;text-sm&quot;</span>&gt;</span>ä½¿ç”¨çŸ¥è¯†åº“<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      &#123;/* Messages */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex-1 overflow-y-auto p-4 space-y-4&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;messages.map((msg, idx) =&gt; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">key</span>=<span class="string">&#123;idx&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">flex</span> $&#123;<span class="attr">msg.role</span> === <span class="string">&#x27;user&#x27;</span> ? &#x27;<span class="attr">justify-end</span>&#x27; <span class="attr">:</span> &#x27;<span class="attr">justify-start</span>&#x27;&#125;`&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">max-w-</span>[<span class="attr">80</span>%] <span class="attr">rounded-lg</span> <span class="attr">p-4</span> $&#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">msg.role</span> === <span class="string">&#x27;user&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                ? &#x27;<span class="attr">bg-blue-500</span> <span class="attr">text-white</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">:</span> &#x27;<span class="attr">bg-gray-100</span> <span class="attr">text-gray-900</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#125;`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;whitespace-pre-wrap&quot;</span>&gt;</span>&#123;msg.content&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">              &#123;msg.sources &amp;&amp; msg.sources.length &gt; 0 &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;mt-4 pt-4 border-t border-gray-300&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;text-xs font-semibold mb-2&quot;</span>&gt;</span>å‚è€ƒæ¥æºï¼š<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  &#123;msg.sources.map((source, i) =&gt; (</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;i&#125;</span> <span class="attr">className</span>=<span class="string">&quot;text-xs mt-1 p-2 bg-white rounded&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;font-semibold&quot;</span>&gt;</span>[&#123;source.id&#125;]<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;opacity-80&quot;</span>&gt;</span>&#123;source.text&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  ))&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ))&#125;</span></span><br><span class="line"><span class="language-xml">        &#123;loading &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex justify-start&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;bg-gray-100 rounded-lg p-4&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex space-x-2&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;w-2 h-2 bg-gray-400 rounded-full animate-bounce&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-100&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-200&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;messagesEndRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      &#123;/* Input */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;border-t p-4&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex gap-2&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">value</span>=<span class="string">&#123;input&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setInput(e.target.value)&#125;</span></span><br><span class="line"><span class="language-xml">            onKeyPress=&#123;(e) =&gt; e.key === &#x27;Enter&#x27; &amp;&amp; sendMessage()&#125;</span></span><br><span class="line"><span class="language-xml">            placeholder=&quot;è¾“å…¥ä½ çš„é—®é¢˜...&quot;</span></span><br><span class="line"><span class="language-xml">            className=&quot;flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500&quot;</span></span><br><span class="line"><span class="language-xml">            disabled=&#123;loading&#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onClick</span>=<span class="string">&#123;sendMessage&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">disabled</span>=<span class="string">&#123;loading</span> || !<span class="attr">input.trim</span>()&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">className</span>=<span class="string">&quot;px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            å‘é€</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€éƒ¨ç½²ä¸ä¼˜åŒ–"><a href="#å…­ã€éƒ¨ç½²ä¸ä¼˜åŒ–" class="headerlink" title="å…­ã€éƒ¨ç½²ä¸ä¼˜åŒ–"></a>å…­ã€éƒ¨ç½²ä¸ä¼˜åŒ–</h2><h3 id="6-1-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"><a href="#6-1-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="6.1 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"></a>6.1 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h3><p><strong>1. ç¼“å­˜æœºåˆ¶</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/cache/redis-cache.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Redis</span> <span class="keyword">from</span> <span class="string">&#x27;ioredis&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CacheService</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">redis</span>: <span class="title class_">Redis</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">redis</span> = <span class="keyword">new</span> <span class="title class_">Redis</span>(process.<span class="property">env</span>.<span class="property">REDIS_URL</span>!);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> get&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;T | <span class="literal">null</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> cached = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">redis</span>.<span class="title function_">get</span>(key);</span><br><span class="line">    <span class="keyword">return</span> cached ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(cached) : <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">set</span>(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: <span class="built_in">any</span>, <span class="attr">ttl</span>: <span class="built_in">number</span> = <span class="number">3600</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">redis</span>.<span class="title function_">setex</span>(key, ttl, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">invalidate</span>(<span class="attr">pattern</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> keys = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">redis</span>.<span class="title function_">keys</span>(pattern);</span><br><span class="line">    <span class="keyword">if</span> (keys.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">redis</span>.<span class="title function_">del</span>(...keys);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¼“å­˜åŒ…è£… LLM è°ƒç”¨</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">CachedLLMClient</span> <span class="keyword">extends</span> <span class="title class_ inherited__">LLMClient</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">cache</span>: <span class="title class_">CacheService</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">apiKey</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(apiKey);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cache</span> = <span class="keyword">new</span> <span class="title class_">CacheService</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">chat</span>(<span class="attr">messages</span>: <span class="title class_">Array</span>&lt;<span class="built_in">any</span>&gt;, <span class="attr">model</span>: <span class="built_in">string</span> = <span class="string">&#x27;gpt-4&#x27;</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// ç”Ÿæˆç¼“å­˜é”®</span></span><br><span class="line">    <span class="keyword">const</span> cacheKey = <span class="string">`llm:<span class="subst">$&#123;model&#125;</span>:<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(messages)&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è¯•ä»ç¼“å­˜è·å–</span></span><br><span class="line">    <span class="keyword">const</span> cached = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="property">get</span>&lt;<span class="built_in">string</span>&gt;(cacheKey);</span><br><span class="line">    <span class="keyword">if</span> (cached) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Cache hit!&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span> cached;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨ API</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">super</span>.<span class="title function_">chat</span>(messages, model);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¼“å­˜ç»“æœï¼ˆ24å°æ—¶ï¼‰</span></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">set</span>(cacheKey, response, <span class="number">86400</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2. æ‰¹å¤„ç†ä¸å¹¶å‘</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‰¹é‡å¤„ç†æ–‡æ¡£ç´¢å¼•</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">batchIndexDocuments</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">documents</span>: <span class="title class_">Array</span>&lt;<span class="built_in">any</span>&gt;,</span></span><br><span class="line"><span class="params">  <span class="attr">batchSize</span>: <span class="built_in">number</span> = <span class="number">10</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; documents.<span class="property">length</span>; i += batchSize) &#123;</span><br><span class="line">    <span class="keyword">const</span> batch = documents.<span class="title function_">slice</span>(i, i + batchSize);</span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">      batch.<span class="title function_">map</span>(<span class="function"><span class="params">doc</span> =&gt;</span> rag.<span class="title function_">indexDocuments</span>([doc]))</span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Processed batch <span class="subst">$&#123;<span class="built_in">Math</span>.floor(i / batchSize) + <span class="number">1</span>&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3. æµå¼è¾“å‡º</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// app/api/stream-chat/route.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">POST</span>(<span class="params"><span class="attr">request</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; messages &#125; = <span class="keyword">await</span> request.<span class="title function_">json</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> stream = <span class="keyword">new</span> <span class="title class_">ReadableStream</span>(&#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">start</span>(<span class="params">controller</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> encoder = <span class="keyword">new</span> <span class="title class_">TextEncoder</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="title function_">await</span> (<span class="keyword">const</span> chunk <span class="keyword">of</span> llm.<span class="title function_">chatStream</span>(messages)) &#123;</span><br><span class="line">          controller.<span class="title function_">enqueue</span>(encoder.<span class="title function_">encode</span>(<span class="string">`data: <span class="subst">$&#123;chunk&#125;</span>\n\n`</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        controller.<span class="title function_">enqueue</span>(encoder.<span class="title function_">encode</span>(<span class="string">&#x27;data: [DONE]\n\n&#x27;</span>));</span><br><span class="line">        controller.<span class="title function_">close</span>();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        controller.<span class="title function_">error</span>(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(stream, &#123;</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/event-stream&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-å®‰å…¨æœ€ä½³å®è·µ"><a href="#6-2-å®‰å…¨æœ€ä½³å®è·µ" class="headerlink" title="6.2 å®‰å…¨æœ€ä½³å®è·µ"></a>6.2 å®‰å…¨æœ€ä½³å®è·µ</h3><p><strong>1. API å¯†é’¥ç®¡ç†</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># .env.local</span></span><br><span class="line">OPENAI_API_KEY=sk-xxx</span><br><span class="line">PINECONE_API_KEY=xxx-xxx</span><br><span class="line">SERPAPI_KEY=xxx</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ°¸è¿œä¸è¦æäº¤åˆ° Gitï¼</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># .gitignore</span><br><span class="line">.env</span><br><span class="line">.env.local</span><br><span class="line">.env.*.local</span><br></pre></td></tr></table></figure>

<p><strong>2. å†…å®¹è¿‡æ»¤</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/safety/content-filter.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ContentFilter</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> harmfulPatterns = [</span><br><span class="line">    <span class="regexp">/password/i</span>,</span><br><span class="line">    <span class="regexp">/api[_-]?key/i</span>,</span><br><span class="line">    <span class="regexp">/secret/i</span>,</span><br><span class="line">    <span class="regexp">/token/i</span></span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">filter</span>(<span class="attr">content</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;&#123;</span><br><span class="line">    <span class="attr">safe</span>: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="attr">filtered</span>?: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">reason</span>?: <span class="built_in">string</span>;</span><br><span class="line">  &#125;&gt; &#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ•æ„Ÿä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> pattern <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">harmfulPatterns</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (pattern.<span class="title function_">test</span>(content)) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">safe</span>: <span class="literal">false</span>,</span><br><span class="line">          <span class="attr">reason</span>: <span class="string">&#x27;å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯&#x27;</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ OpenAI Moderation API</span></span><br><span class="line">    <span class="keyword">const</span> moderation = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.openai.com/v1/moderations&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">      <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">`Bearer <span class="subst">$&#123;process.env.OPENAI_API_KEY&#125;</span>`</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">input</span>: content &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> moderation.<span class="title function_">json</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result.<span class="property">results</span>[<span class="number">0</span>].<span class="property">flagged</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">safe</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">reason</span>: <span class="string">&#x27;å†…å®¹è¿è§„&#x27;</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">safe</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3. é€Ÿç‡é™åˆ¶</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/rate-limit/limiter.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LRUCache</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;lru-cache&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">RateLimiter</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">cache</span>: <span class="title class_">LRUCache</span>&lt;<span class="built_in">string</span>, <span class="built_in">number</span>[]&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="attr">maxRequests</span>: <span class="built_in">number</span> = <span class="number">10</span>, <span class="keyword">private</span> <span class="attr">windowMs</span>: <span class="built_in">number</span> = <span class="number">60000</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cache</span> = <span class="keyword">new</span> <span class="title class_">LRUCache</span>(&#123;</span><br><span class="line">      <span class="attr">max</span>: <span class="number">500</span>,</span><br><span class="line">      <span class="attr">ttl</span>: windowMs</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">check</span>(<span class="attr">identifier</span>: <span class="built_in">string</span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">const</span> requests = <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">get</span>(identifier) || [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç§»é™¤çª—å£å¤–çš„è¯·æ±‚</span></span><br><span class="line">    <span class="keyword">const</span> validRequests = requests.<span class="title function_">filter</span>(<span class="function"><span class="params">time</span> =&gt;</span> now - time &lt; <span class="variable language_">this</span>.<span class="property">windowMs</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (validRequests.<span class="property">length</span> &gt;= <span class="variable language_">this</span>.<span class="property">maxRequests</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    validRequests.<span class="title function_">push</span>(now);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">set</span>(identifier, validRequests);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Next.js API ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">middleware</span>(<span class="params"><span class="attr">request</span>: <span class="title class_">NextRequest</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> ip = request.<span class="property">ip</span> || <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> limiter = <span class="keyword">new</span> <span class="title class_">RateLimiter</span>(<span class="number">10</span>, <span class="number">60000</span>); <span class="comment">// 10 requests per minute</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!limiter.<span class="title function_">check</span>(ip)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&#x27;Too many requests&#x27;</span>, &#123; <span class="attr">status</span>: <span class="number">429</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-ç›‘æ§ä¸æ—¥å¿—"><a href="#6-3-ç›‘æ§ä¸æ—¥å¿—" class="headerlink" title="6.3 ç›‘æ§ä¸æ—¥å¿—"></a>6.3 ç›‘æ§ä¸æ—¥å¿—</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/monitoring/logger.ts</span></span><br><span class="line"><span class="keyword">import</span> pino <span class="keyword">from</span> <span class="string">&#x27;pino&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> logger = <span class="title function_">pino</span>(&#123;</span><br><span class="line">  <span class="attr">level</span>: process.<span class="property">env</span>.<span class="property">LOG_LEVEL</span> || <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">  <span class="attr">transport</span>: &#123;</span><br><span class="line">    <span class="attr">target</span>: <span class="string">&#x27;pino-pretty&#x27;</span>,</span><br><span class="line">    <span class="attr">options</span>: &#123;</span><br><span class="line">      <span class="attr">colorize</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line">logger.<span class="title function_">info</span>(&#123; userId, query &#125;, <span class="string">&#x27;Chat request received&#x27;</span>);</span><br><span class="line">logger.<span class="title function_">error</span>(&#123; error &#125;, <span class="string">&#x27;LLM API failed&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/monitoring/metrics.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Metrics</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">counters</span>: <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="built_in">number</span>&gt; = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">value</span>: <span class="built_in">number</span> = <span class="number">1</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> current = <span class="variable language_">this</span>.<span class="property">counters</span>.<span class="title function_">get</span>(name) || <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">counters</span>.<span class="title function_">set</span>(name, current + value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getMetrics</span>(): <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">number</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(<span class="variable language_">this</span>.<span class="property">counters</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> metrics = <span class="keyword">new</span> <span class="title class_">Metrics</span>();</span><br><span class="line">metrics.<span class="title function_">increment</span>(<span class="string">&#x27;llm.requests.total&#x27;</span>);</span><br><span class="line">metrics.<span class="title function_">increment</span>(<span class="string">&#x27;llm.tokens.used&#x27;</span>, tokenCount);</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€æ€»ç»“ä¸å±•æœ›"><a href="#ä¸ƒã€æ€»ç»“ä¸å±•æœ›" class="headerlink" title="ä¸ƒã€æ€»ç»“ä¸å±•æœ›"></a>ä¸ƒã€æ€»ç»“ä¸å±•æœ›</h2><h3 id="æœ¬æ–‡å›é¡¾"><a href="#æœ¬æ–‡å›é¡¾" class="headerlink" title="æœ¬æ–‡å›é¡¾"></a>æœ¬æ–‡å›é¡¾</h3><p>æœ¬æ–‡ä»é›¶å¼€å§‹ï¼Œæ„å»ºäº†å®Œæ•´çš„ AI åº”ç”¨æ ˆï¼š</p>
<ol>
<li>âœ… <strong>LLM åŸºç¡€é›†æˆ</strong>ï¼šæŒæ¡ OpenAI API çš„ä½¿ç”¨æ–¹æ³•</li>
<li>âœ… <strong>Prompt Engineering</strong>ï¼šå­¦ä¹ è®¾è®¡é«˜è´¨é‡çš„æç¤ºè¯</li>
<li>âœ… <strong>AI Agent å¼€å‘</strong>ï¼šæ„å»ºèƒ½å¤Ÿä½¿ç”¨å·¥å…·çš„æ™ºèƒ½ä»£ç†</li>
<li>âœ… <strong>RAG ç³»ç»Ÿ</strong>ï¼šå®ç°æ£€ç´¢å¢å¼ºç”Ÿæˆï¼Œæå‡å›ç­”å‡†ç¡®æ€§</li>
<li>âœ… <strong>å®æˆ˜é¡¹ç›®</strong>ï¼šå®Œæˆæ™ºèƒ½ä»£ç åŠ©æ‰‹çš„å¼€å‘</li>
</ol>
<h3 id="æŠ€æœ¯æ ˆæ€»ç»“"><a href="#æŠ€æœ¯æ ˆæ€»ç»“" class="headerlink" title="æŠ€æœ¯æ ˆæ€»ç»“"></a>æŠ€æœ¯æ ˆæ€»ç»“</h3><table>
<thead>
<tr>
<th>å±‚çº§</th>
<th>æŠ€æœ¯</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å‰ç«¯</strong></td>
<td>Next.js, React, TypeScript</td>
<td>ç”¨æˆ·ç•Œé¢</td>
</tr>
<tr>
<td><strong>åç«¯</strong></td>
<td>Node.js, Express</td>
<td>API æœåŠ¡</td>
</tr>
<tr>
<td><strong>LLM</strong></td>
<td>OpenAI GPT-4</td>
<td>æ ¸å¿ƒæ™ºèƒ½</td>
</tr>
<tr>
<td><strong>å‘é‡å­˜å‚¨</strong></td>
<td>Pinecone, Weaviate</td>
<td>è¯­ä¹‰æ£€ç´¢</td>
</tr>
<tr>
<td><strong>æ¡†æ¶</strong></td>
<td>LangChain</td>
<td>AI åº”ç”¨å¼€å‘</td>
</tr>
<tr>
<td><strong>ç¼“å­˜</strong></td>
<td>Redis</td>
<td>æ€§èƒ½ä¼˜åŒ–</td>
</tr>
<tr>
<td><strong>ç›‘æ§</strong></td>
<td>Pino, Prometheus</td>
<td>æ—¥å¿—å’ŒæŒ‡æ ‡</td>
</tr>
</tbody></table>
<h3 id="æœªæ¥æ–¹å‘"><a href="#æœªæ¥æ–¹å‘" class="headerlink" title="æœªæ¥æ–¹å‘"></a>æœªæ¥æ–¹å‘</h3><p><strong>1. å¤šæ¨¡æ€ AI</strong></p>
<ul>
<li>å›¾åƒç†è§£ä¸ç”Ÿæˆ</li>
<li>è§†é¢‘åˆ†æ</li>
<li>è¯­éŸ³äº¤äº’</li>
</ul>
<p><strong>2. æ›´å¼ºçš„ Agent</strong></p>
<ul>
<li>è‡ªä¸»è§„åˆ’ä¸æ‰§è¡Œ</li>
<li>å¤š Agent åä½œ</li>
<li>é•¿æœŸè®°å¿†</li>
</ul>
<p><strong>3. è¾¹ç¼˜ AI</strong></p>
<ul>
<li>æœ¬åœ°æ¨¡å‹éƒ¨ç½²</li>
<li>WebGPU åŠ é€Ÿ</li>
<li>ç¦»çº¿ AI åº”ç”¨</li>
</ul>
<p><strong>4. AI + Web3</strong></p>
<ul>
<li>å»ä¸­å¿ƒåŒ– AI</li>
<li>æ•°æ®éšç§ä¿æŠ¤</li>
<li>æ¿€åŠ±æœºåˆ¶</li>
</ul>
<h3 id="å­¦ä¹ èµ„æº"><a href="#å­¦ä¹ èµ„æº" class="headerlink" title="å­¦ä¹ èµ„æº"></a>å­¦ä¹ èµ„æº</h3><ul>
<li>ğŸ“š <a href="https://platform.openai.com/docs">OpenAI Documentation</a></li>
<li>ğŸ“š <a href="https://python.langchain.com/">LangChain Documentation</a></li>
<li>ğŸ“š <a href="https://www.pinecone.io/learn/">Pinecone Learning Center</a></li>
<li>ğŸ“š <a href="https://www.youtube.com/playlist?list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ">Andrej Karpathyâ€™s Neural Networks: Zero to Hero</a></li>
</ul>
<hr>
<p><strong>ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®ï¼š</strong></p>
<ol>
<li>é€‰æ‹©ä¸€ä¸ªå®é™…é¡¹ç›®éœ€æ±‚</li>
<li>ä»ç®€å•çš„ LLM èŠå¤©å¼€å§‹</li>
<li>é€æ­¥æ·»åŠ  RAG å’Œ Agent èƒ½åŠ›</li>
<li>å…³æ³¨ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½ä¼˜åŒ–</li>
<li>æŒç»­è¿­ä»£å’Œæ”¹è¿›</li>
</ol>
<p>AI å¼€å‘æ˜¯ä¸€ä¸ªå¿«é€Ÿå‘å±•çš„é¢†åŸŸï¼Œä¿æŒå­¦ä¹ å’Œå®éªŒæ˜¯æœ€é‡è¦çš„ã€‚ç¥ä½ åœ¨ AI åº”ç”¨å¼€å‘çš„æ—…ç¨‹ä¸­æ”¶è·æ»¡æ»¡ï¼</p>
<p>ğŸš€ <strong>Happy Coding!</strong></p>
<hr>
<p><em>æœ¬æ–‡æŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„å®è·µç»éªŒå’Œé—®é¢˜ï¼</em></p>
<p><strong>ç›¸å…³æ–‡ç« ï¼š</strong></p>
<ul>
<li><a href="/categories/%E5%89%8D%E7%AB%AF/TypeScript/">TypeScriptå®Œå…¨æŒ‡å—</a></li>
<li><a href="/categories/%E5%89%8D%E7%AB%AF/%E5%B7%A5%E7%A8%8B%E5%8C%96/">å‰ç«¯å·¥ç¨‹åŒ–å®æˆ˜</a></li>
<li><a href="/categories/%E5%89%8D%E7%AB%AF/%E6%9E%B6%E6%9E%84/">å¾®å‰ç«¯æ¶æ„è®¾è®¡</a></li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>AI</category>
      </categories>
      <tags>
        <tag>AI</tag>
        <tag>å®æˆ˜æ•™ç¨‹</tag>
        <tag>å…¨æ ˆå¼€å‘</tag>
        <tag>LLM</tag>
        <tag>AI Agent</tag>
        <tag>RAG</tag>
        <tag>LangChain</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2026/01/22/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>å¾®å‰ç«¯æ¶æ„å®æˆ˜ï¼šqiankunä¸single-spaå®Œå…¨æŒ‡å—</title>
    <url>/2026/01/21/micro-frontend-architecture/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>éšç€å‰ç«¯åº”ç”¨è§„æ¨¡çš„å¢é•¿ï¼Œå•ä½“å‰ç«¯åº”ç”¨é¢ä¸´ç»´æŠ¤å›°éš¾ã€éƒ¨ç½²ç¼“æ…¢ã€æŠ€æœ¯æ ˆå›ºåŒ–ç­‰é—®é¢˜ã€‚å¾®å‰ç«¯æ¶æ„åº”è¿è€Œç”Ÿï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†å¤§å‹å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªå°å‹ã€ç‹¬ç«‹çš„åº”ç”¨ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥è®²è§£å¾®å‰ç«¯æ¶æ„çš„ä¸¤ç§ä¸»æµæ–¹æ¡ˆï¼šqiankun å’Œ single-spaã€‚</p>
<h2 id="ä¸€ã€å¾®å‰ç«¯æ¶æ„æ¦‚è¿°"><a href="#ä¸€ã€å¾®å‰ç«¯æ¶æ„æ¦‚è¿°" class="headerlink" title="ä¸€ã€å¾®å‰ç«¯æ¶æ„æ¦‚è¿°"></a>ä¸€ã€å¾®å‰ç«¯æ¶æ„æ¦‚è¿°</h2><h3 id="ä»€ä¹ˆæ˜¯å¾®å‰ç«¯ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å¾®å‰ç«¯ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¾®å‰ç«¯ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å¾®å‰ç«¯ï¼Ÿ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¾®å‰ç«¯æ¦‚å¿µï¼š</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚          å¾®å‰ç«¯åº”ç”¨æ¶æ„                   â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  ä¸»åº”ç”¨ï¼ˆBase Appï¼‰                      â”‚</span><br><span class="line">â”‚  - è·¯ç”±ç®¡ç†                              â”‚</span><br><span class="line">â”‚  - åº”ç”¨åŠ è½½                              â”‚</span><br><span class="line">â”‚  - çŠ¶æ€å…±äº«                              â”‚</span><br><span class="line">â”‚  - é€šä¿¡åè°ƒ                              â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  å¾®åº”ç”¨ï¼ˆMicro Appsï¼‰                    â”‚</span><br><span class="line">â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚</span><br><span class="line">â”‚  â”‚ App 1  â”‚ App 2  â”‚ App 3  â”‚ App 4  â”‚ â”‚</span><br><span class="line">â”‚  â”‚ React  â”‚ Vue    â”‚ Angularâ”‚ Svelte â”‚ â”‚</span><br><span class="line">â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚</span><br><span class="line">â”‚  - ç‹¬ç«‹å¼€å‘                              â”‚</span><br><span class="line">â”‚  - ç‹¬ç«‹éƒ¨ç½²                              â”‚</span><br><span class="line">â”‚  - ç‹¬ç«‹è¿è¡Œ                              â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure>

<h3 id="å¾®å‰ç«¯çš„ä¼˜åŠ¿"><a href="#å¾®å‰ç«¯çš„ä¼˜åŠ¿" class="headerlink" title="å¾®å‰ç«¯çš„ä¼˜åŠ¿"></a>å¾®å‰ç«¯çš„ä¼˜åŠ¿</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æŠ€æœ¯ä¼˜åŠ¿ï¼š</span></span><br><span class="line"><span class="comment">âœ… å›¢é˜Ÿè‡ªæ²» - ä¸åŒå›¢é˜Ÿå¯ä»¥ç‹¬ç«‹å¼€å‘</span></span><br><span class="line"><span class="comment">âœ… æŠ€æœ¯æ ˆæ— å…³ - React/Vue/Angular å…±å­˜</span></span><br><span class="line"><span class="comment">âœ… ç‹¬ç«‹éƒ¨ç½² - å¾®åº”ç”¨å¯ç‹¬ç«‹å‘å¸ƒ</span></span><br><span class="line"><span class="comment">âœ… å¢é‡å‡çº§ - é€æ­¥è¿ç§»æ—§ç³»ç»Ÿ</span></span><br><span class="line"><span class="comment">âœ… æ•…éšœéš”ç¦» - ä¸€ä¸ªåº”ç”¨å´©æºƒä¸å½±å“å…¶ä»–</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ä¸šåŠ¡ä¼˜åŠ¿ï¼š</span></span><br><span class="line"><span class="comment">âœ… å¿«é€Ÿäº¤ä»˜ - å¹¶è¡Œå¼€å‘ï¼ŒåŠ å¿«è¿­ä»£</span></span><br><span class="line"><span class="comment">âœ… çµæ´»æ‰©å±• - æŒ‰éœ€æ·»åŠ åŠŸèƒ½æ¨¡å—</span></span><br><span class="line"><span class="comment">âœ… é™ä½é£é™© - åˆ†å¸ƒå¼å¼€å‘é™ä½å•ç‚¹é£é™©</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="ä¸»æµå¾®å‰ç«¯æ–¹æ¡ˆå¯¹æ¯”"><a href="#ä¸»æµå¾®å‰ç«¯æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="ä¸»æµå¾®å‰ç«¯æ–¹æ¡ˆå¯¹æ¯”"></a>ä¸»æµå¾®å‰ç«¯æ–¹æ¡ˆå¯¹æ¯”</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ–¹æ¡ˆå¯¹æ¯”ï¼š</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="comment">â”‚          â”‚ qiankun  â”‚single-spaâ”‚  Module   â”‚</span></span><br><span class="line"><span class="comment">â”‚          â”‚          â”‚          â”‚ Federationâ”‚</span></span><br><span class="line"><span class="comment">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span></span><br><span class="line"><span class="comment">â”‚ä¸Šæ‰‹éš¾åº¦  â”‚   â­â­   â”‚   â­â­â­  â”‚   â­â­â­â­ â”‚</span></span><br><span class="line"><span class="comment">â”‚åŠŸèƒ½ä¸°å¯Œåº¦â”‚   â­â­â­â­ â”‚   â­â­â­  â”‚   â­â­â­  â”‚</span></span><br><span class="line"><span class="comment">â”‚ç”Ÿæ€æˆç†Ÿåº¦â”‚   â­â­â­â­ â”‚   â­â­â­â­ â”‚   â­â­   â”‚</span></span><br><span class="line"><span class="comment">â”‚ç¤¾åŒºæ´»è·ƒåº¦â”‚   â­â­â­â­ â”‚   â­â­â­â­ â”‚   â­â­â­  â”‚</span></span><br><span class="line"><span class="comment">â”‚é€‚ç”¨åœºæ™¯  â”‚  ä¼ä¸šçº§  â”‚ é€šç”¨åœºæ™¯  â”‚  ç°ä»£æµè§ˆå™¨â”‚</span></span><br><span class="line"><span class="comment">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€qiankun-å®Œå…¨æŒ‡å—"><a href="#äºŒã€qiankun-å®Œå…¨æŒ‡å—" class="headerlink" title="äºŒã€qiankun å®Œå…¨æŒ‡å—"></a>äºŒã€qiankun å®Œå…¨æŒ‡å—</h2><h3 id="ä¸»åº”ç”¨é…ç½®"><a href="#ä¸»åº”ç”¨é…ç½®" class="headerlink" title="ä¸»åº”ç”¨é…ç½®"></a>ä¸»åº”ç”¨é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸»åº”ç”¨å®‰è£… qiankun</span></span><br><span class="line"><span class="comment">// npm install qiankun</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; registerMicroApps, start &#125; <span class="keyword">from</span> <span class="string">&#x27;qiankun&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œå¾®åº”ç”¨</span></span><br><span class="line"><span class="title function_">registerMicroApps</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;react-app&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;//localhost:7100&#x27;</span>,</span><br><span class="line">    <span class="attr">container</span>: <span class="string">&#x27;#subapp-container&#x27;</span>,</span><br><span class="line">    <span class="attr">activeRule</span>: <span class="string">&#x27;/react&#x27;</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">      <span class="attr">routerBase</span>: <span class="string">&#x27;/react&#x27;</span>,</span><br><span class="line">      <span class="attr">token</span>: <span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;vue-app&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;//localhost:7200&#x27;</span>,</span><br><span class="line">    <span class="attr">container</span>: <span class="string">&#x27;#subapp-container&#x27;</span>,</span><br><span class="line">    <span class="attr">activeRule</span>: <span class="string">&#x27;/vue&#x27;</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">      <span class="attr">routerBase</span>: <span class="string">&#x27;/vue&#x27;</span>,</span><br><span class="line">      <span class="attr">store</span>: &#123;&#125; <span class="comment">// ä¼ é€’å…¨å±€çŠ¶æ€</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;angular-app&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;//localhost:7300&#x27;</span>,</span><br><span class="line">    <span class="attr">container</span>: <span class="string">&#x27;#subapp-container&#x27;</span>,</span><br><span class="line">    <span class="attr">activeRule</span>: <span class="string">&#x27;/angular&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨ qiankun</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">sandbox</span>: &#123;</span><br><span class="line">    <span class="attr">strictStyleIsolation</span>: <span class="literal">false</span>, <span class="comment">// æ ·å¼éš”ç¦»</span></span><br><span class="line">    <span class="attr">experimentalStyleIsolation</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">prefetch</span>: <span class="literal">true</span>, <span class="comment">// é¢„åŠ è½½</span></span><br><span class="line">  <span class="attr">singular</span>: <span class="literal">false</span>, <span class="comment">// æ˜¯å¦å•å®ä¾‹</span></span><br><span class="line">  <span class="attr">fetch</span>: <span class="variable language_">window</span>.<span class="property">fetch</span> <span class="comment">// è‡ªå®šä¹‰ fetch</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="React-å¾®åº”ç”¨é…ç½®"><a href="#React-å¾®åº”ç”¨é…ç½®" class="headerlink" title="React å¾®åº”ç”¨é…ç½®"></a>React å¾®åº”ç”¨é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¾®åº”ç”¨ï¼šReact (webpack.config.js)</span></span><br><span class="line"><span class="keyword">const</span> &#123; name &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./package.json&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">library</span>: <span class="string">`<span class="subst">$&#123;name&#125;</span>-[name]`</span>,</span><br><span class="line">    <span class="attr">libraryTarget</span>: <span class="string">&#x27;umd&#x27;</span>,</span><br><span class="line">    <span class="attr">globalObject</span>: <span class="string">&#x27;window&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: <span class="number">7100</span>,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>: <span class="string">&#x27;*&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/public-path.js</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">__POWERED_BY_QIANKUN__</span>) &#123;</span><br><span class="line">  __webpack_public_path__ = <span class="variable language_">window</span>.<span class="property">__INJECTED_PUBLIC_PATH_BY_QIANKUN__</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./public-path&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> root = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params">props = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(</span><br><span class="line">    container ? container.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>) : <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line">  root.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‹¬ç«‹è¿è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">__POWERED_BY_QIANKUN__</span>) &#123;</span><br><span class="line">  <span class="title function_">render</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">bootstrap</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;React app bootstraped&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">mount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;React app mounted&#x27;</span>, props);</span><br><span class="line">  <span class="title function_">render</span>(props);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">unmount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;React app unmounted&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  root.<span class="title function_">unmount</span>(</span><br><span class="line">    container ? container.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>) : <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Vue3-å¾®åº”ç”¨é…ç½®"><a href="#Vue3-å¾®åº”ç”¨é…ç½®" class="headerlink" title="Vue3 å¾®åº”ç”¨é…ç½®"></a>Vue3 å¾®åº”ç”¨é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¾®åº”ç”¨ï¼šVue3 (vite.config.js)</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> qiankun <span class="keyword">from</span> <span class="string">&#x27;vite-plugin-qiankun&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title function_">qiankun</span>(<span class="string">&#x27;vue-app&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">useDevMode</span>: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">server</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: <span class="number">7200</span>,</span><br><span class="line">    <span class="attr">origin</span>: <span class="string">&#x27;http://localhost:7200&#x27;</span>,</span><br><span class="line">    <span class="attr">cors</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params">props = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line">  app.<span class="title function_">use</span>(router);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> containerElement = container</span><br><span class="line">    ? container.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line">    : <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  app.<span class="title function_">mount</span>(containerElement);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">__POWERED_BY_QIANKUN__</span>) &#123;</span><br><span class="line">  <span class="title function_">render</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">bootstrap</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Vue app bootstraped&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">mount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Vue app mounted&#x27;</span>, props);</span><br><span class="line">  <span class="title function_">render</span>(props);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">unmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Vue app unmounted&#x27;</span>);</span><br><span class="line">  app.<span class="title function_">unmount</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Angular-å¾®åº”ç”¨é…ç½®"><a href="#Angular-å¾®åº”ç”¨é…ç½®" class="headerlink" title="Angular å¾®åº”ç”¨é…ç½®"></a>Angular å¾®åº”ç”¨é…ç½®</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¾®åº”ç”¨ï¼šAngular (src/main.ts)</span></span><br><span class="line"><span class="keyword">import</span> &#123; platformBrowserDynamic &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/platform-browser-dynamic&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NgModuleRef</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./app/app.module&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">app</span>: <span class="built_in">void</span> | <span class="title class_">NgModuleRef</span>&lt;<span class="title class_">AppModule</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getProps</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="variable language_">window</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">__PROVIDED_QIANKUN_DEPS__</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mount</span>(<span class="params"><span class="attr">props</span>: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  app = <span class="title function_">platformBrowserDynamic</span>()</span><br><span class="line">    .<span class="title function_">bootstrapModule</span>(<span class="title class_">AppModule</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">moduleRef</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> rootElement = container</span><br><span class="line">        ? container.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app-root&#x27;</span>)</span><br><span class="line">        : <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app-root&#x27;</span>);</span><br><span class="line"></span><br><span class="line">      rootElement.<span class="title function_">appendChild</span>(moduleRef.<span class="property">instance</span>.<span class="property">elementRef</span>.<span class="property">nativeElement</span>);</span><br><span class="line">      <span class="keyword">return</span> moduleRef;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (app) &#123;</span><br><span class="line">    app.<span class="title function_">then</span>(<span class="function">(<span class="params">moduleRef</span>) =&gt;</span> &#123;</span><br><span class="line">      moduleRef.<span class="title function_">destroy</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‹¬ç«‹è¿è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable language_">window</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">__POWERED_BY_QIANKUN__</span>) &#123;</span><br><span class="line">  <span class="title function_">mount</span>(&#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">bootstrap</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Angular app bootstraped&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">mount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Angular app mounted&#x27;</span>, props);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">mount</span>(props);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">unmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Angular app unmounted&#x27;</span>);</span><br><span class="line">  <span class="title function_">unmount</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç”Ÿå‘½å‘¨æœŸè¯¦è§£"><a href="#ç”Ÿå‘½å‘¨æœŸè¯¦è§£" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸè¯¦è§£"></a>ç”Ÿå‘½å‘¨æœŸè¯¦è§£</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">qiankun ç”Ÿå‘½å‘¨æœŸæµç¨‹ï¼š</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å¾®åº”ç”¨åŠ è½½æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="comment">â”‚  1. Bootstrap â”‚ åˆå§‹åŒ–ï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰</span></span><br><span class="line"><span class="comment">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜</span></span><br><span class="line"><span class="comment">       â”‚</span></span><br><span class="line"><span class="comment">       â–¼</span></span><br><span class="line"><span class="comment">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="comment">â”‚  2. Mount     â”‚ æŒ‚è½½ï¼ˆæ¯æ¬¡æ¿€æ´»ï¼‰</span></span><br><span class="line"><span class="comment">â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜</span></span><br><span class="line"><span class="comment">       â”‚</span></span><br><span class="line"><span class="comment">       â–¼</span></span><br><span class="line"><span class="comment">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="comment">â”‚  3. Unmount   â”‚ å¸è½½ï¼ˆæ¯æ¬¡å¤±æ´»ï¼‰</span></span><br><span class="line"><span class="comment">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç”Ÿå‘½å‘¨æœŸæœ€ä½³å®è·µï¼š</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">export async function bootstrap() &#123;</span></span><br><span class="line"><span class="comment">  // åˆå§‹åŒ–å…¨å±€é…ç½®</span></span><br><span class="line"><span class="comment">  // å»ºç«‹è¿æ¥ï¼ˆWebSocketã€æ•°æ®åº“ç­‰ï¼‰</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">export async function mount(props) &#123;</span></span><br><span class="line"><span class="comment">  // æ¥æ”¶ä¸»åº”ç”¨ä¼ é€’çš„ props</span></span><br><span class="line"><span class="comment">  // åˆå§‹åŒ–è·¯ç”±</span></span><br><span class="line"><span class="comment">  // æ¸²æŸ“ç»„ä»¶</span></span><br><span class="line"><span class="comment">  // è®¢é˜…å…¨å±€çŠ¶æ€</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">export async function unmount(props) &#123;</span></span><br><span class="line"><span class="comment">  // æ¸…ç†è®¢é˜…</span></span><br><span class="line"><span class="comment">  // é”€æ¯è¿æ¥</span></span><br><span class="line"><span class="comment">  // æ¸…ç©ºçŠ¶æ€</span></span><br><span class="line"><span class="comment">  // ç§»é™¤ DOM</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€æ ·å¼éš”ç¦»"><a href="#ä¸‰ã€æ ·å¼éš”ç¦»" class="headerlink" title="ä¸‰ã€æ ·å¼éš”ç¦»"></a>ä¸‰ã€æ ·å¼éš”ç¦»</h2><h3 id="CSS-éš”ç¦»æ–¹æ¡ˆ"><a href="#CSS-éš”ç¦»æ–¹æ¡ˆ" class="headerlink" title="CSS éš”ç¦»æ–¹æ¡ˆ"></a>CSS éš”ç¦»æ–¹æ¡ˆ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ¡ˆ1: ä¸¥æ ¼æ ·å¼éš”ç¦»ï¼ˆShadow DOMï¼‰</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">sandbox</span>: &#123;</span><br><span class="line">    <span class="attr">strictStyleIsolation</span>: <span class="literal">true</span> <span class="comment">// å¼€å¯ Shadow DOM</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ¡ˆ2: å®éªŒæ€§æ ·å¼éš”ç¦»ï¼ˆæ¨èï¼‰</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">sandbox</span>: &#123;</span><br><span class="line">    <span class="attr">experimentalStyleIsolation</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ–¹æ¡ˆå¯¹æ¯”ï¼š</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">strictStyleIsolation:</span></span><br><span class="line"><span class="comment">âœ… å®Œå…¨éš”ç¦»</span></span><br><span class="line"><span class="comment">âœ… æ ·å¼ä¸å†²çª</span></span><br><span class="line"><span class="comment">âŒ éƒ¨åˆ†æ ·å¼åº“å¤±æ•ˆï¼ˆantdï¼‰</span></span><br><span class="line"><span class="comment">âŒ å¼¹çª—ç»„ä»¶æ ·å¼é—®é¢˜</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">experimentalStyleIsolation:</span></span><br><span class="line"><span class="comment">âœ… åŸºæœ¬éš”ç¦»</span></span><br><span class="line"><span class="comment">âœ… å…¼å®¹æ€§å¥½</span></span><br><span class="line"><span class="comment">âš ï¸ å¯èƒ½å­˜åœ¨æ ·å¼æ³„æ¼</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="Scoped-CSS"><a href="#Scoped-CSS" class="headerlink" title="Scoped CSS"></a>Scoped CSS</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Vue Scoped CSS */</span></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* è‡ªåŠ¨æ·»åŠ å±æ€§é€‰æ‹©å™¨ */</span></span><br><span class="line"><span class="selector-class">.container</span><span class="selector-attr">[data-v-xxx]</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* React CSS Modules */</span></span><br><span class="line"><span class="comment">/* styles.module.css */</span></span><br><span class="line">.<span class="property">container</span> &#123;</span><br><span class="line">  <span class="attr">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Component.jsx */</span></span><br><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">&#x27;./styles.module.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;styles.container&#125;</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ ·å¼å†²çªè§£å†³"><a href="#æ ·å¼å†²çªè§£å†³" class="headerlink" title="æ ·å¼å†²çªè§£å†³"></a>æ ·å¼å†²çªè§£å†³</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ¡ˆ1: CSS å‘½åç©ºé—´</span></span><br><span class="line"><span class="comment">// ä¸»åº”ç”¨</span></span><br><span class="line">.<span class="property">main</span>-app-button &#123;</span><br><span class="line">  <span class="comment">/* ä¸»åº”ç”¨æ ·å¼ */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾®åº”ç”¨</span></span><br><span class="line">.<span class="property">subapp</span>-button &#123;</span><br><span class="line">  <span class="comment">/* å¾®åº”ç”¨æ ·å¼ */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ¡ˆ2: CSS-in-JS</span></span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&#x27;styled-components&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Button</span> = styled.<span class="property">button</span><span class="string">`</span></span><br><span class="line"><span class="string">  color: red;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ¡ˆ3: åŠ¨æ€æ·»åŠ /ç§»é™¤æ ·å¼</span></span><br><span class="line"><span class="comment">// qiankun è‡ªåŠ¨å¤„ç†å¾®åº”ç”¨æ ·å¼æŒ‚è½½å’Œå¸è½½</span></span><br></pre></td></tr></table></figure>

<h2 id="å››ã€JS-æ²™ç®±"><a href="#å››ã€JS-æ²™ç®±" class="headerlink" title="å››ã€JS æ²™ç®±"></a>å››ã€JS æ²™ç®±</h2><h3 id="å¿«ç…§æ²™ç®±ï¼ˆå¼€å‘ç¯å¢ƒï¼‰"><a href="#å¿«ç…§æ²™ç®±ï¼ˆå¼€å‘ç¯å¢ƒï¼‰" class="headerlink" title="å¿«ç…§æ²™ç®±ï¼ˆå¼€å‘ç¯å¢ƒï¼‰"></a>å¿«ç…§æ²™ç®±ï¼ˆå¼€å‘ç¯å¢ƒï¼‰</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// qiankun åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨å¿«ç…§æ²™ç®±</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SnapshotSandbox</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">proxy</span> = <span class="variable language_">window</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = <span class="string">&#x27;Snapshot&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sandboxRunning</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">windowSnapshot</span> = &#123;&#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">modifyPropsMap</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">active</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// è®°å½•å½“å‰çŠ¶æ€</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">windowSnapshot</span> = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> prop <span class="keyword">in</span> <span class="variable language_">window</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">windowSnapshot</span>[prop] = <span class="variable language_">window</span>[prop];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¢å¤ä¸Šæ¬¡ä¿®æ”¹</span></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable language_">this</span>.<span class="property">modifyPropsMap</span>).<span class="title function_">forEach</span>(<span class="function">(<span class="params">prop</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">window</span>[prop] = <span class="variable language_">this</span>.<span class="property">modifyPropsMap</span>[prop];</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sandboxRunning</span> = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">inactive</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">modifyPropsMap</span> = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> prop <span class="keyword">in</span> <span class="variable language_">window</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">window</span>[prop] !== <span class="variable language_">this</span>.<span class="property">windowSnapshot</span>[prop]) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">modifyPropsMap</span>[prop] = <span class="variable language_">window</span>[prop];</span><br><span class="line">        <span class="variable language_">window</span>[prop] = <span class="variable language_">this</span>.<span class="property">windowSnapshot</span>[prop];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sandboxRunning</span> = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä»£ç†æ²™ç®±ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰"><a href="#ä»£ç†æ²™ç®±ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰" class="headerlink" title="ä»£ç†æ²™ç®±ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰"></a>ä»£ç†æ²™ç®±ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// qiankun åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ä»£ç†æ²™ç®±ï¼ˆä¸æ”¯æŒ IEï¼‰</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProxySandbox</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> fakeWindow = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(fakeWindow, &#123;</span><br><span class="line">      <span class="attr">set</span>: <span class="function">(<span class="params">target, prop, value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">sandboxRunning</span>) &#123;</span><br><span class="line">          target[prop] = value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">get</span>: <span class="function">(<span class="params">target, prop</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> target[prop] || <span class="variable language_">window</span>[prop];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">proxy</span> = proxy;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = <span class="string">&#x27;Proxy&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sandboxRunning</span> = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">active</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sandboxRunning</span> = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">inactive</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sandboxRunning</span> = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€åº”ç”¨é—´é€šä¿¡"><a href="#äº”ã€åº”ç”¨é—´é€šä¿¡" class="headerlink" title="äº”ã€åº”ç”¨é—´é€šä¿¡"></a>äº”ã€åº”ç”¨é—´é€šä¿¡</h2><h3 id="ä¸»åº”ç”¨ä¼ é€’-props"><a href="#ä¸»åº”ç”¨ä¼ é€’-props" class="headerlink" title="ä¸»åº”ç”¨ä¼ é€’ props"></a>ä¸»åº”ç”¨ä¼ é€’ props</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸»åº”ç”¨</span></span><br><span class="line"><span class="title function_">registerMicroApps</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;vue-app&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;//localhost:7200&#x27;</span>,</span><br><span class="line">    <span class="attr">container</span>: <span class="string">&#x27;#subapp&#x27;</span>,</span><br><span class="line">    <span class="attr">activeRule</span>: <span class="string">&#x27;/vue&#x27;</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">      <span class="attr">data</span>: &#123; <span class="attr">userId</span>: <span class="number">123</span> &#125;,</span><br><span class="line">      <span class="attr">actions</span>: &#123;</span><br><span class="line">        <span class="attr">onGlobalStateChange</span>: <span class="function">(<span class="params">state, prev</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä¸»åº”ç”¨çŠ¶æ€å˜åŒ–&#x27;</span>, state, prev);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾®åº”ç”¨æ¥æ”¶</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">mount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(props.<span class="property">data</span>); <span class="comment">// &#123; userId: 123 &#125;</span></span><br><span class="line">  props.<span class="property">actions</span>.<span class="title function_">onGlobalStateChange</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å…¨å±€çŠ¶æ€ç®¡ç†"><a href="#å…¨å±€çŠ¶æ€ç®¡ç†" class="headerlink" title="å…¨å±€çŠ¶æ€ç®¡ç†"></a>å…¨å±€çŠ¶æ€ç®¡ç†</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®‰è£… qiankun çŠ¶æ€ç®¡ç†</span></span><br><span class="line"><span class="comment">// npm install qiankun</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»åº”ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; initGlobalState &#125; <span class="keyword">from</span> <span class="string">&#x27;qiankun&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  <span class="attr">user</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">token</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">language</span>: <span class="string">&#x27;zh-CN&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = <span class="title function_">initGlobalState</span>(initialState);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬çŠ¶æ€å˜åŒ–</span></span><br><span class="line">actions.<span class="title function_">onGlobalStateChange</span>(<span class="function">(<span class="params">state, prev</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä¸»åº”ç”¨:&#x27;</span>, state, prev);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹çŠ¶æ€</span></span><br><span class="line">actions.<span class="title function_">setGlobalState</span>(&#123;</span><br><span class="line">  <span class="attr">user</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// offGlobalStateChange å–æ¶ˆç›‘å¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾®åº”ç”¨</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">mount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="comment">// ç›‘å¬å…¨å±€çŠ¶æ€</span></span><br><span class="line">  props.<span class="title function_">onGlobalStateChange</span>(<span class="function">(<span class="params">state, prev</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å¾®åº”ç”¨:&#x27;</span>, state, prev);</span><br><span class="line">  &#125;, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¿®æ”¹å…¨å±€çŠ¶æ€</span></span><br><span class="line">  props.<span class="title function_">setGlobalState</span>(&#123;</span><br><span class="line">    <span class="attr">user</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span> &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰äº‹ä»¶æ€»çº¿"><a href="#è‡ªå®šä¹‰äº‹ä»¶æ€»çº¿" class="headerlink" title="è‡ªå®šä¹‰äº‹ä»¶æ€»çº¿"></a>è‡ªå®šä¹‰äº‹ä»¶æ€»çº¿</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// event-bus.js</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EventBus</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">events</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">on</span>(<span class="params">event, callback</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">events</span>[event]) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">events</span>[event] = [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">events</span>[event].<span class="title function_">push</span>(callback);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">off</span>(<span class="params">event, callback</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">events</span>[event]) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">events</span>[event] = <span class="variable language_">this</span>.<span class="property">events</span>[event].<span class="title function_">filter</span>(<span class="function"><span class="params">cb</span> =&gt;</span> cb !== callback);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">emit</span>(<span class="params">event, data</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">events</span>[event]) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">events</span>[event].<span class="title function_">forEach</span>(<span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>(data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å‡ºå•ä¾‹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> eventBus = <span class="keyword">new</span> <span class="title class_">EventBus</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»åº”ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; eventBus &#125; <span class="keyword">from</span> <span class="string">&#x27;./event-bus&#x27;</span>;</span><br><span class="line"></span><br><span class="line">eventBus.<span class="title function_">on</span>(<span class="string">&#x27;user-login&#x27;</span>, <span class="function">(<span class="params">user</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç”¨æˆ·ç™»å½•&#x27;</span>, user);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾®åº”ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; eventBus &#125; <span class="keyword">from</span> <span class="string">&#x27;./event-bus&#x27;</span>;</span><br><span class="line"></span><br><span class="line">eventBus.<span class="title function_">emit</span>(<span class="string">&#x27;user-login&#x27;</span>, &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€è·¯ç”±ç®¡ç†"><a href="#å…­ã€è·¯ç”±ç®¡ç†" class="headerlink" title="å…­ã€è·¯ç”±ç®¡ç†"></a>å…­ã€è·¯ç”±ç®¡ç†</h2><h3 id="ä¸»åº”ç”¨è·¯ç”±é…ç½®"><a href="#ä¸»åº”ç”¨è·¯ç”±é…ç½®" class="headerlink" title="ä¸»åº”ç”¨è·¯ç”±é…ç½®"></a>ä¸»åº”ç”¨è·¯ç”±é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// React Router v6</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span>, <span class="title class_">Routes</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">BrowserRouter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/react&quot;</span>&gt;</span>Reactåº”ç”¨<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/vue&quot;</span>&gt;</span>Vueåº”ç”¨<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/react/*&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span> <span class="attr">id</span>=<span class="string">&quot;subapp-container&quot;</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/vue/*&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span> <span class="attr">id</span>=<span class="string">&quot;subapp-container&quot;</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">BrowserRouter</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯ç”±æ‹¦æˆª</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> location = <span class="title function_">useLocation</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è·¯ç”±å®ˆå«</span></span><br><span class="line">    <span class="keyword">if</span> (location.<span class="property">pathname</span>.<span class="title function_">includes</span>(<span class="string">&#x27;/admin&#x27;</span>)) &#123;</span><br><span class="line">      <span class="keyword">const</span> token = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line">      <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">        <span class="comment">// è·³è½¬åˆ°ç™»å½•é¡µ</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [location]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¾®åº”ç”¨è·¯ç”±é…ç½®"><a href="#å¾®åº”ç”¨è·¯ç”±é…ç½®" class="headerlink" title="å¾®åº”ç”¨è·¯ç”±é…ç½®"></a>å¾®åº”ç”¨è·¯ç”±é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// React å¾®åº”ç”¨è·¯ç”±</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span>, <span class="title class_">Routes</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params">&#123; routerBase &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">BrowserRouter</span> <span class="attr">basename</span>=<span class="string">&#123;routerBase&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">About</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">BrowserRouter</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Vue å¾®åº”ç”¨è·¯ç”±</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Home</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>, <span class="attr">component</span>: <span class="title class_">About</span> &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="variable language_">window</span>.<span class="property">__POWERED_BY_QIANKUN__</span> ? <span class="string">&#x27;/vue&#x27;</span> : <span class="string">&#x27;/&#x27;</span>),</span><br><span class="line">  routes</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€æ€§èƒ½ä¼˜åŒ–"><a href="#ä¸ƒã€æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="ä¸ƒã€æ€§èƒ½ä¼˜åŒ–"></a>ä¸ƒã€æ€§èƒ½ä¼˜åŒ–</h2><h3 id="é¢„åŠ è½½ç­–ç•¥"><a href="#é¢„åŠ è½½ç­–ç•¥" class="headerlink" title="é¢„åŠ è½½ç­–ç•¥"></a>é¢„åŠ è½½ç­–ç•¥</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é¢„åŠ è½½æ‰€æœ‰å¾®åº”ç”¨</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">prefetch</span>: <span class="literal">true</span> <span class="comment">// é»˜è®¤ï¼Œä¼šåœ¨ç¬¬ä¸€ä¸ªå¾®åº”ç”¨æŒ‚è½½åé¢„åŠ è½½å…¶ä»–</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¢„åŠ è½½æŒ‡å®šå¾®åº”ç”¨</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">prefetch</span>: [<span class="string">&#x27;app1&#x27;</span>, <span class="string">&#x27;app2&#x27;</span>]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¦ç”¨é¢„åŠ è½½</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">prefetch</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰é¢„åŠ è½½ç­–ç•¥</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">prefetch</span>: <span class="function">(<span class="params">apps</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// apps: æ‰€æœ‰å·²æ³¨å†Œçš„å¾®åº”ç”¨</span></span><br><span class="line">    <span class="keyword">return</span> apps.<span class="title function_">filter</span>(<span class="function"><span class="params">app</span> =&gt;</span> [<span class="string">&#x27;app1&#x27;</span>, <span class="string">&#x27;app2&#x27;</span>].<span class="title function_">includes</span>(app.<span class="property">name</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="æ‡’åŠ è½½"><a href="#æ‡’åŠ è½½" class="headerlink" title="æ‡’åŠ è½½"></a>æ‡’åŠ è½½</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŒ‰éœ€åŠ è½½å¾®åº”ç”¨</span></span><br><span class="line"><span class="title function_">registerMicroApps</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;heavy-app&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./heavy-app/entry&#x27;</span>), <span class="comment">// åŠ¨æ€ entry</span></span><br><span class="line">    <span class="attr">container</span>: <span class="string">&#x27;#container&#x27;</span>,</span><br><span class="line">    <span class="attr">activeRule</span>: <span class="string">&#x27;/heavy&#x27;</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<h3 id="ç¼“å­˜ç­–ç•¥"><a href="#ç¼“å­˜ç­–ç•¥" class="headerlink" title="ç¼“å­˜ç­–ç•¥"></a>ç¼“å­˜ç­–ç•¥</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åº”ç”¨ç¼“å­˜</span></span><br><span class="line"><span class="keyword">const</span> cache = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loadApp</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (cache[name]) &#123;</span><br><span class="line">    <span class="keyword">return</span> cache[name];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> app = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">`./apps/<span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">  cache[name] = app;</span><br><span class="line">  <span class="keyword">return</span> app;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…«ã€single-spa-æ–¹æ¡ˆ"><a href="#å…«ã€single-spa-æ–¹æ¡ˆ" class="headerlink" title="å…«ã€single-spa æ–¹æ¡ˆ"></a>å…«ã€single-spa æ–¹æ¡ˆ</h2><h3 id="åŸºç¡€é…ç½®"><a href="#åŸºç¡€é…ç½®" class="headerlink" title="åŸºç¡€é…ç½®"></a>åŸºç¡€é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®‰è£… single-spa</span></span><br><span class="line"><span class="comment">// npm install single-spa</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// root-config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; registerApplication, start &#125; <span class="keyword">from</span> <span class="string">&#x27;single-spa&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œå¾®åº”ç”¨</span></span><br><span class="line"><span class="title function_">registerApplication</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;@org/react-app&#x27;</span>,</span><br><span class="line">  <span class="attr">main</span>: <span class="function">() =&gt;</span> <span class="title class_">System</span>.<span class="keyword">import</span>(<span class="string">&#x27;@org/react-app&#x27;</span>),</span><br><span class="line">  <span class="attr">activeWhen</span>: <span class="string">&#x27;/react&#x27;</span>,</span><br><span class="line">  <span class="attr">customProps</span>: &#123;&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">registerApplication</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;@org/vue-app&#x27;</span>,</span><br><span class="line">  <span class="attr">main</span>: <span class="function">() =&gt;</span> <span class="title class_">System</span>.<span class="keyword">import</span>(<span class="string">&#x27;@org/vue-app&#x27;</span>),</span><br><span class="line">  <span class="attr">activeWhen</span>: <span class="function">(<span class="params">location</span>) =&gt;</span> location.<span class="property">pathname</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;/vue&#x27;</span>),</span><br><span class="line">  <span class="attr">customProps</span>: &#123;&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨</span></span><br><span class="line"><span class="title function_">start</span>(&#123;</span><br><span class="line">  <span class="attr">urlRerouteOnly</span>: <span class="literal">true</span> <span class="comment">// åªåœ¨ URL å˜åŒ–æ—¶é‡æ–°è·¯ç”±</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="SystemJS-é…ç½®"><a href="#SystemJS-é…ç½®" class="headerlink" title="SystemJS é…ç½®"></a>SystemJS é…ç½®</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/systemjs/dist/system.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/systemjs/dist/extras/amd.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/systemjs/dist/exposables/use-default.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">System</span>.<span class="keyword">import</span>(<span class="string">&#x27;@org/root-config&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// system-import-map.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;imports&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;single-spa&quot;</span>: <span class="string">&quot;https://cdn.jsdelivr.net/npm/single-spa/lib/system/single-spa.min.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;react&quot;</span>: <span class="string">&quot;https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;react-dom&quot;</span>: <span class="string">&quot;https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@org/react-app&quot;</span>: <span class="string">&quot;http://localhost:7100/org-react-app.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@org/vue-app&quot;</span>: <span class="string">&quot;http://localhost:7200/org-vue-app.js&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¹ã€æœ€ä½³å®è·µ"><a href="#ä¹ã€æœ€ä½³å®è·µ" class="headerlink" title="ä¹ã€æœ€ä½³å®è·µ"></a>ä¹ã€æœ€ä½³å®è·µ</h2><h3 id="å¼€å‘è§„èŒƒ"><a href="#å¼€å‘è§„èŒƒ" class="headerlink" title="å¼€å‘è§„èŒƒ"></a>å¼€å‘è§„èŒƒ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1. åº”ç”¨è¾¹ç•Œ</span></span><br><span class="line"><span class="comment">   - æŒ‰ä¸šåŠ¡é¢†åŸŸåˆ’åˆ†ï¼ˆç”¨æˆ·ã€è®¢å•ã€å•†å“ï¼‰</span></span><br><span class="line"><span class="comment">   - æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼ˆç®¡ç†åå°ã€ç”¨æˆ·ç«¯ï¼‰</span></span><br><span class="line"><span class="comment">   - æŒ‰å›¢é˜Ÿåˆ’åˆ†ï¼ˆå‰ç«¯ç»„Aã€å‰ç«¯ç»„Bï¼‰</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2. ä¾èµ–ç®¡ç†</span></span><br><span class="line"><span class="comment">   - é¿å…å…±äº«ä¾èµ–</span></span><br><span class="line"><span class="comment">   - ç‰ˆæœ¬é”å®š</span></span><br><span class="line"><span class="comment">   - ä½¿ç”¨ peerDependencies</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3. æ ·å¼è§„èŒƒ</span></span><br><span class="line"><span class="comment">   - ä½¿ç”¨ CSS Modules / Scoped CSS</span></span><br><span class="line"><span class="comment">   - ç»Ÿä¸€è®¾è®¡ç³»ç»Ÿ</span></span><br><span class="line"><span class="comment">   - æ ·å¼éš”ç¦»</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">4. é€šä¿¡è§„èŒƒ</span></span><br><span class="line"><span class="comment">   - ä½¿ç”¨ props ä¼ é€’åŸºç¡€æ•°æ®</span></span><br><span class="line"><span class="comment">   - ä½¿ç”¨ qiankun çŠ¶æ€ç®¡ç†å…¨å±€çŠ¶æ€</span></span><br><span class="line"><span class="comment">   - äº‹ä»¶æ€»çº¿ç”¨äºè·¨åº”ç”¨é€šä¿¡</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">5. éƒ¨ç½²è§„èŒƒ</span></span><br><span class="line"><span class="comment">   - ç‹¬ç«‹ CI/CD</span></span><br><span class="line"><span class="comment">   - ç°åº¦å‘å¸ƒ</span></span><br><span class="line"><span class="comment">   - ç‰ˆæœ¬ç®¡ç†</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="é”™è¯¯è¾¹ç•Œ"><a href="#é”™è¯¯è¾¹ç•Œ" class="headerlink" title="é”™è¯¯è¾¹ç•Œ"></a>é”™è¯¯è¾¹ç•Œ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// React é”™è¯¯è¾¹ç•Œ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromError</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidCatch</span>(<span class="params">error, errorInfo</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;å¾®åº”ç”¨é”™è¯¯:&#x27;</span>, error, errorInfo);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hasError</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Something went wrong.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line">&lt;<span class="title class_">ErrorBoundary</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;subapp-container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">ErrorBoundary</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="ç›‘æ§ä¸æ—¥å¿—"><a href="#ç›‘æ§ä¸æ—¥å¿—" class="headerlink" title="ç›‘æ§ä¸æ—¥å¿—"></a>ç›‘æ§ä¸æ—¥å¿—</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…¨å±€é”™è¯¯æ•è·</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;å…¨å±€é”™è¯¯:&#x27;</span>, event.<span class="property">error</span>);</span><br><span class="line">  <span class="comment">// ä¸ŠæŠ¥ç›‘æ§å¹³å°</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;unhandledrejection&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;æœªå¤„ç†çš„ Promise æ‹’ç»:&#x27;</span>, event.<span class="property">reason</span>);</span><br><span class="line">  <span class="comment">// ä¸ŠæŠ¥ç›‘æ§å¹³å°</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// qiankun ç”Ÿå‘½å‘¨æœŸé”™è¯¯æ•è·</span></span><br><span class="line"><span class="title function_">registerMicroApps</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;app&#x27;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;//localhost:7100&#x27;</span>,</span><br><span class="line">    <span class="attr">container</span>: <span class="string">&#x27;#container&#x27;</span>,</span><br><span class="line">    <span class="attr">activeRule</span>: <span class="string">&#x27;/app&#x27;</span>,</span><br><span class="line">    <span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line">    <span class="attr">container</span>: <span class="string">&#x27;#container&#x27;</span>,</span><br><span class="line">    <span class="attr">errorBoundary</span>: <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;å¾®åº”ç”¨åŠ è½½å¤±è´¥:&#x27;</span>, err);</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="qiankun-vs-single-spa"><a href="#qiankun-vs-single-spa" class="headerlink" title="qiankun vs single-spa"></a>qiankun vs single-spa</h3><p><strong>é€‰æ‹© qiankun å¦‚æœï¼š</strong></p>
<ul>
<li>âœ… éœ€è¦å¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆ</li>
<li>âœ… å›¢é˜Ÿå¯¹å¾®å‰ç«¯ä¸å¤ªç†Ÿæ‚‰</li>
<li>âœ… éœ€è¦å®Œå–„çš„æ ·å¼éš”ç¦»å’Œ JS æ²™ç®±</li>
<li>âœ… ä½¿ç”¨ Vue&#x2F;React&#x2F;Angular</li>
</ul>
<p><strong>é€‰æ‹© single-spa å¦‚æœï¼š</strong></p>
<ul>
<li>âœ… éœ€è¦æ›´çµæ´»çš„æ§åˆ¶</li>
<li>âœ… ä½¿ç”¨ SystemJS æ¨¡å—è”é‚¦</li>
<li>âœ… éœ€è¦ä¸å…¶ä»–æ¡†æ¶é›†æˆ</li>
</ul>
<h3 id="å®æ–½å»ºè®®"><a href="#å®æ–½å»ºè®®" class="headerlink" title="å®æ–½å»ºè®®"></a>å®æ–½å»ºè®®</h3><ol>
<li><strong>æ¸è¿›å¼è¿ç§»</strong> - ä»è¾¹ç¼˜åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥è¿ç§»</li>
<li><strong>ç»Ÿä¸€è§„èŒƒ</strong> - åˆ¶å®šå¼€å‘ã€éƒ¨ç½²ã€ç›‘æ§è§„èŒƒ</li>
<li><strong>ç¨³å®šä¼˜å…ˆ</strong> - ä¿è¯ç”¨æˆ·ä½“éªŒï¼Œåšå¥½é™çº§æ–¹æ¡ˆ</li>
<li><strong>æŒç»­ä¼˜åŒ–</strong> - ç›‘æ§æ€§èƒ½ï¼Œä¼˜åŒ–åŠ è½½ç­–ç•¥</li>
</ol>
<p>å¾®å‰ç«¯æ¶æ„æ˜¯å¤§å‹å‰ç«¯åº”ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œæ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆï¼</p>
<hr>
<p><em>å¾®å‰ç«¯ç³»åˆ—æ–‡ç« å®Œç»“ï¼Œæ„Ÿè°¢é˜…è¯»ï¼</em></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>å¾®å‰ç«¯</tag>
        <tag>qiankun</tag>
        <tag>single-spa</tag>
        <tag>å‰ç«¯æ¶æ„</tag>
      </tags>
  </entry>
</search>
